/* ═══════════════════════════════════════════
   YAM — main.css
═══════════════════════════════════════════ */

/* ══ iOS SAFE AREAS — Dynamic Island ══
   Ces variables sont recalculées automatiquement
   par le navigateur selon le modèle d'iPhone.
   Sur iPhone 14 Pro / 15 / 16 : --safe-top ≈ 59px
   Sur iPhone avec notch        : --safe-top ≈ 44px
   Sur iPhone sans notch        : --safe-top ≈ 20px
════════════════════════════════════════════ */
:root {
  --safe-top:    env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left:   env(safe-area-inset-left, 0px);
  --safe-right:  env(safe-area-inset-right, 0px);
  /* Hauteur réelle de la nav bar (64px) + home indicator */
  --nav-height:  calc(64px + var(--safe-bottom));
}

:root {
  --bg:      #121212;
  --s1:      #181818;
  --s2:      #242424;
  --s3:      #2a2a2a;
  --text:    #ffffff;
  --sub:     #b3b3b3;
  --muted:   #6a6a6a;
  --green:   #00c9a7;
  --green2:  #00e5bd;
  --border:  rgba(255,255,255,0.07);
  --shadow:  0 8px 32px rgba(0,0,0,0.45);
  --radius:  10px;
}
body.light {
  --bg:     #f9e8f0;
  --s1:     #fff5f8;
  --s2:     #fde0ec;
  --s3:     #fad0e2;
  --text:   #1e0510;
  --sub:    #6b2040;
  --muted:  #b06080;
  --green:  #c8185e;
  --green2: #e0286e;
  --border: rgba(200,24,94,0.18);
  --shadow: 0 8px 32px rgba(180,20,80,0.16);
}
* { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; overflow-x: hidden; -webkit-text-size-adjust: 100%; overscroll-behavior: none !important; overscroll-behavior-x: none !important; overscroll-behavior-y: none !important; }
body { overscroll-behavior: none !important; overscroll-behavior-y: none !important; -webkit-overflow-scrolling: touch; touch-action: pan-x pan-y !important; }

/* ══ SKELETON LOADING ══ */
@keyframes skeletonShimmer {
  0%   { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}
.skeleton {
  background: linear-gradient(90deg, var(--s2) 25%, var(--s3) 50%, var(--s2) 75%);
  background-size: 200% 100%;
  animation: skeletonShimmer 2s ease-in-out infinite;
  border-radius: 8px;
}
.album-image .skeleton-overlay {
  position: absolute; inset: 0; z-index: 3;
  background: linear-gradient(90deg, var(--s2) 25%, var(--s3) 50%, var(--s2) 75%);
  background-size: 200% 100%;
  animation: skeletonShimmer 2s ease-in-out infinite;
  border-radius: 8px;
  transition: opacity 0.4s ease;
}
.album-image img.loaded + .skeleton-overlay,
.album-image .skeleton-overlay.hidden { opacity: 0; pointer-events: none; }

/* ══ PULL-TO-REFRESH ══ */
#pullRefreshIndicator {
  position: fixed; top: 0; left: 50%; transform: translateX(-50%) translateY(-60px);
  background: var(--s1); border: 1px solid var(--border);
  border-radius: 0 0 20px 20px; padding: 8px 20px 10px;
  display: flex; align-items: center; gap: 8px;
  font-size: 12px; font-weight: 600; color: var(--sub);
  z-index: 9999; box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  transition: transform 0.3s cubic-bezier(.4,0,.2,1);
  pointer-events: none;
}
#pullRefreshIndicator.visible { transform: translateX(-50%) translateY(0); }
#pullRefreshIndicator.refreshing { color: var(--green); }
.ptr-spinner {
  width: 14px; height: 14px; border: 2px solid var(--border);
  border-top-color: var(--green); border-radius: 50%;
  display: none;
}
#pullRefreshIndicator.refreshing .ptr-spinner { display: block; animation: ptrSpin 0.7s linear infinite; }
#pullRefreshIndicator.refreshing .ptr-arrow { display: none; }
@keyframes ptrSpin { to { transform: rotate(360deg); } }
.ptr-arrow { font-size: 14px; transition: transform 0.2s; }
.ptr-arrow.ready { transform: rotate(180deg); color: var(--green); }

/* ══ TRANSITIONS SOUS-VUES ══ */
#gamesView, #quizView, #hiddenPage, #memoryView, #penduView, #puzzleView, #snakeView, #skyjoView {
  will-change: transform, opacity;
}
#gamesView.active, #quizView.active {
  animation: viewSlideIn 0.28s cubic-bezier(.4,0,.2,1) !important;
}
@keyframes viewSlideIn {
  from { opacity: 0; transform: translateX(30px); }
  to   { opacity: 1; transform: translateX(0); }
}
@keyframes viewSlideOut {
  from { opacity: 1; transform: translateX(0); }
  to   { opacity: 0; transform: translateX(30px); }
}
/* ── Animations transition écrans InstaLove ── */
@keyframes dmSlideInRight {
  from { opacity: 0; transform: translateX(100%); }
  to   { opacity: 1; transform: translateX(0); }
}
@keyframes dmSlideInLeft {
  from { opacity: 0; transform: translateX(-100%); }
  to   { opacity: 1; transform: translateX(0); }
}
/* dm-slide-forward/backward — remplacés par transitions inline JS */

/* ══ TOAST NOTIFICATION ══ */
#uxToast {
  position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%) translateY(20px);
  background: var(--s1); border: 1px solid var(--border);
  border-radius: 50px; padding: 10px 20px;
  font-size: 13px; font-weight: 600; color: var(--text);
  z-index: 9998; opacity: 0;
  transition: opacity 0.25s, transform 0.25s;
  pointer-events: none; white-space: nowrap;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
}
#uxToast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
#uxToast.success { border-color: rgba(0,201,167,0.4); color: var(--green); }
#uxToast.error { border-color: rgba(255,68,68,0.4); color: #ff4444; }
body.light #uxToast.success { border-color: rgba(200,24,94,0.3); color: var(--green); }

/* ══ SMOOTH SCROLL ENHANCED ══ */
.section { scroll-margin-top: 16px; }
/* ════════════════════════════════════════════
   STICKY MINI HEADER — Apparaît au scroll
   Inspiré de l'app Paired
════════════════════════════════════════════ */
#yamStickyHeader {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 990;

  /* Hauteur : safe-area + barre compacte */
  height: calc(var(--safe-top) + 44px);
  padding-top: var(--safe-top);

  display: flex;
  align-items: flex-end;
  justify-content: center;
  padding-bottom: 10px;

  /* Fond flouté comme iOS */
  background: rgba(18, 18, 18, 0.82);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border-bottom: 1px solid rgba(255, 255, 255, 0.06);

  /* Caché par défaut — progressif selon le scroll (géré en JS) */
  transform: translateY(-100%);
  opacity: 0;
  /* Pas de transition CSS : le JS applique les valeurs directement pour suivre le doigt */
  pointer-events: none;
  will-change: transform, opacity;
}
#yamStickyHeader.visible {
  pointer-events: auto;
}

/* Layout interne : titre centré + avatars à droite */
#yamStickyHeader {
  /* override pour layout flex avec 3 zones */
  justify-content: space-between;
  padding-left: 16px;
  padding-right: 12px;
  align-items: flex-end;
}

/* Zone avatars à droite */
#yamStickyAvatars {
  display: flex;
  align-items: center;
  gap: 0;
  position: relative;
  width: 56px;
  height: 34px;
  flex-shrink: 0;
  padding-bottom: 2px;
}

/* Avatar principal (self) */
#yamStickyAvatarSelf {
  position: absolute;
  right: 0;
  width: 30px; height: 30px;
  border-radius: 50%;
  background: #1a2a4a;
  border: 1.5px solid rgba(91,156,246,0.4);
  display: flex; align-items: center; justify-content: center;
  font-size: 14px;
  cursor: pointer;
  z-index: 2;
  transition: border-color 0.3s;
}
#yamStickyAvatarSelf.girl { border-color: #e879a0; }
#yamStickyAvatarSelf.boy  { border-color: #5b9cf6; }
body.light #yamStickyAvatarSelf { background: rgba(200,24,94,0.08); }

/* Avatar secondaire (other) */
#yamStickyAvatarOther {
  position: absolute;
  right: 20px;
  width: 26px; height: 26px;
  border-radius: 50%;
  background: var(--s2);
  border: 1.5px solid var(--border);
  display: none;
  align-items: center; justify-content: center;
  font-size: 12px;
  opacity: 0.6;
  z-index: 1;
}
#yamStickyAvatarOther.visible { display: flex; }

/* Point présence sur l'avatar sticky */
#yamStickyPresenceDot {
  display: none;
  position: absolute;
  /* Sur l'avatar du partenaire (other) — coin bas gauche */
  bottom: -2px; left: -2px;
  width: 8px; height: 8px;
  border-radius: 50%;
  background: #22c55e;
  border: 1.5px solid var(--bg);
  z-index: 5;
  animation: presencePulse 2s ease-in-out infinite;
}
#yamStickyPresenceDot.online { display: block; }
#yamStickyHeaderTitle {
  font-family: 'DM Sans', sans-serif;
  font-size: 15px;
  font-weight: 600;
  color: var(--text);
  letter-spacing: 0.1px;
  transition: opacity 0.15s ease;
}
/* Thème clair */
body.light #yamStickyHeader {
  background: rgba(255, 240, 246, 0.88);
  border-bottom: 1px solid rgba(200, 24, 94, 0.12);
}
/* Masquer quand InstaLove est ouvert */
body:has(#hiddenPage.active) #yamStickyHeader {
  display: none;
}

/* ════════════════════════════════════════════
   INSTALOVE — Écran "Messages" (liste conv)
   Header grand style YAM + layout colonne
════════════════════════════════════════════ */

/* L'écran conv s'affiche en colonne */
.dm-home-conv-screen {
  flex-direction: column !important;
  align-items: stretch !important;
  justify-content: flex-start !important;
  padding: 0 !important;
  cursor: default !important;
  overflow-y: auto;
  width: 100%;
}

/* Header "Messages" style YAM */
.dm-yam-header {
  padding: 20px 16px 14px;
  position: relative;
  flex-shrink: 0;
}

/* Carte conv avec padding horizontal */
.dm-home-conv-screen .dm-home-conv {
  margin: 0 16px;
  border-radius: 14px;
  /* Empêcher le débordement à droite */
  width: calc(100% - 32px);
  box-sizing: border-box;
  overflow: hidden;
}

/* Footer centré */
.dm-home-conv-screen .dm-home-footer {
  text-align: center;
  padding: 16px;
}

/* Mode chat : cacher le bloc dmHeaderAvatars (doublon — avatars déjà dans dmTopbarCenter) */
#hiddenPage .dm-topbar-avatars ~ * #dmHeaderAvatars,
body.dm-chat-active #dmHeaderAvatars { display: none !important; }

/* Règle directe : quand dmTopbarCenter a la classe dm-topbar-avatars, cacher le bloc de droite */
#dmHeaderAvatars.dm-hide { display: none !important; }

/* ── Topbar minimaliste du chat (écran messages) : safe-area via CSS ── */
/* Le style inline a déjà padding-top:calc(var(--safe-top) + 10px)
   Cette règle sert de fallback + garantit l'alignement vertical */
.dm-topbar {
  align-items: flex-end !important;
  padding-bottom: 10px !important;
}

/* ══ FOCUS STYLES ACCESSIBILITÉ ══ */
button:focus-visible, [onclick]:focus-visible {
  outline: 2px solid var(--green);
  outline-offset: 2px;
  border-radius: 4px;
}

/* ══ ACTIVE STATE TACTILE ══ */
.bubbleBtn:active { transform: scale(0.94) !important; }
.nav-item:active { transform: scale(0.90) !important; opacity: 0.7; }
.tl-card:active { transform: scale(0.98); }
.album-image:active { transform: scale(0.97); }

/* ══ SWIPE HINT (premier lancement) ══ */
#swipeHint {
  display: none;
  position: fixed; bottom: 100px; left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.75);
  color: #fff; font-size: 12px; font-weight: 600;
  border-radius: 20px; padding: 8px 16px;
  z-index: 999; pointer-events: none;
  animation: swipeHintAnim 3s ease forwards;
}
@keyframes swipeHintAnim {
  0%   { opacity:0; transform:translateX(-50%) translateY(10px); }
  20%  { opacity:1; transform:translateX(-50%) translateY(0); }
  80%  { opacity:1; }
  100% { opacity:0; }
}
body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--text);
  overflow-x: hidden;
  /* Évite que le contenu passe sous la bottom-nav (nav 64px + home indicator) */
  padding-bottom: var(--nav-height);
  transition: background 0.3s, color 0.3s;
}
/* Empêche le zoom automatique iOS sur les inputs (déclenché si font-size < 16px) */
input, textarea, select { font-size: 16px !important; }

.fade-in {
  opacity: 0;
  transform: translateY(18px);
  transition: opacity 0.5s ease, transform 0.5s ease;
}
.fade-in.visible {
  opacity: 1;
  transform: none;
}

header {
  padding: 18px 16px 18px;
  /* ↓ Espace supplémentaire pour Dynamic Island / notch iOS */
  padding-top: calc(var(--safe-top) + 14px);
  position: relative;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
}
header::before {
  content: '';
  position: absolute;
  top: -60px; right: -40px;
  width: 260px; height: 260px;
  background: radial-gradient(circle, rgba(0,201,167,0.10) 0%, transparent 70%);
  pointer-events: none;
  animation: pulseGlow 6s ease-in-out infinite;
  will-change: opacity;
}
@keyframes pulseGlow {
  0%,100% { opacity: 0.5; }
  50%      { opacity: 0.85; }
}
.hdr-tag {
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--green);
  margin-bottom: 6px;
  display: flex; align-items: center; gap: 6px;
}
.hdr-tag::before {
  content: '';
  display: inline-block;
  width: 18px; height: 2px;
  background: var(--green);
  border-radius: 1px;
}
.hdr-name {
  font-family: 'Playfair Display', serif;
  font-size: clamp(30px, 9vw, 50px);
  font-weight: 700;
  color: var(--text);
  line-height: 1.05;
  letter-spacing: -0.5px;
}
.hdr-sub {
  margin-top: 8px;
  font-size: 12px;
  color: var(--muted);
  letter-spacing: 0.5px;
  display: flex; align-items: center; gap: 6px;
}
.hdr-sub::before {
  content: '';
  display: inline-block;
  width: 6px; height: 6px;
  background: var(--green);
  border-radius: 50%;
  animation: blink 4s ease-in-out infinite;
}
@keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.2} }
/* ── BETISES STYLES ── */
#betisesBtn:hover {
  background: rgba(255,110,176,0.12) !important;
  border-color: rgba(255,110,176,0.5) !important;
  color: #ff6eb0 !important;
}

#topBubbleMenu {
  display: flex;
  gap: 7px;
  padding: 14px 16px 0;
  flex-wrap: wrap;
}
.bubbleBtn {
  padding: 6px 14px;
  border-radius: 20px;
  background: var(--s2);
  color: var(--sub);
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  user-select: none;
  border: 1px solid var(--border);
  transition: background 0.15s, color 0.15s, transform 0.15s, box-shadow 0.15s;
}
.bubbleBtn:hover {
  background: var(--s3);
  color: var(--text);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}
#quizBtn:hover {
  background: rgba(255,110,176,0.18) !important;
  border-color: rgba(255,110,176,0.65) !important;
  color: #ff6eb0 !important;
  box-shadow: 0 4px 16px rgba(255,110,176,0.22);
}
#gamesBtn:hover {
  background: rgba(96,165,250,0.18) !important;
  border-color: rgba(96,165,250,0.65) !important;
  color: #60a5fa !important;
  box-shadow: 0 4px 16px rgba(96,165,250,0.22);
}

.section { padding: 16px 16px 0; }
.section-label {
  font-size: 10px;
  font-weight: 700;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 2.5px;
  margin-bottom: 14px;
  display: flex; align-items: center; gap: 8px;
}
.section-label::after {
  content: '';
  flex: 1;
  height: 1px;
  background: var(--border);
}

.counter-wrap { display: flex; gap: 8px; }
.counter-unit {
  flex: 1; background: var(--s1); border-radius: var(--radius);
  padding: 14px 6px; text-align: center; border: 1px solid var(--border);
  transition: transform 0.2s, box-shadow 0.2s; position: relative; overflow: hidden;
}
.counter-unit::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--green), transparent); opacity: 0.5;
}
.counter-unit:hover { transform: translateY(-2px); box-shadow: var(--shadow); }

/* ── Nouveau bloc compteur unifié ── */
.counter-block {
  background: var(--s1);
  border-radius: var(--radius);
  border: 1px solid var(--border);
  position: relative;
  overflow: hidden;
  transition: box-shadow 0.3s, border-color 0.3s;
}
.counter-block-top {
  position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--green), transparent);
  opacity: 0.5;
}
.counter-block-inner {
  display: flex; align-items: center; justify-content: center;
  padding: 12px 12px; gap: 4px;
}
.counter-block-unit {
  display: flex; flex-direction: column; align-items: center; flex: 1;
}
.counter-block-unit.main-unit { flex: 1.2; }
.counter-block-sep {
  font-size: 20px; font-weight: 700; color: var(--muted);
  line-height: 1; margin-bottom: 14px; opacity: 0.5; flex-shrink: 0;
}
.c-num {
  display: block;
  font-size: 21px;
  font-weight: 700;
  color: var(--text);
  font-variant-numeric: tabular-nums;
  line-height: 1;
}
.c-num-big { font-size: 30px; }
.c-lbl {
  display: block;
  font-size: 9px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  margin-top: 4px;
}
.counter-since {
  margin-top: 8px;
  font-size: 11px;
  color: var(--muted);
  display: flex; align-items: center; gap: 5px;
}

.tl-wrap {
  position: relative;
  padding-left: 22px;
}
.tl-line {
  position: absolute;
  left: 3px; top: 6px; bottom: 0;
  width: 2px;
  background: linear-gradient(to bottom, var(--green), transparent);
  border-radius: 1px;
}
.tl-wrap.collapsed {
  max-height: 120px;
  overflow: hidden;
  -webkit-mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
  mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
}
.tl-wrap.expanded {
  max-height: 2000px;
  overflow: visible;
  -webkit-mask-image: none;
  mask-image: none;
  transition: max-height 0.4s ease;
}
.tl-item {
  position: relative;
  margin-bottom: 16px;
  opacity: 0;
  transform: translateX(-12px);
  transition: opacity 0.45s, transform 0.45s;
}
.tl-item.visible { opacity: 1; transform: none; }
.tl-dot {
  position: absolute;
  left: -20px; top: 6px;
  width: 8px; height: 8px;
  border-radius: 50%;
  background: var(--green);
  box-shadow: 0 0 0 3px rgba(0,201,167,0.2);
}
.tl-date {
  font-size: 9px; font-weight: 700;
  color: var(--green);
  text-transform: uppercase;
  letter-spacing: 1.5px;
  margin-bottom: 4px;
}
.tl-card {
  background: var(--s1);
  border-radius: var(--radius);
  padding: 12px 14px;
  border: 1px solid var(--border);
  transition: border-color 0.2s, box-shadow 0.2s;
}
.tl-card:hover { border-color: rgba(0,201,167,0.2); box-shadow: 0 4px 16px rgba(0,0,0,0.2); }
.tl-card h3 { font-size: 13px; font-weight: 600; color: var(--text); margin-bottom: 3px; }
.tl-card p  { font-size: 11px; color: var(--sub); line-height: 1.6; }
.tl-toggle {
  font-size: 10px;
  color: var(--green);
  font-weight: 600;
  letter-spacing: 1px;
  text-transform: uppercase;
  cursor: pointer;
  margin-top: 10px;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  user-select: none;
  transition: opacity 0.15s;
  padding: 4px 0;
}
.tl-toggle:hover { opacity: 0.75; }

#reasonBox {
  background: var(--s1);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px 18px;
  cursor: pointer;
  min-height: 120px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 10px;
  transition: background 0.2s, transform 0.2s, box-shadow 0.2s, border-color 0.2s;
  position: relative;
  overflow: hidden;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}
#reasonBox::before {
  content: '';
  position: absolute; inset: 0;
  background: radial-gradient(ellipse at 20% 60%, rgba(0,201,167,0.07) 0%, transparent 65%);
  pointer-events: none;
  transition: opacity 0.3s;
}
#reasonBox:hover { background: var(--s2); transform: translateY(-2px); box-shadow: 0 8px 28px rgba(0,0,0,0.28); border-color: rgba(0,201,167,0.22); }
#reasonBox:active { transform: scale(0.98); }
#reasonBox:hover::before { opacity: 1.8; }
.r-label { font-size: 9px; font-weight: 700; color: var(--green); text-transform: uppercase; letter-spacing: 2px; opacity: 0.85; }
#reasonText {
  font-family: 'DM Sans', sans-serif;
  font-size: clamp(14px, 4vw, 17px);
  color: var(--text);
  line-height: 1.55;
  font-weight: 500;
  /* animation state managed by JS */
  will-change: opacity, transform, filter;
}
#reasonText.reason-out-up {
  animation: reasonOutUp 0.22s cubic-bezier(0.4,0,1,1) forwards;
}
#reasonText.reason-in-down {
  animation: reasonInDown 0.3s cubic-bezier(0.0,0.0,0.2,1) forwards;
}
@keyframes reasonOutUp {
  0%   { opacity:1; transform:translateY(0) scale(1); filter:blur(0px); }
  100% { opacity:0; transform:translateY(-14px) scale(0.97); filter:blur(3px); }
}
@keyframes reasonInDown {
  0%   { opacity:0; transform:translateY(16px) scale(0.97); filter:blur(3px); }
  60%  { opacity:1; filter:blur(0px); }
  100% { opacity:1; transform:translateY(0) scale(1); filter:blur(0px); }
}
.r-hint {
  font-size: 10px; color: var(--muted); display: flex; align-items: center; gap: 5px;
  transition: color 0.2s;
}
#reasonBox:hover .r-hint { color: var(--sub); }

.postit-wrap {
  position: relative;
  height: 108px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.postit {
  border-radius: 8px;
  position: absolute;
  width: calc(100% - 0px);
  max-width: 500px;
  overflow: hidden;
  box-shadow: var(--shadow);
  cursor: pointer;
  user-select: none;
  transition: transform 0.35s cubic-bezier(.4,2,.55,.9), opacity 0.28s;
  display: flex;
  align-items: stretch;
  height: 74px;
}
.p-art {
  width: 60px; flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: 26px;
}
.p-body {
  flex: 1; padding: 10px 12px;
  background: var(--s2);
  display: flex; flex-direction: column; justify-content: center; gap: 3px;
  min-width: 0; overflow: hidden;
}
.p-title { font-size: 12px; font-weight: 600; color: var(--text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%; }
.p-text {
  font-size: 11px; color: var(--sub); line-height: 1.4;
  display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
  word-break: break-word;
}
.stack-hint { font-size: 10px; color: var(--muted); text-align: center; margin-top: 10px; }
.stack-ctr  { font-size: 10px; color: var(--green); text-align: center; margin-top: 4px; font-weight: 600; }

.slider { display: flex; gap: 14px; overflow-x: auto; scroll-snap-type: x mandatory; padding-bottom: 6px; }
.slider::-webkit-scrollbar { display: none; }
.album-card { min-width: 130px; flex: 0 0 auto; scroll-snap-align: start; }
.album-image { position: relative; width: 130px; height: 130px; border-radius: 8px; overflow: hidden; background: var(--s2); }
.album-image img { width:100%; height:100%; object-fit:cover; transition: transform 0.35s; }
.album-image:hover img { transform: scale(1.06); }
.album-heart { position:absolute; top:6px; left:6px; font-size:16px; cursor:pointer; z-index:2; transition:transform 0.25s; }
.album-heart:hover { transform:scale(1.35); }
.album-banner {
  position:absolute; bottom:0; left:0; width:100%;
  padding:6px 8px; font-size:11px; font-weight:600;
  color:#fff; text-align:center;
  background:rgba(0,0,0,0.72);
}
.album-desc { margin-top:7px; font-size:11px; color:var(--sub); max-width:130px; line-height:1.4; }

/* ── Section LUI — upload ── */
.lui-card-wrap { position:relative; }
.lui-upload-btn {
  position:absolute; inset:0; border-radius:8px;
  background:rgba(0,0,0,0.45); display:flex; flex-direction:column;
  align-items:center; justify-content:center; gap:5px;
  opacity:0; transition:opacity 0.2s; cursor:pointer; z-index:5;
  border:2px dashed rgba(232,121,160,0.6);
}
.lui-upload-btn:hover { opacity:1; }
.lui-upload-btn.empty { opacity:1; background:rgba(0,0,0,0.18); }
.lui-upload-icon { font-size:26px; line-height:1; }
.lui-upload-lbl { font-size:10px; font-weight:700; color:#fff; letter-spacing:0.5px; text-align:center; padding:0 4px; }
.lui-uploading { position:absolute; inset:0; border-radius:8px; background:rgba(0,0,0,0.65); display:none; flex-direction:column; align-items:center; justify-content:center; gap:8px; z-index:6; }
.lui-uploading.show { display:flex; }
.lui-upload-progress { width:80%; height:4px; background:rgba(255,255,255,0.2); border-radius:2px; overflow:hidden; }
.lui-upload-bar { height:100%; background:#e879a0; width:0%; transition:width 0.3s; border-radius:2px; }
.lui-upload-status { font-size:10px; color:#fff; font-weight:600; }
.lui-img-empty { width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px; background:var(--s2); border:2px dashed rgba(232,121,160,0.25); border-radius:8px; transition: border-color 0.2s, background 0.2s; }
.lui-img-empty:hover { background: var(--s3); border-color: rgba(232,121,160,0.5); }
.lui-img-empty-icon { font-size:28px; opacity:0.45; }
.lui-img-empty-lbl { font-size:9px; color:var(--muted); font-weight:700; letter-spacing:0.8px; text-transform: uppercase; opacity: 0.7; }
.lui-desc-editable {
  cursor: pointer;
  position: relative;
  transition: color 0.2s, background 0.15s;
  display: flex;
  align-items: center;
  gap: 5px;
  border-radius: 6px;
  padding: 3px 5px 3px 3px;
  margin-top: 5px;
  margin-left: -3px;
  max-width: 140px;
}
.lui-desc-editable::after {
  content: '✏️';
  font-size: 9px;
  opacity: 0.5;
  transition: opacity 0.2s;
  flex-shrink: 0;
  line-height: 1;
}
.lui-desc-editable:hover {
  color: #e879a0;
  background: rgba(232,121,160,0.10);
}
.lui-desc-editable:hover::after { opacity: 1; }
.lui-desc-editable:active { background: rgba(232,121,160,0.18); transform: scale(0.97); }
/* Modal édition description */
#descEditModal {
  position:fixed; inset:0; z-index:7000;
  background:rgba(0,0,0,0.6); backdrop-filter:blur(8px);
  display:none; align-items:flex-end; justify-content:center;
  padding-bottom: var(--safe-bottom);
}
#descEditModal.open { display:flex; }
.desc-edit-sheet {
  background:var(--s1); border:1px solid var(--border);
  border-radius:22px 22px 0 0; padding:12px 20px 28px;
  width:100%; max-width:480px;
  animation: slideUpSheet 0.32s cubic-bezier(0.22, 1, 0.36, 1);
}
.desc-edit-handle {
  width: 36px; height: 4px;
  background: rgba(255,255,255,0.18);
  border-radius: 2px;
  margin: 0 auto 16px;
}
body.light .desc-edit-handle { background: rgba(0,0,0,0.15); }
@keyframes slideUpSheet { from{transform:translateY(100%)} to{transform:translateY(0)} }
.desc-edit-label { font-size:13px; font-weight:700; color:var(--text); margin-bottom:12px; display:block; text-align: center; }
.desc-edit-input {
  width:100%; padding:14px 16px; font-size:15px;
  background:var(--s2); border:1.5px solid var(--border);
  border-radius:12px; color:var(--text); font-family:'DM Sans',sans-serif;
  outline:none; transition:border-color 0.2s, box-shadow 0.2s;
}
.desc-edit-input::placeholder { color: var(--muted); font-size: 13px; }
.desc-edit-input:focus { border-color:var(--green); box-shadow: 0 0 0 3px rgba(0,201,167,0.1); }
.desc-edit-actions { display:flex; gap:8px; margin-top:14px; }
.desc-edit-save { flex:1; padding:14px; background:var(--green); color:#000; font-weight:700; font-size:14px; font-family:'DM Sans',sans-serif; border:none; border-radius:12px; cursor:pointer; transition: background 0.15s, transform 0.1s; }
.desc-edit-save:hover { background: var(--green2); }
.desc-edit-save:active { transform: scale(0.97); }
.desc-edit-cancel { padding:14px 18px; background:var(--s2); color:var(--sub); font-size:14px; font-family:'DM Sans',sans-serif; border:1px solid var(--border); border-radius:12px; cursor:pointer; transition: background 0.15s; }
.desc-edit-cancel:hover { background: var(--s3); }

.song-list { display: flex; flex-direction: column; gap: 2px; }
.song { display:flex; align-items:center; gap:10px; padding:9px 10px; border-radius:8px; cursor:pointer; transition:background 0.15s; position:relative; border:1px solid transparent; }
.song:hover { background:var(--s2); }
.song.playing { background:rgba(0,201,167,0.10); border-color:rgba(0,201,167,0.22); }
.song-num { font-size:13px; color:var(--muted); width:18px; text-align:center; flex-shrink:0; }
.song.playing .song-num { color:var(--green); }
.song-info { flex:1; min-width:0; }
.song-title { font-size:13px; font-weight:500; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.song.playing .song-title { color:var(--green); }
.song-artist { font-size:11px; color:var(--muted); margin-top:2px; }
.badge-new { font-size:7px; font-weight:700; letter-spacing:0.8px; text-transform:uppercase; vertical-align:super; line-height:1; margin-left:4px; background:linear-gradient(90deg, var(--green) 0%, #fff 50%, var(--green) 100%); background-size:200% auto; -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; animation:badgeShimmer 2.5s linear infinite; }
@keyframes badgeShimmer { 0%{background-position:200% center} 100%{background-position:-200% center} }
.song-actions { display:flex; gap:5px; flex-shrink:0; }
.btn-play { width:34px; height:34px; border-radius:50%; border:none; background:var(--green); color:#000; font-size:12px; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:background 0.15s, transform 0.12s; box-shadow:0 2px 8px rgba(0,201,167,0.25); flex-shrink:0; }
.btn-play:hover { background:var(--green2); transform:scale(1.08); }
.btn-play.active { background:var(--green2); }
.btn-yt { width:32px; height:32px; border-radius:50%; border:none; background:var(--s3); color:var(--sub); font-size:10px; font-weight:700; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:background 0.15s, transform 0.12s; }
.btn-yt:hover { background:#FF0000; color:#fff; transform:scale(1.1); }
audio { display: none; }

.top50-header { position:relative; overflow:hidden; background:linear-gradient(180deg,var(--s2) 0%,var(--bg) 100%); padding:22px 16px 16px; }
.top50-header::before { content:''; position:absolute; inset:0; background:radial-gradient(ellipse at 10% 30%,rgba(0,201,167,0.12) 0%,transparent 60%); pointer-events:none; }
.top50-meta { font-size:9px; font-weight:700; color:var(--green); text-transform:uppercase; letter-spacing:3px; margin-bottom:5px; display:flex; align-items:center; gap:6px; }
.top50-meta::before { content:''; display:inline-block; width:16px; height:2px; background:var(--green); border-radius:1px; }
.top50-title { font-family:'Playfair Display',serif; font-size:clamp(20px,6vw,30px); font-weight:700; color:var(--text); line-height:1.1; letter-spacing:-0.5px; margin-bottom:5px; }
.top50-desc { font-size:11px; color:var(--muted); line-height:1.5; margin-bottom:12px; }
.top50-controls { display:flex; align-items:center; gap:14px; }
.top50-play-all { width:38px; height:38px; border-radius:50%; background:var(--green); border:none; cursor:pointer; display:flex; align-items:center; justify-content:center; color:#000; transition:transform 0.12s,background 0.15s; box-shadow:0 4px 16px rgba(0,201,167,0.3); flex-shrink:0; }
.top50-play-all:hover { transform:scale(1.08); background:var(--green2); }
.top50-play-all.playing {
  background: var(--green);
  animation: playAllPulse 2.5s ease-in-out infinite;
  will-change: transform;
}
.top50-play-all.playing:hover { background: var(--green2); transform: scale(1.08); }
@keyframes playAllPulse {
  0%,100% { transform: scale(1); }
  50%     { transform: scale(1.06); }
}
body.light .top50-play-all.playing {
  animation: playAllPulse 2.5s ease-in-out infinite;
}
.top50-play-all .pa-wave {
  display: none; align-items: flex-end; gap: 2px; height: 14px;
}
.top50-play-all.playing .pa-wave { display: flex; }
.pa-wave span {
  display: inline-block; width: 3px; border-radius: 2px;
  background: var(--green);
  animation: paWave 0.8s ease-in-out infinite;
}
.pa-wave span:nth-child(1) { height: 6px;  animation-delay: 0s; }
.pa-wave span:nth-child(2) { height: 10px; animation-delay: 0.15s; }
.pa-wave span:nth-child(3) { height: 7px;  animation-delay: 0.3s; }
@keyframes paWave {
  0%,100% { transform: scaleY(0.5); opacity: 0.6; }
  50%      { transform: scaleY(1);   opacity: 1; }
}
.top50-mode-btn {
  width:36px; height:36px; border-radius:50%; border:none;
  background:var(--s3); color:var(--muted);
  cursor:pointer; display:flex; align-items:center; justify-content:center;
  transition:color 0.15s, background 0.15s, transform 0.12s;
  flex-shrink:0;
}
.top50-mode-btn:hover { background:var(--s2); color:var(--text); transform:scale(1.08); }
.top50-mode-btn.active { color:var(--green); }
.top50-mode-btn svg { width:17px; height:17px; }
.top50-stats { font-size:11px; color:var(--muted); }
.top50-stats span { color:var(--sub); font-weight:600; }
.top50-col-header { display:flex; align-items:center; padding:8px 10px 8px 16px; border-bottom:1px solid var(--border); margin:0 0 2px; }
.col-h-num { width:28px; font-size:9px; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:1.5px; flex-shrink:0; text-align:center; }
.col-h-title { flex:1; font-size:9px; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:1.5px; }
.col-h-plays { width:72px; font-size:9px; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:1.5px; text-align:right; flex-shrink:0; }
.col-h-actions { width:72px; flex-shrink:0; }
.sp-song { display:flex; align-items:center; gap:10px; padding:7px 10px 7px 16px; border-radius:6px; cursor:pointer; transition:background 0.12s; border:1px solid transparent; }
.sp-song:hover { background:rgba(255,255,255,0.06); }
.sp-song.playing { background:rgba(0,201,167,0.09); border-color:rgba(0,201,167,0.18); }
.sp-rank { width:28px; flex-shrink:0; text-align:center; position:relative; height:20px; display:flex; align-items:center; justify-content:center; }
.sp-trend { position:absolute; bottom:-6px; left:50%; transform:translateX(-50%); font-size:0; line-height:1; }
.sp-trend::before { font-size:7px; font-weight:700; letter-spacing:0; }
.sp-trend.up::before   { content:'▲'; color:#4fc3f7; }
.sp-trend.down::before { content:'▼'; color:#ef5350; }
.sp-trend.new::before  { content:'NEW'; font-size:5.5px; color:#a78bfa; letter-spacing:0.3px; }
.sp-rank-num { font-size:13px; font-weight:700; color:var(--muted); font-variant-numeric:tabular-nums; }
.sp-song.playing .sp-rank-num { display:none; }
.sp-rank-wave { display:none; align-items:flex-end; gap:2px; height:16px; }
.sp-song.playing .sp-rank-wave { display:flex; }
.wave-bar { width:3px; background:var(--green); border-radius:1px; animation:waveBar 0.8s ease-in-out infinite alternate; }
.wave-bar:nth-child(1){animation-delay:0s;animation-duration:0.55s;}
.wave-bar:nth-child(2){animation-delay:0.15s;animation-duration:0.75s;}
.wave-bar:nth-child(3){animation-delay:0.3s;animation-duration:0.5s;}
@keyframes waveBar { from{height:4px} to{height:14px} }
.sp-info { flex:1; min-width:0; }
.sp-title { font-size:13px; font-weight:500; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; transition:color 0.15s; }
.sp-song.playing .sp-title { color:var(--green); }
.sp-artist { font-size:11px; color:var(--muted); margin-top:1px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.sp-plays { width:72px; flex-shrink:0; text-align:right; font-size:11px; color:var(--muted); font-variant-numeric:tabular-nums; font-weight:500; }
.sp-actions { width:72px; flex-shrink:0; display:flex; gap:4px; justify-content:flex-end; }
.sp-btn-play { width:30px; height:30px; border-radius:50%; border:none; background:var(--green); color:#000; font-size:12px; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:background 0.15s,transform 0.12s; opacity:0; box-shadow:0 2px 6px rgba(0,201,167,0.2); }
.sp-song:hover .sp-btn-play,.sp-btn-play.active { opacity:1; }
.sp-btn-play:hover { background:var(--green2); transform:scale(1.08); }
.sp-btn-play.active { background:var(--green2); }
.sp-btn-yt { width:30px; height:30px; border-radius:50%; border:none; background:transparent; color:var(--muted); font-size:9px; font-weight:700; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:color 0.15s,background 0.15s; opacity:0; }
.sp-song:hover .sp-btn-yt { opacity:1; }
.sp-btn-yt:hover { color:#fff; background:#FF0000; }
.top50-expand { display:flex; align-items:center; justify-content:center; gap:8px; padding:13px 16px; font-size:12px; font-weight:600; color:var(--sub); cursor:pointer; border-top:1px solid var(--border); transition:color 0.15s,background 0.15s; }
.top50-expand:hover { color:var(--text); background:var(--s2); }
.top50-expand-icon { font-size:13px; transition:transform 0.3s; }
.top50-expand.open .top50-expand-icon { transform:rotate(180deg); }
.sp-song.hidden-row { display:none; }
.sp-song.hidden-row.revealed { display:flex; animation:slideUp 0.3s ease; }

#loveBox {
  margin: 0 16px;
  cursor: pointer; user-select: none;
  padding: 18px 16px;
  min-height: 72px;
  display: flex; align-items: center; justify-content: center; flex-direction: column;
  background: linear-gradient(135deg, var(--s1) 0%, rgba(255,110,176,0.06) 100%);
  border-radius: 16px;
  border: 1px solid rgba(255,110,176,0.25);
  transition: transform 0.15s, box-shadow 0.15s, border-color 0.15s;
  text-align: center; position: relative; overflow: hidden;
  box-shadow: 0 4px 20px rgba(255,110,176,0.08), inset 0 1px 0 rgba(255,255,255,0.04);
}
#loveBox::before {
  content: '';
  position: absolute; inset: 0;
  background: radial-gradient(ellipse at 50% 0%, rgba(255,110,176,0.12) 0%, transparent 65%);
  pointer-events: none;
}
#loveBox::after {
  content: '';
  position: absolute; bottom: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, transparent, rgba(255,110,176,0.5), transparent);
}
#loveBox .lb-text {
  display: block;
  font-size: 15px; font-weight: 600; font-family: 'DM Sans', sans-serif;
  color: var(--text); line-height: 1.4;
  transition: opacity 0.2s;
}
#loveBox .lb-icon {
  display: block; font-size: 22px; margin-bottom: 6px;
  animation: lbHeartbeat 3s ease-in-out infinite;
}
@keyframes lbHeartbeat {
  0%,100% { transform: scale(1); }
  30%      { transform: scale(1.18); }
  50%      { transform: scale(1); }
  65%      { transform: scale(1.1); }
}
#loveBox:hover { transform: translateY(-3px); box-shadow: 0 8px 28px rgba(255,110,176,0.22); border-color: rgba(255,110,176,0.5); }
#loveBox:active { transform: scale(0.97); }


/* Reflet lumineux qui traverse de gauche à droite */
#loveBox::after {
  content: '';
  position: absolute;
  top: 0; left: 0; width: 60%; height: 100%;
  background: linear-gradient(105deg, transparent 30%, rgba(255,255,255,0.14) 50%, transparent 70%);
  animation: lbSweep 4s ease-in-out infinite;
  pointer-events: none;
  z-index: 1;
  will-change: transform;
  transform: translateX(-100%);
}
@keyframes lbSweep {
  0%   { transform: translateX(-100%); opacity: 0; }
  10%  { opacity: 1; }
  50%  { transform: translateX(250%); opacity: 1; }
  55%  { opacity: 0; }
  100% { transform: translateX(250%); opacity: 0; }
}

body.light #loveBox {
  background: linear-gradient(135deg, #fff5f8 0%, rgba(200,24,94,0.05) 100%);
  border-color: rgba(200,24,94,0.25);
  box-shadow: 0 4px 20px rgba(200,24,94,0.09), inset 0 1px 0 rgba(255,255,255,0.8);
}
body.light #loveBox::before { background: radial-gradient(ellipse at 50% 0%, rgba(200,24,94,0.1) 0%, transparent 65%); }
body.light #loveBox::after { background: linear-gradient(90deg, transparent, rgba(200,24,94,0.4), transparent); }
body.light #loveBox .lb-label { color: rgba(200,24,94,0.65); }

#particleCanvas { position: fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1; contain: strict; isolation: isolate; }

#danceZone {
  display: flex; justify-content: center; gap: 30px; font-size: 44px;
  opacity: 0; transition: opacity 0.4s; pointer-events: none; padding: 24px 0 32px;
}
@keyframes danceGirl { 0%,100%{transform:rotate(0) scale(1)} 25%{transform:rotate(-12deg) scale(1.03)} 50%{transform:rotate(8deg) scale(1)} 75%{transform:rotate(-5deg) scale(1.02)} }
@keyframes danceBoy  { 0%,100%{transform:rotate(0) scale(1)} 25%{transform:rotate(12deg) scale(1.03)} 50%{transform:rotate(-8deg) scale(1)} 75%{transform:rotate(5deg) scale(1.02)} }
#dancerGirl.animate { animation: danceGirl 0.65s infinite; }
#dancerBoy.animate  { animation: danceBoy  0.65s infinite; }

.bottom-nav {
  position: fixed; bottom:0; left:0; width:100%;
  background: #111111;
  display: flex; flex-direction: column; justify-content: flex-start; align-items: stretch;
  border-top: 1px solid rgba(255,255,255,0.06); z-index: 1000;
  /* Padding gauche/droite pour les iPhones en mode paysage */
  padding-left: var(--safe-left);
  padding-right: var(--safe-right);
}
.bottom-nav-inner {
  height: 64px;
  display: flex; justify-content: space-around; align-items: center;
  padding: 0 2px;
}
.bottom-nav-safe {
  /* Bande transparente = home indicator sur iPhone */
  height: var(--safe-bottom);
  min-height: var(--safe-bottom);
  flex-shrink: 0;
}

/* ══ YAM TAB PANELS ══ */
.yam-tab-panel {
  display: none;
}
.yam-tab-panel.active {
  display: block;
  /* Hauteur minimale = viewport - header estimé - nav bar
     Évite que la bottom-nav remonte sur les onglets au contenu court (ex: Jeux) */
  min-height: calc(100dvh - var(--nav-height) - 120px);
}

/* ══ MESSAGES TAB ══ */

/* ══ NAV ACTIVE STATE ══ */
.nav-item.nav-active {
  color: var(--green) !important;
  transform: none !important;
}
.nav-item.nav-active svg {
  filter: drop-shadow(0 0 4px rgba(0,201,167,0.5));
}
body.light .nav-item.nav-active {
  color: var(--green) !important;
}
body.light .nav-item.nav-active svg {
  filter: drop-shadow(0 0 4px rgba(200,24,94,0.4));
}

/* ══ YAM ACCUEIL ══ */
.yam-mascotte-zone {
  margin: 12px 16px 0;
  background: linear-gradient(135deg, var(--s1) 0%, rgba(232,130,58,0.07) 100%);
  border: 1px dashed rgba(232,130,58,0.35);
  border-radius: 20px;
  min-height: 140px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
  position: relative;
  padding-top: 12px;
}
.yam-mascotte-zone::before {
  content: '';
  position: absolute; inset: 0;
  background: radial-gradient(ellipse at 50% 80%, rgba(232,130,58,0.08) 0%, transparent 65%);
  pointer-events: none;
}
.yam-mascotte-placeholder {
  font-size: 64px;
  line-height: 1;
  animation: yamFloat 3s ease-in-out infinite;
  will-change: transform;
}
@keyframes yamFloat {
  0%,100% { transform: translateY(0px); }
  50%      { transform: translateY(-8px); }
}
.yam-mascotte-label {
  font-family: 'Playfair Display', serif;
  font-size: 18px;
  font-weight: 700;
  color: var(--text);
  opacity: 0.8;
}
.yam-mascotte-sub {
  font-size: 11px;
  color: var(--muted);
  letter-spacing: 0.5px;
}
.yam-mood-strip {
  margin: 14px 16px 0;
  display: flex;
  align-items: center;
  gap: 10px;
}
.yam-mood-card {
  flex: 1;
  background: var(--s1);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 12px 14px;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: border-color 0.2s;
}
.yam-mood-avatar {
  width: 38px; height: 38px;
  border-radius: 50%;
  background: var(--s2);
  display: flex; align-items: center; justify-content: center;
  font-size: 20px;
  flex-shrink: 0;
}
.yam-mood-info {
  flex: 1; min-width: 0;
}
.yam-mood-name {
  font-size: 11px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 1px;
}
.yam-mood-state {
  font-size: 11px;
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.yam-mood-likes {
  font-size: 11px;
  color: var(--muted);
  margin-top: 3px;
  display: flex;
  align-items: center;
  gap: 2px;
}
#yamHeartSpamBtn:hover {
  transform: scale(1.12);
  box-shadow: 0 6px 22px rgba(232,121,160,0.32);
  border-color: rgba(232,121,160,0.7);
}
#yamHeartSpamBtn:active {
  transform: scale(0.92) !important;
}

/* ══ JEUX TAB ══ */
.yam-jeux-header {
  padding: 20px 16px 0;
  margin-bottom: 4px;
}
.yam-betises-cta {
  margin: 14px 16px 0;
  padding: 16px;
  background: linear-gradient(135deg, rgba(255,110,176,0.08) 0%, rgba(167,139,250,0.08) 100%);
  border: 1px solid rgba(255,110,176,0.3);
  border-radius: 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  transition: border-color 0.2s, transform 0.15s, background 0.2s;
}
.yam-betises-cta:hover {
  border-color: rgba(255,110,176,0.6);
  background: linear-gradient(135deg, rgba(255,110,176,0.14) 0%, rgba(167,139,250,0.14) 100%);
  transform: scale(1.01);
}
.yam-betises-cta-icon { font-size: 32px; flex-shrink: 0; }
.yam-betises-cta-label { font-size: 14px; font-weight: 700; color: var(--text); }
.yam-betises-cta-sub { font-size: 11px; color: var(--muted); margin-top: 2px; }

.yam-quiz-cta {
  margin: 10px 16px 0;
  padding: 14px 16px;
  background: linear-gradient(135deg, rgba(255,110,176,0.06) 0%, rgba(96,165,250,0.06) 100%);
  border: 1px solid rgba(255,110,176,0.25);
  border-radius: 14px;
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  transition: border-color 0.2s, transform 0.15s;
}
.yam-quiz-cta:hover {
  border-color: rgba(255,110,176,0.5);
  transform: scale(1.01);
}

/* ══ MUSIQUE TAB ══ */

/* ══ NOUS TAB ══ */
/* ══════════════════════════════════════════
   MODE CLAIR — OVERRIDES COMPLETS
══════════════════════════════════════════ */

/* Body */
body.light {
  background-image:
    radial-gradient(ellipse at 80% 0%, rgba(200,24,94,0.07) 0%, transparent 55%),
    radial-gradient(ellipse at 10% 100%, rgba(200,24,94,0.05) 0%, transparent 50%);
}

/* Header */
body.light header {
  background: linear-gradient(180deg, rgba(200,24,94,0.06) 0%, transparent 100%);
  border-bottom-color: rgba(200,24,94,0.18);
}

/* ── Bouton thème dans le header : décaler sous le Dynamic Island ── */
#themeToggleHome {
  top: calc(var(--safe-top) + 10px) !important;
}
body.light header::before { background: radial-gradient(circle, rgba(200,24,94,0.12) 0%, transparent 70%); }

/* Navigation basse */
body.light .bottom-nav {
  background: #fdf0f6;
  border-top: 1px solid rgba(200,24,94,0.2);
  box-shadow: 0 -4px 20px rgba(180,20,80,0.10);
}
body.light .nav-item { color: #b06080; }
body.light .nav-item:hover { color: #1e0510; }

/* Cartes / surfaces */
body.light .counter-block,
body.light .counter-unit,
body.light #reasonBox,
body.light #loveBox,
body.light .tl-card,
body.light .postit .p-body,
body.light .album-image {
  box-shadow: 0 2px 12px rgba(180,20,80,0.09), 0 1px 3px rgba(180,20,80,0.06);
}
body.light .counter-block { border-color: rgba(200,24,94,0.22); }
body.light .counter-block-top { background: linear-gradient(90deg, #c8185e 0%, rgba(200,24,94,0.2) 100%); opacity: 0.7; }

/* Section labels */
body.light .section-label { color: #9a1048; }
body.light .section-label::after { background: rgba(200,24,94,0.2); }
body.light .hdr-tag { letter-spacing: 3px; }
body.light .hdr-sub::before { background: #c8185e; box-shadow: 0 0 6px rgba(200,24,94,0.5); }

/* Bubble menu */
body.light .bubbleBtn {
  background: #fff0f6;
  border-color: rgba(200,24,94,0.22);
  color: #6b2040;
  box-shadow: 0 1px 4px rgba(180,20,80,0.08);
}
body.light .bubbleBtn:hover {
  background: #fde0ec;
  color: #1e0510;
  border-color: rgba(200,24,94,0.45);
  box-shadow: 0 3px 10px rgba(180,20,80,0.14);
}

/* Timeline */
body.light .tl-line { background: linear-gradient(to bottom, #c8185e, transparent); }
body.light .tl-dot { background: #c8185e; box-shadow: 0 0 0 3px rgba(200,24,94,0.22), 0 0 10px rgba(200,24,94,0.3); }
body.light .tl-card { border-color: rgba(200,24,94,0.14); }
body.light .tl-card:hover { border-color: rgba(200,24,94,0.32); box-shadow: 0 4px 18px rgba(180,20,80,0.13); }

/* Songs */
body.light .song.playing { background: rgba(200,24,94,0.08); border-color: rgba(200,24,94,0.25); }
body.light .song:hover { background: rgba(200,24,94,0.05); }
body.light .song-num { color: #b06080; }
body.light .song-artist { color: #9a6070; }

/* Top 50 */
body.light .top50-header { background: linear-gradient(180deg, rgba(200,24,94,0.12) 0%, var(--bg) 100%); }
body.light .top50-header::before { background: radial-gradient(ellipse at 10% 30%, rgba(200,24,94,0.14) 0%, transparent 60%); }
body.light .sp-song:hover { background: rgba(200,24,94,0.05); }
body.light .sp-song.playing { background: rgba(200,24,94,0.08); border-color: rgba(200,24,94,0.22); }
body.light .top50-play-all { box-shadow: 0 4px 18px rgba(200,24,94,0.35); }

/* Reason / love boxes */
body.light #reasonBox { border-color: rgba(200,24,94,0.18); }
body.light #reasonBox::before { background: radial-gradient(circle at 30% 50%, rgba(200,24,94,0.07) 0%, transparent 60%); }
body.light #reasonBox:hover { box-shadow: 0 6px 24px rgba(180,20,80,0.16); }
/* loveBox light handled in component CSS */

/* Overlays / modals */
body.light #searchOverlay { background: rgba(30,5,16,0.45); }
body.light .search-popup { box-shadow: 0 -6px 32px rgba(180,20,80,0.14); border-color: rgba(200,24,94,0.2); }
body.light #lockPopup { box-shadow: 0 4px 24px rgba(180,20,80,0.16); border-color: rgba(200,24,94,0.22); }
body.light .memo-modal-inner,
body.light .memo-auth-inner { box-shadow: 0 8px 40px rgba(180,20,80,0.18); border-color: rgba(200,24,94,0.22); }

/* Games — jeux overlay */
body.light #gamesView,
body.light #quizView { background: #f9e8f0; }
body.light .gv-back { color: #c8185e; }
body.light #storyCountdown { background: rgba(200,24,94,0.10); border-color: rgba(200,24,94,0.20); }
body.light .gv-tag { color: #c8185e; }
body.light .gv-game-card {
  background: #fff5f8;
  border-color: rgba(200,24,94,0.18);
  box-shadow: 0 2px 12px rgba(180,20,80,0.09);
}
body.light .gv-game-card:hover {
  border-color: rgba(200,24,94,0.4);
  box-shadow: 0 6px 22px rgba(180,20,80,0.16);
}

/* Memory */
body.light .memory-start-screen { background: rgba(200,24,94,0.05); border-color: rgba(200,24,94,0.2); }
body.light .memory-start-btn { background: rgba(200,24,94,0.12); color: #c8185e; border-color: rgba(200,24,94,0.35); }
body.light .memory-restart-btn { background: rgba(200,24,94,0.09); color: #c8185e; border-color: rgba(200,24,94,0.25); }
body.light .memory-stat { background: #fff5f8; border-color: rgba(200,24,94,0.2); box-shadow: 0 1px 6px rgba(180,20,80,0.08); }
body.light .memory-stat-num { color: #c8185e; }
body.light .memory-win { background: rgba(200,24,94,0.06); border-color: rgba(200,24,94,0.25); }
body.light .memory-win-replay { background: rgba(200,24,94,0.10); color: #c8185e; border-color: rgba(200,24,94,0.3); }
body.light .mem-card-front { background: #fde0ec; border-color: rgba(200,24,94,0.2); }
body.light .mem-card-back { background: rgba(200,24,94,0.1); border-color: rgba(200,24,94,0.3); }
body.light .mem-card.matched .mem-card-back { background: rgba(200,24,94,0.22); border-color: rgba(200,24,94,0.55); box-shadow: 0 0 20px rgba(200,24,94,0.22); }

/* Wheel */
body.light .wheel-center { border-color: #c8185e; box-shadow: 0 0 12px rgba(200,24,94,0.25); }
body.light #wheelResult { box-shadow: 0 2px 12px rgba(180,20,80,0.08); border-color: rgba(200,24,94,0.18); }
body.light #wheelResult.has-result { border-color: rgba(200,24,94,0.42); box-shadow: 0 0 22px rgba(200,24,94,0.12); }

/* Hidden page (page secrète) */
body.light #hiddenPage {
  background: var(--bg);
}
body.light .hp-header {
  border-bottom-color: rgba(200,24,94,0.2);
  background: linear-gradient(180deg, rgba(200,24,94,0.08) 0%, transparent 100%);
}
body.light .hp-back { color: #c8185e; }
body.light .hp-title { color: #1e0510; }
body.light .hp-sub { color: rgba(30,5,16,0.5); }

/* Quiz */
body.light .qz-option {
  background: #fff5f8;
  border-color: rgba(200,24,94,0.18);
  box-shadow: 0 1px 6px rgba(180,20,80,0.07);
}
body.light .qz-option:hover { border-color: rgba(200,24,94,0.4); background: #fde0ec; }
body.light .qz-result { background: #fff5f8; border-color: rgba(200,24,94,0.2); }

/* Nav lock */
/* Divers */
body.light .section-label { color: #9a1048; }
body.light #reasonBox { background: #fff5f8; }
/* loveBox light bg handled in component CSS */
.nav-item {
  display: flex; flex-direction: column; align-items: center;
  font-size: 9px; color: var(--muted); cursor: pointer; gap: 3px;
  transition: color 0.2s, transform 0.15s; flex: 1; min-width: 0; padding: 0 2px;
}
.nav-item:hover { color: var(--text); transform: translateY(-2px); }
.nav-item svg { flex-shrink: 0; }
#lockNavBtn { color: #a78bfa; position: relative; }
#lockNavBtn:hover { color: #c4b5fd; }
body.light #lockNavBtn { color: #7c3aed; }

/* Badge non-lus sur le cadenas */
#lockUnreadBadge {
  position: absolute;
  top: 2px; right: 6px;
  min-width: 16px; height: 16px;
  background: #ff4444;
  color: #fff;
  font-size: 9px; font-weight: 800;
  border-radius: 8px;
  display: none;
  align-items: center; justify-content: center;
  padding: 0 4px;
  border: 1.5px solid var(--bg);
  line-height: 1;
  z-index: 10;
}
#lockUnreadBadge.visible { display: flex; }

/* Clignotement cadenas quand non-lus */
@keyframes lockPulse {
  0%,100% { color: #a78bfa; opacity: 0.75; }
  50%     { color: #c4b5fd; opacity: 1; }
}
#lockNavBtn.has-unread {
  animation: lockPulse 2s ease-in-out infinite;
}
body.light #lockNavBtn.has-unread {
  animation: lockPulseLight 2s ease-in-out infinite;
}
@keyframes lockPulseLight {
  0%,100% { color: #7c3aed; opacity: 0.75; }
  50%     { color: #a78bfa; opacity: 1; }
}

@keyframes slideUp { from{transform:translateY(20px);opacity:0} to{transform:none;opacity:1} }
@keyframes slideOutRight { from{transform:translateX(0);opacity:1} to{transform:translateX(100%);opacity:0} }
#searchOverlay {
  position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 2000; display: none;
  align-items: flex-end; justify-content: center;
  backdrop-filter: blur(4px);
  padding-bottom: var(--nav-height);
}
#searchOverlay.open { display: flex; }
.search-popup {
  width: 100%; max-width: 480px;
  background: var(--s1); border: 1px solid var(--border);
  border-radius: 20px 20px 0 0;
  padding: 16px 16px 8px;
  animation: slideUp 0.22s ease;
  max-height: 70vh; display: flex; flex-direction: column;
}
.search-popup-bar { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
#searchInput {
  flex: 1; padding: 10px 14px; font-size: 14px; border-radius: 8px;
  background: var(--s2); color: var(--text); font-family: 'DM Sans', sans-serif;
  outline: none; border: 1px solid var(--border); transition: border-color 0.2s;
}
#searchInput:focus { border-color: var(--green); }
.search-close-btn {
  font-size: 20px; color: var(--muted); cursor: pointer; padding: 4px 6px;
  transition: color 0.15s; flex-shrink: 0; line-height: 1;
}
.search-close-btn:hover { color: var(--text); }
#searchResults { overflow-y: auto; flex: 1; }
#libraryPopup {
  position:fixed; bottom:calc(var(--nav-height) + 8px); left:50%; transform:translateX(-50%);
  background:var(--s2); padding:6px; border-radius:14px; display:none; z-index:1500;
  width:80%; max-width:300px; border:1px solid var(--border);
  box-shadow: var(--shadow);
  animation: popIn 0.2s cubic-bezier(.4,2,.55,.9);
}
@keyframes popIn { from{transform:translateX(-50%) scale(0.9);opacity:0} to{transform:translateX(-50%) scale(1);opacity:1} }
.lib-item {
  padding:11px 14px; cursor:pointer; color:var(--sub); border-radius:8px;
  font-size:13px; transition:background 0.12s, color 0.12s;
  display: flex; align-items: center; gap: 8px;
}
.lib-item:hover { background:var(--s3); color:var(--text); }

.like-heart { position:fixed; font-size:90px; left:50%; top:50%; transform:translate(-50%,-50%) scale(0); animation:pop 0.55s ease forwards; pointer-events:none; z-index:3000; }
@keyframes pop { 0%{transform:translate(-50%,-50%) scale(0)} 55%{transform:translate(-50%,-50%) scale(1.2)} 100%{transform:translate(-50%,-50%) scale(1);opacity:0} }
.clown-pop { position:fixed; left:50%; top:50%; transform:translate(-50%,-50%) scale(0); font-size:60px; pointer-events:none; z-index:3000; animation:clownPop 0.55s ease forwards; }
@keyframes clownPop { 0%{transform:translate(-50%,-50%) scale(0);opacity:1} 55%{transform:translate(-50%,-50%) scale(1.2);opacity:1} 100%{transform:translate(-50%,-50%) scale(1);opacity:0} }
.prank-toast { position:fixed; left:50%; bottom:120px; transform:translateX(-50%); background:rgba(30,30,40,0.95); border:1px solid rgba(255,255,255,0.12); backdrop-filter:blur(10px); border-radius:50px; padding:11px 22px; font-size:13px; font-weight:600; color:#fff; white-space:nowrap; z-index:9000; pointer-events:none; animation:prankToastAnim 2.4s ease forwards; }
@keyframes prankToastAnim { 0%{opacity:0;transform:translateX(-50%) translateY(10px)} 15%{opacity:1;transform:translateX(-50%) translateY(0)} 75%{opacity:1} 100%{opacity:0;transform:translateX(-50%) translateY(-6px)} }

#quizView {
  display: none; position: fixed; inset: 0; background: var(--bg); z-index: 500;
  overflow-y: auto; padding-bottom: var(--nav-height); transition: background 0.3s, color 0.3s;
  overscroll-behavior:contain; -webkit-overflow-scrolling:touch;
}
#quizView.active { display: block; }
.qz-header { padding: 28px 16px 20px; padding-top: calc(var(--safe-top) + 28px); border-bottom: 1px solid var(--border); position: relative; overflow: hidden; }
.qz-back { display:inline-flex; align-items:center; gap:7px; font-size:11px; font-weight:600; color:var(--sub); background:var(--s2); border:1px solid var(--border); border-radius:20px; padding:7px 14px; cursor:pointer; margin-bottom:10px; transition:background 0.15s, color 0.15s, transform 0.12s; }
.qz-back:hover { background:var(--s3); color:var(--text); transform:translateX(-2px); }
.qz-tag { font-size:10px; font-weight:700; letter-spacing:3px; text-transform:uppercase; color:var(--green); margin-bottom:4px; }
.qz-title { font-family:'Playfair Display',serif; font-size:clamp(28px,8vw,46px); font-weight:700; color:var(--text); line-height:1.05; letter-spacing:-0.5px; }
.qz-sub { font-size:12px; color:var(--muted); margin-top:6px; letter-spacing:0.5px; }
.qz-progress-wrap { padding:14px 16px 0; display:flex; align-items:center; gap:10px; }
.qz-progress-bar { flex:1; height:4px; background:var(--s3); border-radius:2px; overflow:hidden; }
.qz-progress-fill { height:100%; background:var(--green); border-radius:2px; transition:width 0.4s ease; }
.qz-progress-txt { font-size:10px; font-weight:700; color:var(--muted); white-space:nowrap; }
.qz-card { margin:16px 16px 0; background:var(--s1); border:1px solid var(--border); border-radius:12px; padding:18px 16px; min-height:90px; display:flex; flex-direction:column; justify-content:center; }
.qz-q-num { font-size:9px; font-weight:700; color:var(--green); text-transform:uppercase; letter-spacing:2.5px; margin-bottom:8px; }
.qz-q-text { font-size:15px; font-weight:600; color:var(--text); line-height:1.45; }
#qzHintBar { display:none; margin:10px 16px 0; padding:9px 13px; background:var(--s2); border:1px solid var(--border); border-radius:8px; font-size:12px; color:var(--sub); line-height:1.45; font-style:italic; }
.qz-options { padding:12px 16px 0; display:flex; flex-direction:column; gap:8px; }
.qz-opt { background:var(--s1); border:1px solid var(--border); border-radius:8px; padding:12px 14px; font-size:13px; font-weight:500; color:var(--sub); cursor:pointer; transition:background 0.15s, border-color 0.15s, color 0.15s, transform 0.1s; text-align:left; font-family:'DM Sans',sans-serif; }
.qz-opt:hover { background:var(--s2); border-color:var(--green); color:var(--text); transform:translateX(3px); }
.qz-opt.correct { background:rgba(0,201,167,0.12); border-color:rgba(0,201,167,0.5); color:#00e5bd; pointer-events:none; }
.qz-opt.wrong { background:rgba(255,60,60,0.08); border-color:rgba(255,60,60,0.35); color:#e05555; pointer-events:none; }
.qz-opt.disabled { pointer-events:none; opacity:0.35; }
.qz-feedback { margin:10px 16px 0; padding:10px 14px; border-radius:8px; font-size:12px; line-height:1.5; display:none; }
.qz-feedback.show { display:block; animation: slideUp 0.2s ease; }
.qz-feedback.good { background:rgba(0,201,167,0.08); color:#00e5bd; border:1px solid rgba(0,201,167,0.2); }
.qz-feedback.bad { background:rgba(220,50,50,0.07); color:#e05555; border:1px solid rgba(220,50,50,0.2); }
.qz-next-btn { display:none; margin:12px 16px 0; width:calc(100% - 32px); padding:13px; background:var(--green); color:#000; font-weight:700; font-size:14px; font-family:'DM Sans',sans-serif; border:none; border-radius:8px; cursor:pointer; transition:background 0.15s, transform 0.1s; letter-spacing:0.3px; }
.qz-next-btn.show { display:block; animation: slideUp 0.2s ease; }
.qz-next-btn:hover { background:var(--green2); transform:scale(1.02); }
.qz-result { display:none; margin:16px 16px 0; background:var(--s1); border:1px solid var(--border); border-radius:12px; padding:26px 16px; text-align:center; }
.qz-result.show { display:block; animation: slideUp 0.3s ease; }
.qz-result-emoji { font-size:52px; margin-bottom:12px; display:block; }
.qz-result-title { font-family:'Playfair Display',serif; font-size:22px; font-weight:700; color:var(--text); margin-bottom:6px; }
.qz-result-sub { font-size:13px; color:var(--sub); margin-bottom:18px; line-height:1.6; white-space:pre-line; }
.qz-code-box { display:none; background:var(--s2); border:2px solid var(--green); border-radius:10px; padding:14px 16px; margin-bottom:16px; text-align:center; }
.qz-code-box.show { display:block; }
.qz-code-label { font-size:9px; font-weight:700; color:var(--green); text-transform:uppercase; letter-spacing:2px; margin-bottom:6px; }
.qz-code-val { font-size:26px; font-weight:700; color:var(--text); letter-spacing:6px; font-family:monospace; }
.qz-retry-btn { width:100%; padding:11px; background:transparent; color:var(--green); font-weight:600; font-size:13px; font-family:'DM Sans',sans-serif; border:1px solid var(--border); border-radius:8px; cursor:pointer; transition:background 0.15s; margin-top:8px; }
.qz-retry-btn:hover { background:var(--s2); }

#wheelSection { padding: 26px 16px 0; }
.wheel-container { display:flex; flex-direction:column; align-items:center; gap:18px; }
.wheel-wrap { position:relative; width:min(240px,68vw); height:min(240px,68vw); }
#wheelCanvas { width:100%; height:100%; border-radius:50%; display:block; }
.wheel-needle { position:absolute; top:50%; right:-10px; transform:translateY(-50%); font-size:26px; filter:drop-shadow(0 2px 4px rgba(0,0,0,0.5)); pointer-events:none; z-index:10; }
.wheel-center { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width:36px; height:36px; border-radius:50%; background:var(--bg); border:3px solid var(--green); z-index:10; }
.wheel-spin-btn {
  background: color-mix(in srgb, var(--green) 14%, transparent);
  color: var(--green);
  border: 1.5px solid color-mix(in srgb, var(--green) 40%, transparent);
  border-radius: 50px; padding: 13px 34px;
  font-size: 14px; font-weight: 700; cursor: pointer;
  font-family: 'DM Sans', sans-serif;
  transition: background 0.15s, transform 0.12s, box-shadow 0.15s, border-color 0.15s;
  letter-spacing: 0.5px;
  box-shadow: 0 2px 12px color-mix(in srgb, var(--green) 20%, transparent);
}
.wheel-spin-btn:hover {
  background: color-mix(in srgb, var(--green) 22%, transparent);
  border-color: color-mix(in srgb, var(--green) 60%, transparent);
  transform: scale(1.05);
  box-shadow: 0 4px 20px color-mix(in srgb, var(--green) 30%, transparent);
}
.wheel-spin-btn:disabled { background:var(--s3); color:var(--muted); border-color:var(--border); cursor:not-allowed; transform:none; box-shadow:none; }
#wheelResult { background:var(--s1); border:1px solid var(--border); border-radius:10px; padding:14px 20px; text-align:center; width:100%; min-height:52px; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:5px; transition:border-color 0.3s, box-shadow 0.3s; }
#wheelResult.has-result { border-color:rgba(0,201,167,0.35); box-shadow:0 0 20px rgba(0,201,167,0.08); }
.result-icon { font-size:28px; line-height:1; }
.result-label { font-size:9px; font-weight:700; color:var(--green); text-transform:uppercase; letter-spacing:2.5px; }
.result-text { font-family:'DM Sans',sans-serif; font-size:16px; font-weight:600; color:var(--text); margin-top:2px; letter-spacing:-0.2px; }

/* ══════════════════════════════════════
   NOW LISTENING — Glow chanson dans la liste
══════════════════════════════════════ */

/* nlBox masqué (plus utilisé visuellement) */
#nlBox { display: none !important; }

/* ── Indicateur bandeau ── */
@keyframes nlIndPulse {
  0%,100% { opacity: 0.5; transform: scale(1); }
  50%     { opacity: 1;   transform: scale(1.3); }
}
#nlOtherIndicator.nl-ind-boy   { --ind-color: #5b9cf6; }
#nlOtherIndicator.nl-ind-girl  { --ind-color: #e879a0; }
#nlOtherIndicator.nl-ind-together { --ind-color: #f5c518; }
#nlOtherDot { background: var(--ind-color, #fff); box-shadow: 0 0 6px var(--ind-color, #fff); }
#nlOtherLabel { color: var(--ind-color, var(--sub)); }

/* ── Glow sur la ligne de chanson ── */
.sp-song.nl-other-playing {
  position: relative;
}
.sp-song.nl-other-playing::after {
  content: '';
  position: absolute; inset: 0;
  border-radius: inherit;
  pointer-events: none;
  transition: box-shadow 0.3s, background 0.3s;
}

/* Zelda voit Link en bleu */
.sp-song.nl-other-playing.nl-glow-boy::after {
  background: rgba(91,156,246,0.08);
  animation: nlPulseRowBoy 1.6s ease-in-out infinite;
}
@keyframes nlPulseRowBoy {
  0%,100% {
    box-shadow: inset 0 0 0 1.5px rgba(91,156,246,0.4);
  }
  50% {
    box-shadow: inset 0 0 0 2px rgba(91,156,246,0.9),
                0 0 16px rgba(91,156,246,0.35);
  }
}

/* Link voit Zelda en rose */
.sp-song.nl-other-playing.nl-glow-girl::after {
  background: rgba(232,121,160,0.08);
  animation: nlPulseRowGirl 1.6s ease-in-out infinite;
}
@keyframes nlPulseRowGirl {
  0%,100% {
    box-shadow: inset 0 0 0 1.5px rgba(232,121,160,0.4);
  }
  50% {
    box-shadow: inset 0 0 0 2px rgba(232,121,160,0.9),
                0 0 16px rgba(232,121,160,0.35);
  }
}

/* Mode doré — même chanson — brille fort */
.sp-song.nl-other-playing.nl-glow-together::after {
  background: rgba(245,197,24,0.10);
  animation: nlPulseRowGold 1.1s ease-in-out infinite;
}
@keyframes nlPulseRowGold {
  0%,100% {
    box-shadow: inset 0 0 0 1.5px rgba(245,197,24,0.45);
  }
  50% {
    box-shadow: inset 0 0 0 2px rgba(245,197,24,0.9),
                0 0 24px rgba(245,197,24,0.45);
  }
}

#lockPopup {
  position: fixed;
  bottom: 80px; right: 8px;
  background:var(--s2); border-radius:14px; display:none; z-index:1500;
  width:230px; border:1px solid var(--border);
  box-shadow: var(--shadow);
  animation: popIn2 0.2s cubic-bezier(.4,2,.55,.9);
  will-change: transform;
}
@keyframes popIn2 { from{transform:scale(0.9);opacity:0} to{transform:scale(1);opacity:1} }
#lockInput { flex:1; padding:9px 11px; font-size:13px; border:1px solid var(--border); border-radius:6px; background:var(--s3); color:var(--text); font-family:'DM Sans',sans-serif; outline:none; width:100%; transition:border-color 0.2s; }
#lockInput:focus { border-color:var(--green); }
#lockSubmit { padding:9px 13px; background:var(--green); color:#fff; border:none; border-radius:6px; font-size:12px; font-weight:700; cursor:pointer; font-family:'DM Sans',sans-serif; white-space:nowrap; transition:background 0.15s; flex-shrink:0; }
#lockSubmit:hover { background:var(--green2); }

#prankOverlay { position:fixed; inset:0; background:rgba(0,0,0,0.88); z-index:3500; display:none; flex-direction:column; align-items:center; justify-content:center; gap:16px; padding:24px; text-align:center; backdrop-filter:blur(6px); }
#prankOverlay.show { display:flex; animation: slideUp 0.3s ease; }
.prank-emoji { font-size:72px; animation:wobble 0.5s infinite alternate; will-change:transform; }
@keyframes wobble { 0%{transform:rotate(-10deg) scale(1)} 100%{transform:rotate(10deg) scale(1.1)} }
.prank-text { font-family:'Playfair Display',serif; font-size:clamp(18px,5vw,26px); color:#fff; line-height:1.4; }
.prank-hint { font-size:13px; color:rgba(255,255,255,0.55); line-height:1.5; }
.prank-close { margin-top:8px; padding:11px 26px; background:#3d9bd4; color:#fff; border:none; border-radius:50px; font-size:13px; font-weight:700; font-family:'DM Sans',sans-serif; cursor:pointer; transition:background 0.15s, transform 0.12s; }
.prank-close:hover { background:#ff85c2; transform:scale(1.04); }

/* ══ SYSTÈME BÊTISES INTERACTIVES ══ */
#prankMenu { position:fixed; inset:0; background:var(--pm-bg,#0d0d0d); z-index:4000; display:none; flex-direction:column; align-items:center; justify-content:flex-start; padding:0 24px 40px; padding-top:calc(var(--safe-top) + 0px); overflow-y:auto; overscroll-behavior:contain; -webkit-overflow-scrolling:touch; }
#prankMenu.show { display:flex; }
.prank-menu-title { font-family:'Playfair Display',serif; font-size:22px; color:var(--pm-text,#fff); margin-bottom:6px; text-align:center; }
.prank-menu-sub { font-size:12px; color:var(--pm-sub,rgba(255,255,255,0.5)); margin-bottom:20px; text-align:center; }
.prank-menu-list { display:flex; flex-direction:column; gap:10px; width:100%; max-width:340px; }
.prank-menu-item { display:flex; align-items:center; gap:12px; background:var(--pm-item-bg,rgba(255,255,255,0.07)); border:1px solid var(--pm-item-border,rgba(255,255,255,0.12)); border-radius:14px; padding:13px 16px; cursor:pointer; transition:background 0.15s, transform 0.12s; position:relative; }
.prank-fav-btn { margin-left:auto; flex-shrink:0; background:none; border:none; cursor:pointer; padding:6px 2px 6px 10px; line-height:1; display:flex; align-items:center; justify-content:center; -webkit-tap-highlight-color:transparent; }
.prank-fav-btn svg { width:22px; height:22px; transition:fill 0.2s, filter 0.2s, transform 0.15s; fill:var(--pm-fav-idle,rgba(255,255,255,0.15)); }
.prank-fav-btn:hover svg { fill:rgba(255,100,130,0.5); }
.prank-fav-btn.active svg { fill:#ff4d78; filter:drop-shadow(0 0 5px rgba(255,77,120,0.6)); }
.prank-fav-pop { animation: prankFavPop 0.3s cubic-bezier(.4,2,.55,.9); }
@keyframes prankFavPop { 0%{transform:scale(1)} 50%{transform:scale(1.55)} 100%{transform:scale(1)} }
.prank-fav-section-label { font-size:9px; font-weight:700; letter-spacing:2px; text-transform:uppercase; color:rgba(255,100,130,0.55); margin:4px 0 6px; width:100%; max-width:340px; text-align:left; padding-left:2px; }
.prank-fav-divider { width:100%; max-width:340px; height:1px; background:var(--pm-item-border,rgba(255,255,255,0.08)); margin:6px 0 10px; }
.prank-menu-item:hover { background:var(--pm-item-hover,rgba(255,255,255,0.13)); transform:translateX(3px); }
.prank-menu-item-icon { font-size:28px; flex-shrink:0; }
.prank-menu-item-name { font-size:14px; font-weight:600; color:var(--pm-text,#fff); }
.prank-menu-item-desc { font-size:11px; color:var(--pm-sub,rgba(255,255,255,0.5)); margin-top:2px; }
.prank-menu-cancel { margin-top:16px; font-size:12px; color:var(--pm-sub,rgba(255,255,255,0.4)); cursor:pointer; padding:8px 20px; transition:color 0.15s; }
.prank-menu-cancel:hover { color:var(--pm-text,rgba(255,255,255,0.8)); }

/* ── Thème clair prankMenu ── */
body.light #prankMenu {
  --pm-bg:          #fff5f8;
  --pm-text:        #1e0510;
  --pm-sub:         #9a4060;
  --pm-item-bg:     rgba(200,24,94,0.06);
  --pm-item-border: rgba(200,24,94,0.15);
  --pm-item-hover:  rgba(200,24,94,0.12);
  --pm-fav-idle:    rgba(200,24,94,0.2);
}
body.light #prankMenu .gv-back { color:var(--sub); background:var(--s2); border-color:var(--border); }
#prankMsgModal { position:fixed; inset:0; background:var(--bg); z-index:4001; display:none; flex-direction:column; align-items:center; justify-content:center; padding:24px; }
#prankMsgModal.show { display:flex; animation:slideUp 0.22s ease; }
.prank-msg-box { background:#1e1e2e; border:1px solid rgba(255,255,255,0.12); border-radius:20px; padding:24px 20px; width:100%; max-width:340px; display:flex; flex-direction:column; gap:14px; }
.prank-msg-title { font-family:'Playfair Display',serif; font-size:18px; color:#fff; text-align:center; }
.prank-msg-preview { font-size:36px; text-align:center; }
.prank-msg-input { background:rgba(255,255,255,0.07); border:1px solid rgba(255,255,255,0.15); border-radius:10px; padding:11px 14px; font-size:14px; color:#fff; font-family:'DM Sans',sans-serif; resize:none; outline:none; }
.prank-msg-input::placeholder { color:rgba(255,255,255,0.3); }
.prank-msg-send { background:linear-gradient(135deg,#e8507a,#c8185e); color:#fff; border:none; border-radius:50px; padding:12px; font-size:14px; font-weight:700; font-family:'DM Sans',sans-serif; cursor:pointer; transition:opacity 0.15s, transform 0.12s; }
.prank-msg-send:hover { opacity:0.9; transform:scale(1.02); }
.prank-msg-cancel { font-size:12px; color:rgba(255,255,255,0.4); cursor:pointer; text-align:center; padding:4px; }
.prank-msg-cancel:hover { color:rgba(255,255,255,0.8); }
#prankGotcha { position:fixed; inset:0; background:rgba(0,0,0,0.92); z-index:5000; display:none; flex-direction:column; align-items:center; justify-content:center; gap:16px; padding:28px; text-align:center; backdrop-filter:blur(10px); }
#prankGotcha.show { display:flex; animation:slideUp 0.3s ease; }
.gotcha-emoji { font-size:80px; animation:wobble 0.6s infinite alternate; will-change:transform; }
.gotcha-title { font-family:'Playfair Display',serif; font-size:clamp(20px,6vw,30px); color:#fff; line-height:1.3; }
.gotcha-msg { font-size:15px; color:rgba(255,255,255,0.75); line-height:1.6; max-width:300px; font-style:italic; }
.gotcha-close { margin-top:8px; padding:12px 30px; background:linear-gradient(135deg,#e8507a,#c8185e); color:#fff; border:none; border-radius:50px; font-size:14px; font-weight:700; font-family:'DM Sans',sans-serif; cursor:pointer; box-shadow:0 4px 20px rgba(200,24,94,0.4); }
.gotcha-close:hover { opacity:0.9; transform:scale(1.04); }
@keyframes prankShake { 0%,100%{transform:translateX(0)} 10%{transform:translateX(-8px) rotate(-1deg)} 20%{transform:translateX(8px) rotate(1deg)} 30%{transform:translateX(-6px)} 40%{transform:translateX(6px)} 50%{transform:translateX(-4px)} 60%{transform:translateX(4px)} }
body.prank-shake { animation:prankShake 0.4s ease infinite; }
#prankShakeBanner { position:fixed; top:0; left:0; right:0; z-index:4500; background:linear-gradient(135deg,#e8507a,#c8185e); padding:14px 16px; padding-top:calc(var(--safe-top) + 14px); text-align:center; display:none; box-shadow:0 4px 20px rgba(200,24,94,0.5); }
#prankShakeBanner.show { display:block; animation:slideDown 0.3s ease; }
@keyframes slideDown { from{transform:translateY(-100%)} to{transform:translateY(0)} }
.prank-shake-label { font-size:12px; font-weight:700; color:rgba(255,255,255,0.8); margin-bottom:4px; }
.prank-shake-count { font-size:32px; font-weight:900; color:#fff; }
#prankCurtain { position:fixed; inset:0; z-index:4500; pointer-events:none; display:none; }
#prankCurtain.show { display:block; }
#prankCurtainBanner { position:fixed; bottom:80px; left:50%; transform:translateX(-50%); z-index:4600; background:rgba(0,0,0,0.85); backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,0.15); border-radius:50px; padding:12px 24px; font-size:13px; font-weight:700; color:#fff; display:none; white-space:nowrap; }
#prankCurtainBanner.show { display:block; }
.prank-curtain-emoji { position:absolute; font-size:32px; cursor:pointer; user-select:none; pointer-events:all; transition:transform 0.12s; }
.prank-curtain-emoji:active { transform:scale(1.4); }
.prank-curtain-emoji.caught { animation:prankCaught 0.3s ease forwards; pointer-events:none; }
@keyframes prankCaught { 0%{opacity:1;transform:scale(1)} 60%{transform:scale(1.6);opacity:0.4} 100%{transform:scale(0);opacity:0} }
#prankIntrus { position:fixed; z-index:4700; font-size:48px; cursor:pointer; user-select:none; display:none; filter:drop-shadow(0 4px 12px rgba(0,0,0,0.5)); pointer-events:all; transition: left 0.25s cubic-bezier(.4,2,.55,.9), top 0.25s cubic-bezier(.4,2,.55,.9); }
#prankIntrus.show { display:block; }
#prankIntrusBanner { position:fixed; bottom:80px; left:50%; transform:translateX(-50%); z-index:4600; background:rgba(0,0,0,0.85); backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,0.15); border-radius:50px; padding:12px 24px; font-size:13px; font-weight:700; color:#fff; display:none; white-space:nowrap; }
#prankIntrusBanner.show { display:block; }
body.prank-flip { overflow-x:hidden; }
/* Tout le contenu se retourne à 180° sauf le bandeau de contrôle et les overlays */
body.prank-flip > *:not(#prankFlipBanner):not(#prankGotcha):not(#prankLock):not(#prankOverlay) {
  transform: rotate(180deg) !important;
  transform-origin: center center;
  transition: transform 0.5s cubic-bezier(.4,0,.2,1);
}
body:not(.prank-flip) > *:not(#prankFlipBanner):not(#prankGotcha):not(#prankLock):not(#prankOverlay) {
  transition: transform 0.5s cubic-bezier(.4,0,.2,1);
}
#prankFlipBanner { position:fixed; top:0; left:0; right:0; z-index:4500; background:linear-gradient(135deg,#7c3aed,#4f46e5); padding:14px 16px 16px; padding-top:calc(var(--safe-top) + 14px); display:none; text-align:center; box-shadow:0 4px 20px rgba(124,58,237,0.5); user-select:none; -webkit-user-select:none; touch-action:none; }
#prankFlipBanner.show { display:block; animation:slideDown 0.3s ease; }
.prank-flip-label { font-size:11px; font-weight:700; color:rgba(255,255,255,0.8); margin-bottom:10px; pointer-events:none; }
#prankFlipHoldWrap { display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px; }
#prankFlipProgress { width:120px; height:8px; background:rgba(255,255,255,0.25); border-radius:4px; overflow:hidden; pointer-events:none; }
#prankFlipProgressBar { height:100%; width:0%; background:#fff; border-radius:4px; transition:width 0.08s linear; }
#prankFlipBtn { font-size:36px; cursor:pointer; user-select:none; -webkit-user-select:none; touch-action:none; line-height:1; padding:8px; }
#prankSplash { position:fixed; inset:0; z-index:4500; pointer-events:none; display:none; overflow:hidden; }
#prankSplash.show { display:block; }
#prankSplashBanner { position:fixed; bottom:80px; left:50%; transform:translateX(-50%); z-index:4600; background:rgba(0,0,0,0.85); backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,0.15); border-radius:50px; padding:12px 24px; font-size:13px; font-weight:700; color:#fff; display:none; white-space:nowrap; }
#prankSplashBanner.show { display:block; }
.prank-splash-blob { position:fixed; border-radius:42% 58% 60% 40% / 50% 45% 55% 50%; cursor:pointer; pointer-events:all; transition:transform 0.15s; }
.prank-splash-blob.wiped { animation:prankWipe 0.4s ease forwards; pointer-events:none; }
@keyframes prankWipe { 0%{opacity:0.88} 100%{opacity:0;transform:scale(0.2)} }
#prankLock { position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:4500; display:none; flex-direction:column; align-items:center; justify-content:center; gap:14px; padding:28px; text-align:center; backdrop-filter:blur(10px); }
#prankLock.show { display:flex; animation:slideUp 0.3s ease; }
.prank-lock-icon { font-size:72px; animation:wobble 0.7s infinite alternate; will-change:transform; }
.prank-lock-title { font-family:'Playfair Display',serif; font-size:22px; color:#fff; }
.prank-lock-sub { font-size:13px; color:rgba(255,255,255,0.55); max-width:280px; }
.prank-lock-input { background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.2); border-radius:12px; padding:12px 18px; font-size:18px; color:#fff; font-family:'DM Sans',sans-serif; text-align:center; letter-spacing:3px; outline:none; width:100%; max-width:240px; }
.prank-lock-input.error { border-color:#e05555; animation:prankShake 0.4s ease; }
.prank-lock-btn { background:linear-gradient(135deg,#e8507a,#c8185e); color:#fff; border:none; border-radius:50px; padding:12px 32px; font-size:14px; font-weight:700; font-family:'DM Sans',sans-serif; cursor:pointer; }
.prank-lock-err { font-size:12px; color:#e05555; min-height:16px; }

/* ══ NOUVELLES BÊTISES CSS ══ */

/* 🌫️ BROUILLARD */
#prankFogOverlay { position:fixed; inset:0; z-index:4500; pointer-events:none; display:none; backdrop-filter:blur(20px); -webkit-backdrop-filter:blur(20px); transition:backdrop-filter 0.4s ease, -webkit-backdrop-filter 0.4s ease; }
#prankFogOverlay.show { display:block; }
#prankFogBanner { position:fixed; bottom:120px; left:50%; transform:translateX(-50%); z-index:4600; background:rgba(0,0,0,0.85); backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,0.15); border-radius:50px; padding:12px 24px; font-size:13px; font-weight:700; color:#fff; display:none; white-space:nowrap; pointer-events:all; }
#prankFogBanner.show { display:block; }

/* 🌈 COULEURS FOLLES */
#prankColorsBanner { position:fixed; bottom:100px; left:50%; transform:translateX(-50%); z-index:4600; background:rgba(0,0,0,0.88); backdrop-filter:blur(10px); border:1px solid rgba(255,255,255,0.15); border-radius:20px; padding:14px 20px 16px; font-size:13px; font-weight:700; color:#fff; display:none; white-space:nowrap; pointer-events:all; text-align:center; user-select:none; -webkit-user-select:none; touch-action:none; }
#prankColorsBanner.show { display:block; }
#prankColorsHoldBtn { font-size:40px; cursor:pointer; user-select:none; -webkit-user-select:none; touch-action:none; padding:8px 16px; display:inline-block; line-height:1; }
#prankColorsProgress { width:120px; height:8px; background:rgba(255,255,255,0.2); border-radius:4px; overflow:hidden; margin:0 auto 10px; }
#prankColorsProgressBar { height:100%; width:0%; background:linear-gradient(90deg,#f472b6,#a78bfa,#60a5fa); border-radius:4px; transition:width 0.08s linear; }
.prank-colors-label { font-size:11px; font-weight:700; color:rgba(255,255,255,0.8); margin-bottom:8px; pointer-events:none; }

/* ⌨️ FAUX CLAVIER */
#prankKeyboard { position:fixed; inset:0; background:rgba(0,0,0,0.92); z-index:4500; display:none; flex-direction:column; align-items:center; justify-content:center; gap:16px; padding:20px; backdrop-filter:blur(10px); }
#prankKeyboard.show { display:flex; animation:slideUp 0.3s ease; }
.pkb-word-display { font-size:28px; font-weight:900; color:#fff; letter-spacing:8px; text-align:center; font-family:'DM Sans',sans-serif; }
.pkb-word-blur { filter:blur(2.5px); display:inline-block; transition:filter 0.15s; }
.pkb-typed { font-size:18px; letter-spacing:5px; color:#a78bfa; min-height:28px; font-weight:700; }
.pkb-hint { font-size:11px; color:rgba(255,255,255,0.4); }
.pkb-err { font-size:12px; color:#e05555; min-height:16px; }
.pkb-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:6px; width:100%; max-width:340px; }
.pkb-key { background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); border-radius:8px; padding:11px 4px; font-size:15px; font-weight:700; color:#fff; text-align:center; cursor:pointer; user-select:none; -webkit-user-select:none; transition:background 0.1s, transform 0.1s; touch-action:manipulation; }
.pkb-key:active { background:rgba(167,139,250,0.4); transform:scale(0.93); }
.pkb-key.backspace { grid-column:span 2; font-size:13px; background:rgba(255,80,80,0.15); }
.pkb-key.backspace:active { background:rgba(255,80,80,0.35); }
.pkb-key.hint { background:rgba(167,139,250,0.5); border-color:#a78bfa; position:relative; }
.pkb-key.hint::after { content:''; position:absolute; inset:0; border-radius:8px; box-shadow:0 0 0 4px rgba(167,139,250,0.35); animation:kbHintBlink 0.6s ease-in-out infinite; pointer-events:none; }
@keyframes kbHintBlink { 0%,100%{opacity:0} 50%{opacity:1} }

/* 🎯 CIBLE */
#prankTarget { position:fixed; z-index:4700; display:none; cursor:pointer; user-select:none; -webkit-user-select:none; pointer-events:all; }
#prankTarget.show { display:block; }
.pt-circle { width:64px; height:64px; border-radius:50%; background:radial-gradient(circle, #ef4444 30%, #fff 31%, #fff 45%, #ef4444 46%, #ef4444 60%, #fff 61%, #fff 74%, #b91c1c 75%); box-shadow:0 4px 20px rgba(239,68,68,0.5); transition:left 0.18s cubic-bezier(.4,2,.55,.9), top 0.18s cubic-bezier(.4,2,.55,.9); }
#prankTargetBanner { position:fixed; bottom:120px; left:50%; transform:translateX(-50%); z-index:4600; background:rgba(0,0,0,0.85); backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,0.15); border-radius:50px; padding:12px 24px; font-size:13px; font-weight:700; color:#fff; display:none; white-space:nowrap; }
#prankTargetBanner.show { display:block; }

/* 🃏 MEMORY EXPRESS */
#prankMemoryOverlay { position:fixed; inset:0; background:rgba(0,0,0,0.92); z-index:4500; display:none; flex-direction:column; align-items:center; justify-content:center; gap:16px; padding:24px; backdrop-filter:blur(10px); }
#prankMemoryOverlay.show { display:flex; animation:slideUp 0.3s ease; }
.pmem-title { font-family:'Playfair Display',serif; font-size:20px; color:#fff; text-align:center; }
.pmem-sub { font-size:12px; color:rgba(255,255,255,0.5); text-align:center; }
.pmem-grid { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; width:100%; max-width:300px; }
.pmem-card { height:70px; border-radius:12px; cursor:pointer; user-select:none; -webkit-user-select:none; position:relative; transform-style:preserve-3d; transition:transform 0.35s ease; touch-action:manipulation; }
.pmem-card.flipped { transform:rotateY(180deg); }
.pmem-card.matched { transform:rotateY(180deg); opacity:0.5; pointer-events:none; }
.pmem-face { position:absolute; inset:0; border-radius:12px; backface-visibility:hidden; -webkit-backface-visibility:hidden; display:flex; align-items:center; justify-content:center; }
.pmem-back { background:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.2); font-size:24px; }
.pmem-front { background:rgba(167,139,250,0.25); border:1px solid rgba(167,139,250,0.5); font-size:28px; transform:rotateY(180deg); }
.pmem-status { font-size:13px; color:rgba(255,255,255,0.6); }

/* 👁️ YEUX */
#prankEyesOverlay { position:fixed; inset:0; background:rgba(0,0,0,0.0); z-index:4500; display:none; pointer-events:none; }
#prankEyesOverlay.show { display:block; }
.prank-eye-pair { position:absolute; display:flex; gap:10px; pointer-events:all; cursor:default; user-select:none; }
.prank-eye { width:52px; height:52px; border-radius:50%; background:#fff; border:3px solid #222; display:flex; align-items:center; justify-content:center; position:relative; overflow:hidden; }
.prank-eye-lid { position:absolute; top:0; left:0; right:0; height:0; background:#1a1a2e; border-radius:0 0 50% 50%; z-index:3; transition:height 0.08s ease; }
.prank-eye.blink .prank-eye-lid { height:100%; }
.prank-eye-pupil { width:20px; height:20px; border-radius:50%; background:#111; position:absolute; transition:transform 0.1s ease; z-index:2; }
.prank-eye-timer { position:absolute; bottom:-22px; left:50%; transform:translateX(-50%); white-space:nowrap; font-size:10px; font-weight:700; color:#fff; background:rgba(0,0,0,0.6); border-radius:20px; padding:2px 8px; }
.prank-eye-ring { position:absolute; inset:-4px; border-radius:50%; border:3px solid transparent; z-index:1; }
.prank-eye-ring.active { border-color:#a78bfa; animation:eyeRingPulse 1s linear infinite; }
@keyframes eyeRingPulse { 0%{opacity:0.4} 50%{opacity:1} 100%{opacity:0.4} }
#prankEyesBanner { position:fixed; bottom:120px; left:50%; transform:translateX(-50%); z-index:4600; background:rgba(0,0,0,0.85); backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,0.15); border-radius:50px; padding:12px 24px; font-size:13px; font-weight:700; color:#fff; display:none; white-space:nowrap; }
#prankEyesBanner.show { display:block; }
#prankEyesMessage { position:fixed; inset:0; z-index:4800; background:rgba(0,0,0,0.9); display:none; flex-direction:column; align-items:center; justify-content:center; gap:16px; }
#prankEyesMessage.show { display:flex; animation:slideUp 0.3s ease; }
.prank-eyes-msg-emoji { font-size:72px; animation:wobble 0.6s infinite alternate; will-change:transform; }
.prank-eyes-msg-text { font-family:'Playfair Display',serif; font-size:22px; color:#fff; text-align:center; padding:0 24px; line-height:1.4; }

/* 📱 FAUSSE NOTIF */
#prankNotifOverlay { position:fixed; inset:0; z-index:4999; background:rgba(0,0,0,0); pointer-events:none; transition:background 0.35s ease; touch-action:none; }
#prankNotifOverlay.active { background:rgba(0,0,0,0.78); pointer-events:all; }
#prankNotif { position:fixed; top:-160px; left:12px; right:12px; z-index:5000; background:rgba(22,22,30,0.98); border:1.5px solid rgba(167,139,250,0.55); border-radius:20px; padding:15px 16px; display:flex; align-items:flex-start; gap:12px; backdrop-filter:blur(30px); -webkit-backdrop-filter:blur(30px); box-shadow:0 12px 50px rgba(0,0,0,0.8),0 0 0 1px rgba(167,139,250,0.12); transition:top 0.5s cubic-bezier(.34,1.56,.64,1); max-width:420px; margin:0 auto; cursor:pointer; user-select:none; -webkit-user-select:none; }
#prankNotif.show { top:14px; }
#prankNotif.show::after { content:''; position:absolute; inset:-2px; border-radius:22px; box-shadow:0 0 0 2px rgba(167,139,250,0.85); animation:prankNotifGlow 2s ease-in-out 0.5s infinite; pointer-events:none; }
@keyframes prankNotifGlow { 0%,100%{opacity:0.3} 50%{opacity:1} }
.pn-avatar { width:46px; height:46px; border-radius:13px; background:linear-gradient(135deg,#a78bfa,#60a5fa); display:flex; align-items:center; justify-content:center; font-size:23px; flex-shrink:0; box-shadow:0 3px 12px rgba(167,139,250,0.4); }
.pn-content { flex:1; min-width:0; }
.pn-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:3px; }
.pn-app { font-size:11px; font-weight:700; color:rgba(167,139,250,0.9); text-transform:uppercase; letter-spacing:0.6px; }
.pn-time { font-size:11px; color:rgba(255,255,255,0.35); }
.pn-title { font-size:15px; font-weight:700; color:#fff; margin-bottom:3px; line-height:1.3; }
.pn-body { font-size:13px; color:rgba(255,255,255,0.82); line-height:1.4; }

/* #hiddenPage — défini dans le bloc InstaLove ci-dessous */
.hp-header { padding: 28px 16px 20px; padding-top: calc(var(--safe-top) + 28px); border-bottom: 1px solid rgba(255,255,255,0.08); position: relative; overflow: hidden; }
.hp-back { display:inline-flex; align-items:center; gap:7px; font-size:11px; font-weight:600; color:var(--sub); background:var(--s2); border:1px solid var(--border); border-radius:20px; padding:7px 14px; cursor:pointer; margin-bottom:10px; transition:background 0.15s, color 0.15s, transform 0.12s; }
.hp-back:hover { background:var(--s3); color:var(--text); transform:translateX(-2px); }
.hp-title { font-family:'Playfair Display',serif; font-size:clamp(24px,8vw,42px); font-weight:700; color:#fff; line-height:1.1; }
.hp-sub { margin-top:5px; font-size:13px; color:rgba(255,255,255,0.45); }

.memory-section { padding: 22px 16px 0; }
.memory-section .section-label { color: var(--muted); }
.memory-section .section-label::after { background: var(--border); }
.memory-start-screen { background: rgba(61,155,212,0.07); border: 1px solid rgba(61,155,212,0.20); border-radius: 14px; padding: 32px 20px; text-align: center; display: flex; flex-direction: column; align-items: center; gap: 14px; }
.memory-start-icon { font-size: 52px; line-height: 1; }
.memory-start-title { font-family: 'Playfair Display', serif; font-size: 20px; font-weight: 700; color: var(--text); }
.memory-start-sub { font-size: 13px; color: var(--sub); line-height: 1.5; max-width: 260px; }
.memory-start-btn { padding: 12px 30px; background: rgba(61,155,212,0.20); color: #3d9bd4; border: 1.5px solid rgba(61,155,212,0.45); border-radius: 50px; font-size: 14px; font-weight: 700; font-family: 'DM Sans', sans-serif; cursor: pointer; transition: background 0.15s, transform 0.12s; margin-top: 4px; }
.memory-start-btn:hover { background: rgba(61,155,212,0.32); transform: scale(1.05); }
.memory-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 8px; }
.memory-stats { display: flex; gap: 12px; }
.memory-stat { background: var(--s2); border: 1px solid var(--border); border-radius: 8px; padding: 8px 12px; text-align: center; min-width: 60px; }
.memory-stat-num { font-size: 18px; font-weight: 700; color: #3d9bd4; display: block; line-height: 1; }
.memory-stat-lbl { font-size: 9px; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-top: 2px; display: block; }
.memory-restart-btn { padding: 8px 16px; background: rgba(61,155,212,0.15); color: #3d9bd4; border: 1px solid rgba(61,155,212,0.30); border-radius: 8px; font-size: 12px; font-weight: 600; font-family: 'DM Sans', sans-serif; cursor: pointer; transition: background 0.15s, transform 0.12s; }
.memory-restart-btn:hover { background: rgba(61,155,212,0.25); transform: scale(1.04); }
.memory-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; max-width: 360px; margin: 0 auto; }
.mem-card { aspect-ratio: 1; border-radius: 10px; cursor: pointer; position: relative; perspective: 600px; transition: transform 0.1s; }
.mem-card:hover:not(.flipped):not(.matched) { transform: scale(1.04); }
.mem-card-inner { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 0.4s cubic-bezier(.4,0,.2,1); border-radius: 10px; }
.mem-card.flipped .mem-card-inner { transform: rotateY(180deg); }
.mem-card.matched .mem-card-inner { transform: rotateY(180deg); }
.mem-card-front, .mem-card-back { position: absolute; inset: 0; border-radius: 10px; display: flex; align-items: center; justify-content: center; backface-visibility: hidden; -webkit-backface-visibility: hidden; }
.mem-card-front { background: var(--s2); border: 1px solid var(--border); font-size: 22px; }
.mem-card-front::before { content: '💜'; font-size: 20px; opacity: 0.35; }
.mem-card-back { background: rgba(61,155,212,0.15); border: 1px solid rgba(61,155,212,0.30); font-size: 26px; transform: rotateY(180deg); }
.mem-card.matched .mem-card-back { background: rgba(61,155,212,0.25); border-color: rgba(61,155,212,0.6); box-shadow: 0 0 18px rgba(61,155,212,0.25); animation: matchPop 0.35s cubic-bezier(.4,2,.55,.9); }
@keyframes matchPop { 0%{transform:rotateY(180deg) scale(0.85)} 60%{transform:rotateY(180deg) scale(1.12)} 100%{transform:rotateY(180deg) scale(1)} }
.mem-card.wrong .mem-card-inner { animation: wrongShake 0.35s ease; }
@keyframes wrongShake { 0%,100%{transform:rotateY(180deg) translateX(0)} 25%{transform:rotateY(180deg) translateX(-5px)} 75%{transform:rotateY(180deg) translateX(5px)} }
.memory-win { margin: 20px 0 0; background: rgba(255,105,180,0.1); border: 1px solid rgba(61,155,212,0.30); border-radius: 12px; padding: 24px 16px; text-align: center; display: none; animation: slideUp 0.4s ease; }
.memory-win.show { display: block; }
.memory-win-emoji { font-size: 48px; display: block; margin-bottom: 10px; }
.memory-win-title { font-family: 'Playfair Display', serif; font-size: 20px; font-weight: 700; color: var(--text); margin-bottom: 6px; }
.memory-win-sub { font-size: 13px; color: var(--sub); line-height: 1.5; }
.memory-win-replay { margin-top: 16px; padding: 11px 24px; background: rgba(61,155,212,0.20); color: #3d9bd4; border: 1px solid rgba(61,155,212,0.35); border-radius: 8px; font-size: 13px; font-weight: 600; font-family: 'DM Sans', sans-serif; cursor: pointer; transition: background 0.15s; }
.memory-win-replay:hover { background: rgba(61,155,212,0.30); }

/* ── GENDER SELECT ── */
.gender-select-screen { background: var(--s1); border: 1px solid var(--border); border-radius: 14px; padding: 16px 14px; text-align: center; display: flex; flex-direction: column; align-items: center; gap: 10px; }
.gender-select-title { font-family: 'Playfair Display', serif; font-size: 15px; font-weight: 700; color: var(--text); }
.gender-select-sub { font-size: 12px; color: var(--sub); }
.gender-select-btns { display: flex; gap: 8px; width: 100%; max-width: 220px; }
.gender-select-btn {
  flex: 1; padding: 12px 10px; border-radius: 10px;
  border: 1.5px solid var(--border); background: var(--s2);
  color: var(--sub); font-size: 13px; font-weight: 700;
  font-family: 'DM Sans', sans-serif; cursor: pointer;
  display: flex; align-items: center; justify-content: center; gap: 8px;
  transition: border-color 0.15s, background 0.15s, color 0.15s, transform 0.1s;
  user-select: none;
  position: relative;
}
.gender-select-btn:hover { background: var(--s3); color: var(--text); }
.gender-select-btn.girl {
  border-color: #e879a0; background: rgba(232,121,160,0.10); color: #e879a0;
}
.gender-select-btn.boy {
  border-color: #5b9cf6; background: rgba(91,156,246,0.10); color: #5b9cf6;
}
.gender-select-icon {
  width: 10px; height: 10px; border-radius: 50%;
  flex-shrink: 0; display: block;
}
.gender-select-btn .girl-dot { background: #e879a0; box-shadow: 0 0 6px rgba(232,121,160,0.60); }
.gender-select-btn .boy-dot  { background: #5b9cf6; box-shadow: 0 0 6px rgba(91,156,246,0.5); }
.gender-select-btn.profile-hint-girl {
  border-color: #e879a0;
  background: rgba(232,121,160,0.10);
  color: #e879a0;
  animation: auraGirl 1.8s ease-in-out infinite;
}
.gender-select-btn.profile-hint-boy {
  border-color: #5b9cf6;
  background: rgba(91,156,246,0.10);
  color: #5b9cf6;
  animation: auraBoy 1.8s ease-in-out infinite;
}
/* aura : on anime l'opacity d'un ring fixe — compositable GPU */
.gender-select-btn.profile-hint-girl::after,
.gender-select-btn.profile-hint-boy::after {
  content: '';
  position: absolute; inset: -2px;
  border-radius: inherit;
  pointer-events: none;
}
.gender-select-btn.profile-hint-girl::after {
  box-shadow: 0 0 0 2px rgba(232,121,160,0.9);
  animation: auraGirl 1.8s ease-in-out infinite;
}
.gender-select-btn.profile-hint-boy::after {
  box-shadow: 0 0 0 2px rgba(91,156,246,0.9);
  animation: auraBoy 1.8s ease-in-out infinite;
}
@keyframes auraGirl {
  0%,100% { opacity: 0.2; }
  50%     { opacity: 1; }
}
@keyframes auraBoy {
  0%,100% { opacity: 0.2; }
  50%     { opacity: 1; }
}

/* ── LEADERBOARD ── */
.leaderboard-wrap { margin-top: 20px; }
.leaderboard-title { font-size: 10px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 2px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
.leaderboard-title::after { content: ''; flex: 1; height: 1px; background: var(--border); }
.leaderboard-tabs { display: flex; gap: 6px; margin-bottom: 10px; }
.lb-tab { flex: 1; padding: 6px 10px; border-radius: 20px; background: var(--s2); color: var(--sub); font-size: 11px; font-weight: 600; cursor: pointer; border: 1px solid var(--border); text-align: center; transition: background 0.15s, color 0.15s; user-select: none; }
.lb-tab.active-girl { background: rgba(232,121,160,0.15); color: #e879a0; border-color: rgba(232,121,160,0.40); }
.lb-tab.active-boy  { background: rgba(91,156,246,0.15);  color: #5b9cf6;  border-color: rgba(91,156,246,0.4); }
.lb-tab.active-all  { background: rgba(0,201,167,0.12);   color: var(--green); border-color: rgba(0,201,167,0.35); }
.lb-row { display: flex; align-items: center; gap: 10px; padding: 7px 10px; border-radius: 8px; transition: background 0.12s; }
.lb-row:hover { background: var(--s2); }
.lb-rank { width: 22px; font-size: 12px; font-weight: 700; color: var(--muted); text-align: center; flex-shrink: 0; }
.lb-rank.gold   { color: #f5c518; font-size: 15px; }
.lb-rank.silver { color: #aaa; font-size: 14px; }
.lb-rank.bronze { color: #cd7f32; font-size: 13px; }
.lb-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.lb-dot.girl { background: #e879a0; }
.lb-dot.boy  { background: #5b9cf6; }
.lb-name { font-size: 12px; font-weight: 600; color: var(--text); flex: 1; }
.lb-score { font-size: 11px; color: var(--sub); font-variant-numeric: tabular-nums; }
.lb-score span { color: var(--text); font-weight: 700; }
.lb-empty { font-size: 12px; color: var(--muted); text-align: center; padding: 14px 0; font-style: italic; }
.lb-loading { font-size: 11px; color: var(--muted); text-align: center; padding: 10px 0; }

#memoCoupleSection { padding: 26px 16px 0; }
.memo-lock-badge { display: inline-flex; align-items: center; gap: 5px; font-size: 9px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 2px; background: var(--s2); border: 1px solid var(--border); border-radius: 20px; padding: 5px 12px; cursor: pointer; transition: color 0.15s, border-color 0.15s, transform 0.12px; user-select: none; }
.memo-lock-badge:hover { color: var(--text); border-color: var(--green); transform: scale(1.03); }
.memo-lock-badge.unlocked { color: var(--green); border-color: rgba(0,201,167,0.35); }
.memo-header-row { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; }
.memo-notes-slider { display:flex; gap:14px; overflow-x:auto; scroll-snap-type:x mandatory; padding-bottom:6px; }
.memo-notes-slider::-webkit-scrollbar { display:none; }
.memo-note-card { min-width:130px; flex:0 0 auto; scroll-snap-align:start; cursor:pointer; position:relative; }
.memo-note-img { width:130px; height:130px; border-radius:8px; background:var(--s2); border:1px solid var(--border); display:flex; flex-direction:column; justify-content:flex-end; overflow:hidden; transition:transform 0.3s, box-shadow 0.3s; position:relative; }
.memo-note-card:hover .memo-note-img { transform:scale(1.03); box-shadow:var(--shadow); }
.memo-note-bg { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:42px; opacity:0.13; }
.memo-note-banner { position:absolute; bottom:0; left:0; width:100%; padding:6px 8px; font-size:11px; font-weight:600; color:#fff; text-align:center; background:rgba(0,0,0,0.78); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.memo-note-preview { margin-top:7px; font-size:11px; color:var(--sub); max-width:130px; line-height:1.35; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
.memo-note-add-card { min-width:130px; flex:0 0 auto; scroll-snap-align:start; cursor:pointer; display:none; }
.memo-note-add-card.visible { display:block; }
.memo-note-add-img { width:130px; height:130px; border-radius:8px; border:2px dashed rgba(0,201,167,0.35); display:flex; flex-direction:column; align-items:center; justify-content:center; gap:6px; color:var(--green); transition:background 0.15s, border-color 0.15s; }
.memo-note-add-card:hover .memo-note-add-img { background:rgba(0,201,167,0.06); border-color:var(--green); }
.memo-note-add-icon { font-size:28px; line-height:1; }
.memo-note-add-lbl { font-size:10px; font-weight:600; letter-spacing:0.5px; }
.memo-notes-empty { font-size:12px; color:var(--muted); font-style:italic; padding:8px 0 4px; }
.memo-todo-card { background:var(--s1); border:1px solid var(--border); border-radius:8px; padding:8px 12px; position:relative; overflow:hidden; }
.memo-todo-card::before { content:''; position:absolute; left:0; top:0; bottom:0; width:2px; background:#3d9bd4; border-radius:2px 0 0 2px; opacity:0.4; }
.todo-item { display:flex; align-items:center; gap:8px; padding:5px 0; border-bottom:1px solid var(--border); }
.todo-item:last-child { border-bottom:none; }
.todo-check { width:15px; height:15px; border-radius:50%; border:1.5px solid var(--muted); flex-shrink:0; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:border-color 0.15s, background 0.15s; font-size:8px; }
.todo-check.done { background:var(--green); border-color:var(--green); color:#000; }
.todo-text { flex:1; font-size:12px; color:var(--text); line-height:1.3; transition:color 0.15s; }
.todo-text.done { color:var(--muted); text-decoration:line-through; }
.todo-del { font-size:11px; color:var(--muted); cursor:pointer; padding:2px 4px; border-radius:4px; opacity:0; transition:opacity 0.15s, color 0.15s; }
.todo-item:hover .todo-del { opacity:1; }
.todo-del:hover { color:#e05555; }
.todo-empty { font-size:11px; color:var(--muted); text-align:center; padding:10px 0; font-style:italic; }
.todo-add-row { display:flex; gap:6px; margin-top:8px; }
.todo-add-input { flex:1; padding:6px 10px; font-size:12px; border:1px solid var(--border); border-radius:6px; background:var(--s3); color:var(--text); font-family:'DM Sans',sans-serif; outline:none; transition:border-color 0.2s; }
.todo-add-input:focus { border-color:var(--green); }
.todo-add-btn { padding:6px 11px; background:var(--green); color:#000; border:none; border-radius:6px; font-size:12px; font-weight:700; cursor:pointer; font-family:'DM Sans',sans-serif; transition:background 0.15s; }
.todo-add-btn:hover { background:var(--green2); }

#memoModal { position:fixed; inset:0; background:rgba(0,0,0,0.75); z-index:2500; display:none; align-items:center; justify-content:center; padding:24px 16px; backdrop-filter:blur(4px); }
#memoModal.open { display:flex; }
.memo-modal-inner { background:var(--s1); border:1px solid var(--border); border-radius:16px; padding:22px 20px; width:100%; max-width:420px; max-height:82vh; overflow-y:auto; position:relative; box-shadow:var(--shadow); }
.memo-modal-close { position:absolute; top:14px; right:14px; font-size:18px; color:var(--muted); cursor:pointer; transition:color 0.15s; }
.memo-modal-close:hover { color:var(--text); }
.memo-modal-label { font-size:9px; font-weight:700; color:var(--green); text-transform:uppercase; letter-spacing:2.5px; margin-bottom:8px; }
.memo-modal-content { font-size:15px; color:var(--text); line-height:1.6; font-weight:500; white-space:pre-wrap; margin-bottom:10px; }
.memo-modal-date { font-size:11px; color:var(--muted); margin-top:8px; }
.memo-modal-title-input { width:100%; padding:10px 13px; font-size:14px; font-weight:600; border:1px solid var(--border); border-radius:8px; background:var(--s2); color:var(--text); font-family:'DM Sans',sans-serif; outline:none; transition:border-color 0.2s; margin-bottom:8px; }
.memo-modal-title-input:focus { border-color:var(--green); }
.memo-modal-textarea { width:100%; min-height:130px; padding:11px 13px; font-size:14px; line-height:1.6; background:var(--s2); border:1px solid var(--border); border-radius:8px; color:var(--text); font-family:'DM Sans',sans-serif; outline:none; resize:vertical; transition:border-color 0.2s; }
.memo-modal-textarea:focus { border-color:var(--green); }
.memo-modal-save { width:100%; padding:12px; margin-top:10px; background:var(--green); color:#000; font-weight:700; font-size:14px; font-family:'DM Sans',sans-serif; border:none; border-radius:8px; cursor:pointer; }
.memo-modal-save:hover { background:var(--green2); }
.memo-modal-del { width:100%; padding:10px; margin-top:6px; background:transparent; color:#e05555; font-weight:600; font-size:13px; font-family:'DM Sans',sans-serif; border:1px solid rgba(220,50,50,0.25); border-radius:8px; cursor:pointer; }
.memo-modal-del:hover { background:rgba(220,50,50,0.07); }

#memoAuthModal { position:fixed; inset:0; background:rgba(0,0,0,0.75); z-index:2600; display:none; align-items:center; justify-content:center; padding:24px 16px; backdrop-filter:blur(4px); }
#memoAuthModal.open { display:flex; }
.memo-auth-inner { background:var(--s1); border:1px solid var(--border); border-radius:16px; padding:26px 20px; width:100%; max-width:340px; text-align:center; box-shadow:var(--shadow); }
.memo-auth-icon { font-size:38px; margin-bottom:10px; }
.memo-auth-title { font-family:'Playfair Display',serif; font-size:20px; font-weight:700; color:var(--text); margin-bottom:4px; }
.memo-auth-sub { font-size:12px; color:var(--muted); margin-bottom:18px; }
.memo-auth-input { width:100%; padding:11px 14px; font-size:15px; border:1px solid var(--border); border-radius:8px; background:var(--s2); color:var(--text); font-family:'DM Sans',sans-serif; outline:none; text-align:center; letter-spacing:3px; transition:border-color 0.2s; }
.memo-auth-input:focus { border-color:var(--green); }
.memo-auth-btn { width:100%; padding:12px; margin-top:10px; background:var(--green); color:#000; font-weight:700; font-size:14px; font-family:'DM Sans',sans-serif; border:none; border-radius:8px; cursor:pointer; }
.memo-auth-btn:hover { background:var(--green2); }
.memo-auth-err { font-size:11px; color:#e05555; margin-top:8px; display:none; }
.memo-auth-cancel { font-size:11px; color:var(--muted); cursor:pointer; margin-top:10px; display:block; }
.memo-auth-cancel:hover { color:var(--text); }
.memo-sub-label { font-size:9px; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:2px; margin:0 0 10px; }
.memo-loading { font-size:11px; color:var(--muted); font-style:italic; padding:8px 0; }

@keyframes spin { to{transform:rotate(360deg)} }
.spinner { display:inline-block; width:14px; height:14px; border:2px solid var(--border); border-top-color:var(--green); border-radius:50%; animation:spin 0.7s linear infinite; vertical-align:middle; margin-right:5px; }
.memo-note-date-badge { position:absolute; top:7px; right:7px; background:rgba(0,0,0,0.45); backdrop-filter:blur(4px); border-radius:5px; padding:2px 6px; font-size:9px; font-weight:600; color:rgba(255,255,255,0.85); z-index:2; pointer-events:none; }
.memo-note-new-badge {
  position: absolute; top: 7px; left: 7px;
  background: var(--green);
  color: #000;
  font-size: 8px; font-weight: 800;
  letter-spacing: 1px; text-transform: uppercase;
  border-radius: 5px; padding: 2px 6px;
  z-index: 3; pointer-events: none;
  animation: memoNewPulse 1.4s ease-in-out infinite;
  box-shadow: 0 0 8px rgba(0,201,167,0.6);
}
body.light .memo-note-new-badge {
  color: #fff;
  box-shadow: 0 0 8px rgba(200,24,94,0.5);
}
@keyframes memoNewPulse {
  0%,100% { opacity: 1; transform: scale(1); }
  50%      { opacity: 0.5; transform: scale(0.92); }
}

/* ── Bouton thème flottant ── */
#floatingThemeBtn {
  position: fixed;
  top: 14px; right: 14px;
  z-index: 9000;
  padding: 6px 14px;
  border-radius: 20px;
  background: var(--s2);
  border: 1px solid var(--border);
  color: var(--sub);
  display: flex; align-items: center; justify-content: center;
  font-size: 12px;
  font-weight: 500;
  font-family: 'DM Sans', sans-serif;
  cursor: pointer;
  user-select: none;
  box-shadow: 0 2px 10px rgba(0,0,0,0.18);
  transition: background 0.15s, color 0.15s, transform 0.15s, box-shadow 0.15s, opacity 0.2s;
  opacity: 0.75;
}
#floatingThemeBtn:hover {
  background: var(--s3);
  color: var(--text);
  opacity: 1;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}
/* Masqué sur la page principale (le bubbleBtn Thème suffit) */
body:not(.subview-open) #floatingThemeBtn { opacity: 0; pointer-events: none; }
body.subview-open #themeToggle { display: none; }
/* Masqué quand InstaLove est ouvert (la topbar a son propre bouton thème) */
#hiddenPage.active ~ #floatingThemeBtn,
body:has(#hiddenPage.active) #floatingThemeBtn { opacity: 0 !important; pointer-events: none !important; }
body:has(#hiddenPage.active) #themeToggleHome { opacity: 0 !important; pointer-events: none !important; }
/* Masquer le header principal quand InstaLove est ouvert */
body:has(#hiddenPage.active) header,
body:has(#hiddenPage.active) header + div { visibility: hidden !important; pointer-events: none !important; }

/* ══ InstaLove tab card ══ */
#instaloveTabCard:active #instaloveTabCta { opacity: 0.75; transform: scale(0.97); }
@keyframes instalovePulse {
  0%,100% { box-shadow: 0 8px 32px rgba(238,42,123,0.35); }
  50%     { box-shadow: 0 8px 48px rgba(238,42,123,0.6), 0 0 0 8px rgba(238,42,123,0.08); }
}
#instaloveTabCard > div:first-child { animation: instalovePulse 3s ease-in-out infinite; }
/* Masqué dans Quiz, Jeux et sous-jeux (ils ont leur propre bouton icône) */
body:has(#quizView.active) #floatingThemeBtn,
body:has(#gamesView.active) #floatingThemeBtn,
body:has(#memoryView.active) #floatingThemeBtn,
body:has(#penduView.active) #floatingThemeBtn,
body:has(#puzzleView.active) #floatingThemeBtn,
body:has(#snakeView.active) #floatingThemeBtn { opacity: 0 !important; pointer-events: none !important; }
body:has(#quizView.active) #themeToggleHome,
body:has(#gamesView.active) #themeToggleHome,
body:has(#memoryView.active) #themeToggleHome,
body:has(#penduView.active) #themeToggleHome,
body:has(#puzzleView.active) #themeToggleHome,
body:has(#snakeView.active) #themeToggleHome { opacity: 0 !important; pointer-events: none !important; }

/* ════════════════════════════════════════════
   SUGGESTION SECTION
════════════════════════════════════════════ */
.suggestion-header-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 26px 16px 0;
}
.suggestion-lock-badge {
  display: inline-flex;
  align-items: center;
  gap: 7px;
  font-size: 11px;
  font-weight: 700;
  color: var(--text);
  letter-spacing: 0.3px;
  background: var(--s2);
  border: 1.5px solid var(--border);
  border-radius: 50px;
  padding: 8px 16px 8px 12px;
  cursor: pointer;
  user-select: none;
  position: relative;
  overflow: visible;
  transition: transform 0.18s, box-shadow 0.18s, border-color 0.18s, background 0.18s;
  box-shadow: 0 2px 10px rgba(0,0,0,0.18);
  animation: sgBadgePulse 4s ease-in-out infinite;
}
/* Shimmer background — transform-based pour GPU compositing */
.suggestion-lock-badge::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(105deg, transparent 30%, rgba(255,255,255,0.08) 50%, transparent 70%);
  animation: sgShimmer 4s ease-in-out infinite;
  pointer-events: none;
  will-change: transform;
  transform: translateX(-100%);
  border-radius: 50px;
  clip-path: inset(0 0 0 0 round 50px);
}
/* Ring de pulse — opacity sur box-shadow fixe, compositable */
.suggestion-lock-badge::before {
  content: '';
  position: absolute;
  inset: -2px;
  border-radius: 50px;
  box-shadow: 0 0 0 2px rgba(0,201,167,0.45);
  opacity: 0;
  pointer-events: none;
  animation: sgBadgePulse 4s ease-in-out infinite;
}
body.light .suggestion-lock-badge::before {
  box-shadow: 0 0 0 2px rgba(200,24,94,0.5);
}
@keyframes sgBadgePulse {
  0%,100% { opacity: 0; }
  50%     { opacity: 1; }
}
@keyframes sgBadgePulseLight {
  0%,100% { opacity: 0; }
  50%     { opacity: 1; }
}
body.light .suggestion-lock-badge {
  box-shadow: 0 2px 10px rgba(200,24,94,0.10);
}
/* mode clair : l'animation ::before reste la même (opacity), on garde la règle animation-name pour cohérence */
body.light .suggestion-lock-badge:not(.unlocked):not(:hover) ::before{
  animation-name: sgBadgePulseLight;
}

/* Dot coloré à gauche */
.sg-badge-dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: var(--green);
  flex-shrink: 0;
  animation: blink 3s ease-in-out infinite;
}

.suggestion-lock-badge:hover {
  transform: translateY(-2px) scale(1.04);
  box-shadow: 0 6px 22px rgba(29,185,84,0.28), 0 2px 8px rgba(0,0,0,0.2);
  border-color: rgba(0,201,167,0.5);
  background: var(--s3);
  animation: none;
}
body.light .suggestion-lock-badge:hover {
  box-shadow: 0 6px 20px rgba(200,24,94,0.28), 0 2px 8px rgba(200,24,94,0.12);
  border-color: rgba(200,24,94,0.5);
}
.suggestion-lock-badge.unlocked {
  color: var(--green);
  border-color: rgba(29,185,84,0.45);
  background: rgba(0,201,167,0.08);
  animation: none;
}
.suggestion-lock-badge.unlocked .sg-badge-dot {
  background: var(--green);
  animation: none;
  opacity: 1;
}
body.light .suggestion-lock-badge.unlocked {
  color: var(--green);
  background: rgba(200,24,94,0.07);
  border-color: rgba(200,24,94,0.4);
}
.suggestion-col-header {
  display: flex;
  align-items: center;
  padding: 8px 10px 8px 16px;
  border-bottom: 1px solid var(--border);
  margin: 8px 0 2px;
}
.sg-song {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 7px 10px 7px 16px;
  border-radius: 6px;
  transition: background 0.12s;
  border: 1px solid transparent;
}
.sg-song:hover { background: rgba(255,255,255,0.06); }
body.light .sg-song:hover { background: rgba(200,24,94,0.05); }
.sg-dot {
  width: 7px; height: 7px;
  border-radius: 50%;
  background: var(--green);
  opacity: 0.4;
  flex-shrink: 0;
}
.sg-info { flex: 1; min-width: 0; }
.sg-title {
  font-size: 13px;
  font-weight: 500;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.sg-artist {
  font-size: 11px;
  color: var(--muted);
  margin-top: 1px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.sg-note {
  font-size: 10px;
  color: var(--muted);
  font-style: italic;
  max-width: 110px;
  text-align: right;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex-shrink: 0;
  padding-right: 4px;
}
.sg-del {
  width: 26px; height: 26px;
  border-radius: 50%;
  border: none;
  background: transparent;
  color: var(--muted);
  font-size: 11px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: color 0.15s, background 0.15s;
  opacity: 0;
  flex-shrink: 0;
}
.sg-song:hover .sg-del { opacity: 1; }
.sg-del:hover { color: #e05555; background: rgba(220,50,50,0.1); }
.sg-edit {
  width: 26px; height: 26px;
  border-radius: 50%;
  border: none;
  background: transparent;
  color: var(--muted);
  font-size: 12px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: color 0.15s, background 0.15s;
  opacity: 0;
  flex-shrink: 0;
}
.sg-song:hover .sg-edit { opacity: 1; }
.sg-edit:hover { color: var(--green); background: rgba(0,201,167,0.1); }
#sgEditModal {
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.75);
  z-index: 3000;
  display: none;
  align-items: center; justify-content: center;
  padding: 24px 16px;
  backdrop-filter: blur(4px);
}
#sgEditModal.open { display: flex; }
.sg-empty {
  padding: 20px 16px;
  font-size: 12px;
  color: var(--muted);
  font-style: italic;
  text-align: center;
}
.sg-add-btn {
  display: none;
  align-items: center;
  gap: 6px;
  margin: 8px 16px 0;
  padding: 10px 14px;
  background: rgba(0,201,167,0.07);
  border: 1px dashed rgba(0,201,167,0.3);
  border-radius: 8px;
  font-size: 12px;
  font-weight: 600;
  color: var(--green);
  cursor: pointer;
  transition: background 0.15s, border-color 0.15s;
  user-select: none;
}
.sg-add-btn:hover { background: rgba(0,201,167,0.12); border-color: rgba(0,201,167,0.5); }

/* ── SUGGESTION MODAL ── */
#sgModal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.75);
  z-index: 2500;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 24px 16px;
  backdrop-filter: blur(4px);
}
#sgModal.open { display: flex; }
.sg-modal-inner {
  background: var(--s1);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 24px 20px;
  width: 100%;
  max-width: 380px;
  position: relative;
  box-shadow: var(--shadow);
  animation: slideUp 0.22s ease;
}
.sg-modal-close {
  position: absolute;
  top: 14px; right: 14px;
  font-size: 18px;
  color: var(--muted);
  cursor: pointer;
  transition: color 0.15s;
}
.sg-modal-close:hover { color: var(--text); }
.sg-modal-tag {
  font-size: 9px;
  font-weight: 700;
  color: var(--green);
  text-transform: uppercase;
  letter-spacing: 2.5px;
  margin-bottom: 8px;
}
.sg-modal-title {
  font-family: 'Playfair Display', serif;
  font-size: 20px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 18px;
}
.sg-field-label {
  font-size: 9px;
  font-weight: 700;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1.5px;
  margin-bottom: 5px;
}
.sg-input {
  width: 100%;
  padding: 10px 13px;
  font-size: 14px;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--s2);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  outline: none;
  transition: border-color 0.2s;
  margin-bottom: 12px;
}
.sg-input:focus { border-color: var(--green); }
.sg-modal-save {
  width: 100%;
  padding: 12px;
  margin-top: 4px;
  background: var(--green);
  color: #000;
  font-weight: 700;
  font-size: 14px;
  font-family: 'DM Sans', sans-serif;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.15s, transform 0.1s;
}
.sg-modal-save:hover { background: var(--green2); transform: scale(1.02); }
.sg-gender-row {
  display: flex;
  gap: 8px;
  margin-bottom: 14px;
}
.sg-gender-btn {
  flex: 1;
  padding: 10px 8px;
  border-radius: 8px;
  border: 1.5px solid var(--border);
  background: var(--s2);
  color: var(--sub);
  font-size: 12px;
  font-weight: 600;
  font-family: 'DM Sans', sans-serif;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 7px;
  transition: border-color 0.15s, background 0.15s, color 0.15s, transform 0.1s;
  user-select: none;
}
.sg-gender-btn:hover { background: var(--s3); color: var(--text); }
.sg-gender-btn.selected-girl {
  border-color: #e879a0;
  background: rgba(232,121,160,0.1);
  color: #e879a0;
}
.sg-gender-btn.selected-boy {
  border-color: #5b9cf6;
  background: rgba(91,156,246,0.1);
  color: #5b9cf6;
}
.sg-gender-icon {
  width: 10px; height: 10px;
  border-radius: 50%;
  flex-shrink: 0; display: block;
}
.sg-gender-btn .girl-icon { background: #e879a0; box-shadow: 0 0 6px rgba(232,121,160,0.60); }
.sg-gender-btn .boy-icon  { background: #5b9cf6; box-shadow: 0 0 6px rgba(91,156,246,0.5); }
.sg-gender-btn.selected-girl .girl-icon { box-shadow: 0 0 10px rgba(232,121,160,0.9); }
.sg-gender-btn.selected-boy  .boy-icon  { box-shadow: 0 0 10px rgba(91,156,246,0.8); }
.sg-dot-girl { background: #e879a0 !important; opacity: 0.85 !important; }
.sg-dot-boy  { background: #5b9cf6 !important; opacity: 0.85 !important; }
.sg-num {
  font-size: 10px;
  font-weight: 700;
  color: var(--muted);
  width: 18px;
  text-align: right;
  flex-shrink: 0;
  font-variant-numeric: tabular-nums;
  line-height: 1;
}

/* ── AUTH MODAL SUGGESTION ── */
#sgAuthModal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.75);
  z-index: 2600;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 24px 16px;
  backdrop-filter: blur(4px);
}
#sgAuthModal.open { display: flex; }

/* ════════════════════════════════════════════
   GAMES VIEW
════════════════════════════════════════════ */
#gamesView {
  display: none; position: fixed; inset: 0; background: var(--bg); z-index: 500;
  overflow-y: auto; padding-bottom: var(--nav-height); transition: background 0.3s, color 0.3s;
  overscroll-behavior:contain; -webkit-overflow-scrolling:touch;
}
#gamesView.active { display: block; }
.gv-header { padding: 14px 16px 10px; padding-top: calc(var(--safe-top) + 14px); border-bottom: 1px solid var(--border); position: relative; overflow: hidden; }
.gv-header::before { content:''; position:absolute; inset:0; background:radial-gradient(circle at 80% 20%, rgba(61,155,212,0.07) 0%, transparent 60%); pointer-events:none; }
.gv-back { display:inline-flex; align-items:center; gap:7px; font-size:11px; font-weight:600; color:var(--sub); background:var(--s2); border:1px solid var(--border); border-radius:20px; padding:7px 14px; cursor:pointer; margin-bottom:10px; transition:background 0.15s, color 0.15s, transform 0.12s; }
.gv-back:hover { background:var(--s3); color:var(--text); transform:translateX(-2px); }
.gv-tag { font-size:10px; font-weight:700; letter-spacing:3px; text-transform:uppercase; color:var(--green); margin-bottom:4px; }
.gv-title { font-family:'Playfair Display',serif; font-size:clamp(28px,8vw,46px); font-weight:700; color:var(--text); line-height:1.05; letter-spacing:-0.5px; }
.gv-sub { font-size:12px; color:var(--muted); margin-top:6px; letter-spacing:0.5px; }

/* Liste des jeux */
.gv-game-list { padding: 20px 16px; display: flex; flex-direction: column; gap: 10px; }
.gv-game-card {
  display: flex; align-items: center; gap: 14px;
  background: var(--s1); border: 1px solid var(--border); border-radius: 12px;
  padding: 14px 16px; cursor: pointer;
  transition: background 0.15s, transform 0.15s, box-shadow 0.15s;
  position: relative; overflow: hidden;
}
.gv-game-card::before { content:''; position:absolute; left:0; top:0; bottom:0; width:3px; background:var(--green); border-radius:3px 0 0 3px; opacity:0.5; }
.gv-game-card:hover { background: var(--s2); transform: translateY(-2px); box-shadow: var(--shadow); }
.gv-game-card:hover::before { opacity: 1; }
.gv-game-card-icon { font-size: 22px; line-height: 1; flex-shrink: 0; }
.gv-game-card-info { flex: 1; min-width: 0; }
.gv-game-card-name { font-size: 13px; font-weight: 700; color: var(--text); }
.gv-game-card-desc { font-size: 11px; color: var(--muted); margin-top: 2px; }
.gv-game-card-arrow { font-size: 16px; color: var(--muted); flex-shrink: 0; }

/* Vue individuelle d'un jeu */
#memoryView {
  display: none; position: fixed; inset: 0; background: var(--bg); z-index: 600;
  overflow-y: auto; padding-bottom: var(--nav-height); transition: background 0.3s;
  overscroll-behavior:contain; -webkit-overflow-scrolling:touch;
}
#memoryView.active { display: block; }
.game-view-header { padding: 22px 16px 16px; padding-top: calc(var(--safe-top) + 22px); border-bottom: 1px solid var(--border); display: flex; align-items: flex-start; justify-content: space-between; }
.game-view-back { display:inline-flex; align-items:center; gap:7px; font-size:11px; font-weight:600; color:var(--sub); background:var(--s2); border:1px solid var(--border); border-radius:20px; padding:7px 14px; cursor:pointer; margin-bottom:8px; transition:background 0.15s, color 0.15s, transform 0.12s; }
.game-view-back:hover { background:var(--s3); color:var(--text); transform:translateX(-2px); }
.game-view-title { font-family:'Playfair Display',serif; font-size:22px; font-weight:700; color:var(--text); }
.game-view-body { padding: 16px 16px 0; }

/* ════ PENDU ════ */
#penduView,#puzzleView,#snakeView{display:none;position:fixed;inset:0;background:var(--bg);z-index:600;overflow-y:auto;overflow-x:hidden;padding-bottom:var(--nav-height);transition:background 0.3s;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;}
#penduView.active,#puzzleView.active,#snakeView.active{display:block;}

/* ══ SKYJO STYLES ══ */
/* ══ SKYJO CARDS & GRID ══ */
:root {
  --sj-cw: 46px; --sj-ch: 64px; --sj-fs: 16px;
  --sj-radius: 10px;
  --sj-shadow: 0 2px 8px rgba(0,0,0,0.38), 0 1px 2px rgba(0,0,0,0.22);
  --sj-shadow-hover: 0 8px 24px rgba(0,0,0,0.52), 0 2px 6px rgba(0,0,0,0.3);
}

/* ══════════════════════════════════════════════════
   SKYJO — plein écran, layout serré, no-scroll
══════════════════════════════════════════════════ */
#skyjoView {
  display: none; position: fixed !important; inset: 0 !important;
  z-index: 600; overflow: hidden !important;
  flex-direction: column; background: var(--bg);
  font-family: 'DM Sans', sans-serif;
  touch-action: none;
  overscroll-behavior: none;
}
#skyjoView.active { display: flex !important; }
@keyframes sjViewEnter {
  from { opacity:0; transform: scale(0.97) translateY(12px); }
  to   { opacity:1; transform: scale(1) translateY(0); }
}

/* Header ultra-compact */
#skyjoView .game-view-header {
  flex-shrink: 0; padding: 6px 12px;
  padding-top: calc(var(--safe-top) + 6px);
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  min-height: 0;
  background: var(--s1);
}
#skyjoView .game-view-header .game-view-title { font-size: 16px; }
#skyjoView .game-view-header .game-view-back  { padding: 5px 10px; font-size: 11px; }

#skyjoView .game-view-body {
  flex: 1; min-height: 0;
  display: flex; flex-direction: column; overflow: hidden; padding: 0;
  position: relative;
}

/* Écrans secondaires */
#skyjoWaitScreen, #skyjoRoundEnd, #skyjoGameEnd {
  flex: 1; display: none; flex-direction: column;
  align-items: center; justify-content: center;
  padding: 24px; overflow-y: auto; gap: 14px;
}

/* Zone de jeu */
#skyjoGameArea { flex: 1; min-height: 0; display: none; flex-direction: column; overflow: hidden; }
#skyjoGameArea.sja-visible { display: flex !important; }

/* ── Bannière de tour ── */
#skyjoTurnBanner {
  flex-shrink: 0; padding: 7px 14px;
  font-size: 11px; font-weight: 700; text-align: center; line-height: 1.3;
  overflow: hidden;
  letter-spacing: 0.3px;
  transition: background 0.3s, border-color 0.3s, box-shadow 0.3s, color 0.3s;
  position: relative;
  display: flex; align-items: center; justify-content: center; gap: 8px;
}
.skyjo-turn-banner.my-turn {
  background: linear-gradient(90deg, rgba(0,201,167,0.08) 0%, rgba(0,201,167,0.22) 50%, rgba(0,201,167,0.08) 100%);
  background-size: 200% 100%;
  color: #00e5bd;
  border-bottom: 2px solid rgba(0,201,167,0.45);
  text-shadow: 0 0 12px rgba(0,201,167,0.5);
  animation: sjBannerFlow 3s ease-in-out infinite;
}
@keyframes sjBannerFlow {
  0%,100% { background-position: 0% 0; }
  50%     { background-position: 100% 0; }
}
.skyjo-turn-banner.their-turn {
  background: rgba(79,70,229,0.06);
  color: rgba(160,150,240,0.7);
  border-bottom: 1px solid rgba(79,70,229,0.18);
  font-style: italic;
}

/* Terrain vertical : 2 zones joueur + 1 zone centrale */
#skyjoPlayField {
  flex: 1; min-height: 0;
  display: flex; flex-direction: column; align-items: stretch; overflow: hidden;
  touch-action: none;
  overscroll-behavior: none;
}

/* ─── Zones joueur avec indicateur de tour fort ─── */
.skyjo-player-zone {
  flex: 1; min-height: 0;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  padding: 4px 8px; position: relative; gap: 4px;
  transition: background 0.4s ease, box-shadow 0.4s ease;
  overflow: hidden;
}
/* Trait lumineux bord gauche — indicateur de tour */
.skyjo-player-zone::before {
  content: '';
  position: absolute;
  top: 0; bottom: 0; left: 0;
  width: 3px;
  border-radius: 0 2px 2px 0;
  transition: opacity 0.4s ease, background 0.4s ease;
  opacity: 0;
}
/* Zone adverse (haut) */
.skyjo-player-zone.zone-opp {
  background: rgba(79,70,229,0.04);
  border-bottom: 1px solid rgba(79,70,229,0.12);
}
.skyjo-player-zone.zone-opp::before {
  background: linear-gradient(180deg, rgba(79,70,229,0) 0%, #7c6df5 50%, rgba(79,70,229,0) 100%);
  width: 4px;
}
.skyjo-player-zone.zone-opp.active-zone {
  animation: sjZoneOppBreath 2.8s ease-in-out infinite;
  border-bottom: 1px solid rgba(79,70,229,0.5);
}
@keyframes sjZoneOppBreath {
  0%,100% { background: rgba(79,70,229,0.10); box-shadow: inset 0 0 50px rgba(79,70,229,0.10); }
  50%     { background: rgba(79,70,229,0.20); box-shadow: inset 0 0 80px rgba(79,70,229,0.18); }
}
.skyjo-player-zone.zone-opp.active-zone::before { opacity: 1; }

/* Zone moi (bas) */
.skyjo-player-zone.zone-me {
  background: rgba(5,150,105,0.04);
  border-top: 1px solid rgba(5,150,105,0.12);
  padding-bottom: max(8px, var(--safe-bottom));
}
.skyjo-player-zone.zone-me::before {
  background: linear-gradient(180deg, rgba(5,150,105,0) 0%, #00c9a7 50%, rgba(5,150,105,0) 100%);
  width: 4px;
}
.skyjo-player-zone.zone-me.active-zone {
  animation: sjZoneMeBreath 2.8s ease-in-out infinite;
  border-top: 1px solid rgba(0,201,167,0.5);
}
@keyframes sjZoneMeBreath {
  0%,100% { background: rgba(5,150,105,0.12); box-shadow: inset 0 0 50px rgba(0,201,167,0.10); }
  50%     { background: rgba(5,150,105,0.22); box-shadow: inset 0 0 80px rgba(0,201,167,0.20); }
}
.skyjo-player-zone.zone-me.active-zone::before { opacity: 1; }

/* ─── Badge de tour — position absolue à droite, hors flux ─── */
#skyjoTurnBadgeSlot {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
}

/* Badge "TON TOUR" : cercle lumineux, rien à voir avec une carte */
.sj-your-turn-badge {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 3px;
  width: 52px;
  height: 52px;
  border-radius: 50%;
  background: radial-gradient(circle at 40% 35%, rgba(0,229,189,0.32), rgba(0,201,167,0.14));
  border: none;
  outline: 2px solid rgba(0,201,167,0.7);
  outline-offset: 2px;
  font-size: 8px; font-weight: 900;
  color: #00ffda;
  letter-spacing: 0.8px;
  text-transform: uppercase;
  pointer-events: none;
  animation: sjYourTurnBadge 2.6s ease-in-out infinite;
  box-shadow: 0 0 18px rgba(0,201,167,0.4), 0 0 40px rgba(0,201,167,0.12);
  text-shadow: 0 0 8px rgba(0,229,189,0.9);
  text-align: center;
  line-height: 1.25;
}
.sj-your-turn-badge .sj-badge-icon {
  font-size: 18px;
  line-height: 1;
  animation: sjBadgeIconPulse 2.6s ease-in-out infinite;
}
@keyframes sjBadgeIconPulse {
  0%,100% { transform: scale(1);    filter: drop-shadow(0 0 3px rgba(0,229,189,0.4)); }
  40%     { transform: scale(1.22); filter: drop-shadow(0 0 10px rgba(0,229,189,1)); }
  80%     { transform: scale(0.92); filter: drop-shadow(0 0 2px rgba(0,229,189,0.2)); }
}

/* Badge "Son tour" : cercle discret violet */
.sj-their-turn-badge {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 3px;
  width: 52px;
  height: 52px;
  border-radius: 50%;
  background: rgba(79,70,229,0.10);
  outline: 1px solid rgba(79,70,229,0.28);
  outline-offset: 2px;
  font-size: 8px; font-weight: 600;
  color: rgba(180,170,255,0.65);
  letter-spacing: 0.5px;
  text-transform: uppercase;
  pointer-events: none;
  font-style: italic;
  text-align: center;
  line-height: 1.25;
}
.sj-their-turn-badge .sj-badge-icon {
  font-size: 16px;
  line-height: 1;
  opacity: 0.55;
}

@keyframes sjYourTurnBadge {
  0%,100% {
    transform: scale(1);
    box-shadow: 0 0 12px rgba(0,201,167,0.3), 0 0 30px rgba(0,201,167,0.08);
    outline-color: rgba(0,201,167,0.6);
  }
  40% {
    transform: scale(1.07);
    box-shadow: 0 0 26px rgba(0,201,167,0.65), 0 0 55px rgba(0,201,167,0.22);
    outline-color: rgba(0,229,189,1);
  }
  80% {
    transform: scale(0.96);
    box-shadow: 0 0 8px rgba(0,201,167,0.18), 0 0 20px rgba(0,201,167,0.05);
    outline-color: rgba(0,201,167,0.4);
  }
}

/* Infos joueur — ligne compacte */
.skyjo-player-info { display: flex; align-items: center; gap: 6px; }
.skyjo-avatar {
  width: 28px; height: 28px; border-radius: 50%; flex-shrink: 0;
  background: var(--s2); border: 2px solid var(--border);
  display: flex; align-items: center; justify-content: center; font-size: 15px;
  transition: border-color 0.35s, box-shadow 0.35s, transform 0.35s;
}
.skyjo-player-name  {
  font-size: 11px; font-weight: 700; color: var(--text);
  transition: color 0.35s;
}
.skyjo-player-zone.active-zone .skyjo-player-name {
  color: var(--green);
}
.skyjo-player-score-badge {
  background: var(--s2); border: 1px solid var(--border);
  border-radius: 20px; padding: 1px 8px;
  font-size: 11px; font-weight: 800; color: var(--text);
  font-variant-numeric: tabular-nums;
  transition: background 0.35s, color 0.35s, border-color 0.35s;
}
.skyjo-player-zone.zone-me.active-zone .skyjo-player-score-badge {
  background: rgba(5,150,105,0.18);
  border-color: rgba(5,150,105,0.5);
  color: #4eeebb;
}
.skyjo-player-zone.zone-opp.active-zone .skyjo-player-score-badge {
  background: rgba(79,70,229,0.18);
  border-color: rgba(79,70,229,0.5);
  color: #b0c4ff;
}
.skyjo-manche-badge {
  position: absolute; top: 4px; left: 8px;
  font-size: 9px; font-weight: 700; color: var(--muted);
  background: var(--s1); border: 1px solid var(--border);
  border-radius: 5px; padding: 1px 6px;
}

/* Zone centrale : pioche + carte-en-main (à gauche) / défausse (à droite) */
#skyjoMidZone {
  flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  gap: 14px; padding: 5px 12px;
  background: linear-gradient(135deg, var(--s1) 0%, var(--s2) 100%);
  border-top: 1px solid var(--border); border-bottom: 1px solid var(--border);
  box-shadow: 0 2px 12px rgba(0,0,0,0.15) inset;
  position: relative;
}
.skyjo-pile-slot { display: flex; flex-direction: column; align-items: center; gap: 3px; }
.skyjo-pile-label {
  font-size: 8px; font-weight: 700; color: var(--muted);
  text-transform: uppercase; letter-spacing: 1.2px;
}

/* Carte en main — toujours dans le flux pour éviter les décalages */
#skyjoDrawSlot { display: flex; align-items: center; gap: 8px; }
#skyjoHeldCardWrap {
  display: flex; flex-direction: column; align-items: center; gap: 3px;
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.22s cubic-bezier(.4,0,.2,1);
  pointer-events: none;
}
#skyjoHeldCardWrap.sj-held-visible {
  visibility: visible;
  opacity: 1;
  pointer-events: auto;
}
#skyjoHeldCard {
  animation: sjHeldFloat 2s ease-in-out infinite;
  position: relative; overflow: hidden;
}
@keyframes sjHeldFloat {
  0%,100% { transform: translateY(0) rotateZ(-0.5deg); box-shadow: 0 3px 12px rgba(109,90,205,0.35), var(--sj-shadow); }
  50%     { transform: translateY(-2px) rotateZ(0.5deg); box-shadow: 0 6px 18px rgba(109,90,205,0.45), var(--sj-shadow); }
}
#skyjoHeldCard::before {
  content: '';
  position: absolute; inset: 0;
  background: linear-gradient(135deg, rgba(255,255,255,0.14) 0%, transparent 60%);
  border-radius: inherit;
  pointer-events: none;
}
#skyjoHeldCard::after {
  content: '';
  position: absolute;
  top: -60%; left: -60%;
  width: 220%; height: 220%;
  background: linear-gradient(110deg, transparent 35%, rgba(255,255,255,0.12) 50%, transparent 65%);
  animation: sjHeldShine 5s ease-in-out infinite;
  pointer-events: none;
}
@keyframes sjHeldShine {
  0%,60%,100% { transform: translateX(-60%) rotateZ(10deg); }
  30%         { transform: translateX(60%) rotateZ(10deg); }
}
#skyjoHeldLabel {
  font-size: 8px; font-weight: 800; color: #b29afa;
  text-transform: uppercase; letter-spacing: 1px;
}
#skyjoDiscardBtn {
  padding: 3px 8px;
  background: rgba(239,83,80,0.12); color: #ef5350;
  border: 1px solid rgba(239,83,80,0.3); border-radius: 5px;
  font-size: 8px; font-weight: 800; font-family: 'DM Sans', sans-serif;
  cursor: pointer; white-space: nowrap;
  transition: background 0.15s, transform 0.1s, box-shadow 0.15s;
}
#skyjoDiscardBtn:hover { background: rgba(239,83,80,0.22); box-shadow: 0 2px 8px rgba(239,83,80,0.2); }
#skyjoDiscardBtn:active { transform: scale(0.94); }
#skyjoDrawPileCount { font-size: 8px; color: var(--muted); text-align: center; font-variant-numeric: tabular-nums; }

/* ══ CARTE EN MAIN ADVERSAIRE (live spectateur) ══ */
#skyjoOppHeldWrap {
  display: flex; flex-direction: column; align-items: center; gap: 3px;
  visibility: hidden; opacity: 0;
  transition: opacity 0.22s cubic-bezier(.4,0,.2,1);
  pointer-events: none;
  /* Positionné dans la zone opp, à gauche de la grille */
}
#skyjoOppHeldWrap.sj-held-visible {
  visibility: visible; opacity: 1;
}
#skyjoOppHeldCard {
  animation: sjOppHeldFloat 2s ease-in-out infinite;
  position: relative; overflow: hidden;
}
@keyframes sjOppHeldFloat {
  0%,100% { transform: translateY(0) rotateZ(0.5deg); box-shadow: 0 3px 12px rgba(239,83,80,0.35), var(--sj-shadow); }
  50%     { transform: translateY(-2px) rotateZ(-0.5deg); box-shadow: 0 6px 18px rgba(239,83,80,0.45), var(--sj-shadow); }
}
#skyjoOppHeldCard::before {
  content: '';
  position: absolute; inset: 0;
  background: linear-gradient(135deg, rgba(255,255,255,0.14) 0%, transparent 60%);
  border-radius: inherit; pointer-events: none;
}
#skyjoOppHeldLabel {
  font-size: 8px; font-weight: 800; color: #f87171;
  text-transform: uppercase; letter-spacing: 1px;
}
/* Pause si page cachée */
body.skyjo-bg-paused #skyjoOppHeldCard { animation-play-state: paused !important; }

/* ══════════════════════════════════════════════════
   CARTES — Design inspiré Skyjo avec motif hexa
══════════════════════════════════════════════════ */

/* SVG hexagonal encodé — réutilisé sur toutes les cartes face */
:root {
  --sj-hexa: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='32'%3E%3Cpolygon points='14,1 27,8 27,23 14,30 1,23 1,8' fill='none' stroke='rgba(255,255,255,0.10)' stroke-width='1'/%3E%3C/svg%3E");
  --sj-hexa-dark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='32'%3E%3Cpolygon points='14,1 27,8 27,23 14,30 1,23 1,8' fill='none' stroke='rgba(255,255,255,0.06)' stroke-width='1'/%3E%3C/svg%3E");
}

.skyjo-card {
  width: var(--sj-cw); height: var(--sj-ch);
  border-radius: var(--sj-radius);
  display: inline-flex; align-items: center; justify-content: center;
  font-size: var(--sj-fs); font-weight: 900;
  border: none; cursor: default; user-select: none; flex-shrink: 0;
  transition: transform 0.15s cubic-bezier(.17,.89,.32,1.28), box-shadow 0.15s;
  box-shadow: var(--sj-shadow);
  position: relative; overflow: hidden;
  outline: 1px solid rgba(255,255,255,0.10);
  letter-spacing: -0.5px;
}

/* Motif hexagonal sur toutes les cartes face visible */
.skyjo-card:not(.skyjo-card-back):not(.skyjo-card-hidden)::after {
  content: '';
  position: absolute; inset: 0;
  background-image: var(--sj-hexa);
  background-size: 18px 20px;
  opacity: 1;
  pointer-events: none;
  z-index: 0;
  border-radius: inherit;
}

/* Reflet haut sur toutes les cartes */
.skyjo-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 42%;
  background: linear-gradient(180deg, rgba(255,255,255,0.16) 0%, transparent 100%);
  border-radius: var(--sj-radius) var(--sj-radius) 0 0;
  pointer-events: none;
  z-index: 2;
}

/* Chiffre au-dessus du motif */
/* Chiffre central — texte blanc avec contour noir épais */
.skyjo-card > span.sj-num {
  position: relative;
  z-index: 3;
  line-height: 1;
  color: #fff;
  -webkit-text-stroke: 2px rgba(0,0,0,0.85);
  paint-order: stroke fill;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5));
}

/* Pastilles ovales — très discrètes */
.skyjo-card > .sj-pip-top,
.skyjo-card > .sj-pip-bot {
  position: absolute;
  z-index: 3;
  background: rgba(255,255,255,0.18);
  border-radius: 50%;
  width: 28%; height: 16%;
  display: flex; align-items: center; justify-content: center;
  font-size: calc(var(--sj-fs) * 0.38);
  font-weight: 700;
  color: rgba(255,255,255,0.65);
  line-height: 1;
}
.skyjo-card > .sj-pip-top { top: 4%; left: 7%; }
.skyjo-card > .sj-pip-bot { bottom: 4%; right: 7%; transform: rotate(180deg); }

/* ── Dos de carte — vert foncé avec motif hexa ── */
.skyjo-card-back,
.skyjo-card.skyjo-card-hidden {
  background-color: #163d28;
  background-image:
    var(--sj-hexa-dark),
    radial-gradient(ellipse at 35% 30%, rgba(255,255,255,0.07) 0%, transparent 60%);
  background-size: 18px 20px, cover;
  color: transparent;
  border: 1.5px solid rgba(255,255,255,0.09);
}
.skyjo-card-back::after,
.skyjo-card.skyjo-card-hidden::after { display: none; }

/* ── Carte en main (violette) ── */
.skyjo-card-held {
  background: linear-gradient(145deg, #7b68ee 0%, #5b4bcc 100%);
  color: #e8e0ff;
  text-shadow: 0 1px 4px rgba(0,0,0,0.4);
  border: 1.5px solid rgba(200,185,255,0.2);
}

/* ════════════════════════════════════
   Palette de couleurs par valeur
════════════════════════════════════ */
.skyjo-card[data-val="-2"] { background: linear-gradient(145deg, #1a56a0 0%, #0d3873 100%); color: #a8d4ff; text-shadow: 0 0 10px rgba(100,180,255,0.7), 0 1px 3px rgba(0,0,0,0.5); }
.skyjo-card[data-val="-1"] { background: linear-gradient(145deg, #2563c0 0%, #1445a0 100%); color: #bddcff; text-shadow: 0 0 10px rgba(130,195,255,0.65), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="0"]  { background: linear-gradient(145deg, #6044b0 0%, #42308a 100%); color: #d4c4ff; text-shadow: 0 0 10px rgba(200,170,255,0.6), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="1"]  { background: linear-gradient(145deg, #c46010 0%, #8f4008 100%); color: #ffd28a; text-shadow: 0 0 10px rgba(255,190,80,0.6), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="2"]  { background: linear-gradient(145deg, #d4700f 0%, #a05008 100%); color: #ffe0a0; text-shadow: 0 0 10px rgba(255,210,100,0.6), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="3"]  { background: linear-gradient(145deg, #b88508 0%, #836005 100%); color: #ffe890; text-shadow: 0 0 10px rgba(255,225,80,0.6), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="4"]  { background: linear-gradient(145deg, #7a8e10 0%, #556210 100%); color: #dcf060; text-shadow: 0 0 10px rgba(200,235,50,0.6), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="5"]  { background: linear-gradient(145deg, #1d7838 0%, #0f5228 100%); color: #80f0a0; text-shadow: 0 0 10px rgba(80,230,120,0.6), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="6"]  { background: linear-gradient(145deg, #178a50 0%, #0c5e38 100%); color: #70f0c0; text-shadow: 0 0 10px rgba(60,230,170,0.6), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="7"]  { background: linear-gradient(145deg, #0e7868 0%, #085248 100%); color: #5cf0e0; text-shadow: 0 0 10px rgba(50,220,210,0.6), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="8"]  { background: linear-gradient(145deg, #0a6888 0%, #064860 100%); color: #50d8f8; text-shadow: 0 0 10px rgba(40,200,240,0.6), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="9"]  { background: linear-gradient(145deg, #b01c1c 0%, #7c0f0f 100%); color: #ffb0a0; text-shadow: 0 0 10px rgba(255,130,100,0.65), 0 1px 3px rgba(0,0,0,0.45); }
.skyjo-card[data-val="10"] { background: linear-gradient(145deg, #981824 0%, #6a0d18 100%); color: #ffaab8; text-shadow: 0 0 10px rgba(255,120,140,0.65), 0 1px 3px rgba(0,0,0,0.45); font-size: calc(var(--sj-fs) * 0.88); }
.skyjo-card[data-val="11"] { background: linear-gradient(145deg, #7c1030 0%, #560822 100%); color: #ffa0c0; text-shadow: 0 0 10px rgba(255,100,160,0.65), 0 1px 3px rgba(0,0,0,0.45); font-size: calc(var(--sj-fs) * 0.88); }
.skyjo-card[data-val="12"] { background: linear-gradient(145deg, #981558 0%, #6a0a3e 100%); color: #ff90d8; text-shadow: 0 0 10px rgba(255,80,200,0.65), 0 1px 3px rgba(0,0,0,0.45); font-size: calc(var(--sj-fs) * 0.88); }

/* ── Cartes interactives (clickables) ── */
.skyjo-card.skyjo-card-clickable {
  cursor: pointer;
  animation: sjCardPulseV3 2.2s ease-in-out infinite;
  transition: transform 0.18s cubic-bezier(.17,.89,.32,1.15), box-shadow 0.18s;
}
@keyframes sjCardPulseV3 {
  0%,100% {
    box-shadow: 0 0 0 0 rgba(0,229,189,0.45), var(--sj-shadow);
    transform: scale(1);
  }
  50% {
    box-shadow: 0 0 0 4px rgba(0,229,189,0), var(--sj-shadow-hover);
    transform: scale(1.018);
  }
}
.skyjo-card.skyjo-card-clickable:hover {
  transform: scale(1.06) translateY(-2px) !important;
  box-shadow: 0 8px 22px rgba(0,229,189,0.28), var(--sj-shadow) !important;
  z-index: 5;
  animation-play-state: paused;
}
.skyjo-card.skyjo-card-clickable:active {
  transform: scale(0.97) translateY(0) !important;
  box-shadow: var(--sj-shadow) !important;
}

.skyjo-card.skyjo-col-complete {
  opacity: 0.22;
  pointer-events: none;
  filter: grayscale(60%) brightness(0.7);
  transform: scale(0.93);
}

/* Grille 4×3 */
.skyjo-grid {
  display: grid;
  grid-template-columns: repeat(4, var(--sj-cw));
  grid-template-rows: repeat(3, var(--sj-ch));
  gap: 5px;
}

/* Message phase bas */
#skyjoPhaseMsg {
  flex-shrink: 0; padding: 5px 12px;
  background: linear-gradient(90deg, rgba(0,201,167,0.08), rgba(0,201,167,0.14), rgba(0,201,167,0.08));
  border-top: 1px solid rgba(0,201,167,0.22);
  font-size: 10px; color: var(--sub); text-align: center; font-weight: 700; display: none;
  letter-spacing: 0.2px;
}

/* ── Animation flip carte fin de manche ── */
@keyframes sjFlipReveal {
  0%   { transform: rotateY(0deg)   scaleX(1);    filter: brightness(1); }
  40%  { transform: rotateY(90deg)  scaleX(0.92); filter: brightness(0.6); }
  41%  { transform: rotateY(-90deg) scaleX(0.92); filter: brightness(0.6); }
  85%  { transform: rotateY(-8deg)  scaleX(1.02); filter: brightness(1.15); }
  100% { transform: rotateY(0deg)   scaleX(1);    filter: brightness(1); }
}
.skyjo-card.sj-flipping {
  animation: sjFlipReveal 0.5s ease-in-out forwards;
  transform-style: preserve-3d;
}
/* Score total qui pulse en fin de manche */
@keyframes sjScorePop {
  0%   { transform: scale(0.7); opacity:0; }
  70%  { transform: scale(1.15); }
  100% { transform: scale(1); opacity:1; }
}
.sj-total-badge.sj-score-pop {
  animation: sjScorePop 0.4s cubic-bezier(.4,0,.2,1) forwards;
}

/* ── Badge total cartes révélées ── */
.sj-total-badge {
  width: 34px; height: 34px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; font-weight: 900; flex-shrink: 0;
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  font-variant-numeric: tabular-nums;
  transition: transform 0.2s, box-shadow 0.2s;
}
.sj-total-badge.mine {
  background: rgba(5,150,105,0.28);
  border: 2px solid rgba(5,150,105,0.7);
  color: #4eeebb;
  text-shadow: 0 0 10px rgba(0,220,160,0.5);
}
.sj-total-badge.opp {
  background: rgba(79,70,229,0.25);
  border: 2px solid rgba(79,70,229,0.6);
  color: #b0c4ff;
  text-shadow: 0 0 10px rgba(120,130,255,0.5);
}

/* ── Pulse doré avatar tour actif ── */
@keyframes sjAvatarPulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(234,179,8,0.55), 0 0 10px rgba(234,179,8,0.2); border-color: rgba(234,179,8,0.9); }
  50%     { box-shadow: 0 0 0 4px rgba(234,179,8,0), 0 0 16px rgba(234,179,8,0.35); border-color: rgba(234,179,8,0.5); }
}
.skyjo-avatar.active-turn {
  border-color: #fbbf24 !important;
  transform: scale(1.12);
  animation: sjAvatarPulse 1.8s ease-in-out infinite;
}

/* Bulles présence */
.skyjo-player-bubble {
  display: flex; flex-direction: row; align-items: center; gap: 10px;
  background: var(--s1); border: 1px solid var(--border); border-radius: 14px; padding: 12px 18px;
}
.skyjo-presence-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--muted); transition: background 0.3s; flex-shrink: 0; }
.skyjo-presence-dot.online { background: #22c55e; box-shadow: 0 0 6px rgba(34,197,94,0.5); animation: presencePulse 2s ease-in-out infinite; }
@keyframes presencePulse { 0%,100%{opacity:1} 50%{opacity:0.6} }

/* ══ SKYJO — Pause animations quand page cachée ══ */
body.skyjo-bg-paused #skyjoView .skyjo-avatar.active-turn,
body.skyjo-bg-paused #skyjoView .skyjo-presence-dot.online,
body.skyjo-bg-paused #skyjoView .skyjo-player-zone.active-zone::before,
body.skyjo-bg-paused #skyjoView .skyjo-player-zone.zone-me.active-zone::before,
body.skyjo-bg-paused #skyjoView .skyjo-player-zone.zone-opp.active-zone::before,
body.skyjo-bg-paused #skyjoView .skyjo-card,
body.skyjo-bg-paused #skyjoView #skyjoTurnBanner,
body.skyjo-bg-paused #skyjoView #skyjoDeckCard,
body.skyjo-bg-paused #skyjoView #skyjoDiscardCard {
  animation-play-state: paused !important;
  transition: none !important;
}
/* Stoppe aussi les particules volantes clones */
body.skyjo-bg-paused .sj-fly-clone,
body.skyjo-bg-paused .sj-particle {
  animation-play-state: paused !important;
}

/* ══════════════════════════════════════════════════
   SKYJO — ANIMATIONS ENRICHIES v3
══════════════════════════════════════════════════ */

/* ── Rebond sur la pioche après tirage ── */
@keyframes sjDeckBounce {
  0%   { transform: scale(1) translateY(0); }
  25%  { transform: scale(0.88) translateY(3px) rotateZ(2deg); }
  55%  { transform: scale(1.06) translateY(-2px) rotateZ(-1deg); }
  80%  { transform: scale(0.98) translateY(0px); }
  100% { transform: scale(1) translateY(0); }
}
#skyjoDeckCard.sj-deck-draw-anim {
  animation: sjDeckBounce 0.4s cubic-bezier(.4,0,.2,1);
  pointer-events: none;
}

/* ── Cartes volantes clones (Web Animations API) ── */
.sj-fly-clone {
  box-shadow: 0 14px 40px rgba(0,0,0,0.65), 0 0 0 1.5px rgba(255,255,255,0.14) !important;
  filter: brightness(1.08);
}
.sj-fly-clone::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 45%;
  background: linear-gradient(180deg, rgba(255,255,255,0.18) 0%, transparent 100%);
  border-radius: inherit;
  pointer-events: none;
  z-index: 1;
}

/* ── Apparition carte en main ── */
@keyframes sjHeldAppear {
  0%   { transform: scale(0.55) translateY(-16px) rotateZ(-18deg); opacity: 0; filter: brightness(0.7); }
  55%  { transform: scale(1.12) translateY(3px) rotateZ(4deg); opacity: 1; filter: brightness(1.2); }
  80%  { transform: scale(0.97) translateY(0) rotateZ(-1deg); }
  100% { transform: scale(1) translateY(0) rotateZ(0); opacity: 1; filter: brightness(1); }
}
#skyjoHeldCard.sj-held-appear {
  animation: sjHeldAppear 0.42s cubic-bezier(.17,.89,.32,1.28) forwards !important;
}

/* ── Atterrissage carte sur grille (pop-in) ── */
@keyframes sjCardLand {
  0%   { transform: scale(0.68) translateY(-18px) rotateZ(-10deg); opacity: 0.4; filter: brightness(1.4); }
  45%  { transform: scale(1.12) translateY(3px) rotateZ(3deg); opacity: 1; filter: brightness(1.2); }
  70%  { transform: scale(0.96) translateY(0px) rotateZ(-1.5deg); filter: brightness(1); }
  88%  { transform: scale(1.02) translateY(0px) rotateZ(0.5deg); }
  100% { transform: scale(1) translateY(0px) rotateZ(0deg); filter: brightness(1); }
}
.skyjo-card.sj-card-land {
  animation: sjCardLand 0.44s cubic-bezier(.17,.89,.32,1.28) forwards;
}

/* ── Suppression colonne complète ── */
@keyframes sjColRemove {
  0%   { transform: scale(1) translateY(0) rotateZ(0deg); opacity: 1; }
  20%  { transform: scale(1.12) translateY(-5px) rotateZ(-3deg); opacity: 1;
         box-shadow: 0 0 0 3px #fbbf24, 0 0 24px rgba(251,191,36,0.7); filter: brightness(1.3); }
  100% { transform: scale(0) translateY(24px) rotateZ(18deg); opacity: 0; filter: brightness(0.8); }
}
.skyjo-card.sj-col-remove {
  animation: sjColRemove 0.5s cubic-bezier(.4,0,1,1) forwards;
}

/* ── Défausse : slide-in ── */
@keyframes sjDiscardSlideIn {
  0%   { transform: translateY(-14px) scale(0.82) rotateZ(10deg); opacity: 0; filter: brightness(1.3); }
  50%  { transform: translateY(3px) scale(1.08) rotateZ(-3deg); opacity: 1; filter: brightness(1.15); }
  75%  { transform: translateY(-1px) scale(1.01) rotateZ(1deg); }
  100% { transform: translateY(0) scale(1) rotateZ(0deg); opacity: 1; filter: brightness(1); }
}
#skyjoDiscardCard.sj-discard-slide {
  animation: sjDiscardSlideIn 0.38s cubic-bezier(.17,.89,.32,1.28) forwards;
}

/* ── Halo vert après placement ── */
@keyframes sjPlaceGlow {
  0%   { box-shadow: 0 0 0 0 rgba(0,229,189,0.9), var(--sj-shadow); }
  40%  { box-shadow: 0 0 0 9px rgba(0,229,189,0), var(--sj-shadow-hover); }
  100% { box-shadow: var(--sj-shadow); }
}
.skyjo-card.sj-place-glow {
  animation: sjPlaceGlow 0.58s ease-out forwards;
}

/* ── Shake (feedback d'erreur) ── */
@keyframes sjShake {
  0%,100% { transform: translateX(0) rotateZ(0deg); }
  15%     { transform: translateX(-6px) rotateZ(-4deg); }
  35%     { transform: translateX(6px) rotateZ(4deg); }
  55%     { transform: translateX(-4px) rotateZ(-2.5deg); }
  75%     { transform: translateX(4px) rotateZ(2.5deg); }
}
.sj-shake { animation: sjShake 0.38s ease; }

/* ── Bannière tour : slide-in dramatique ── */
@keyframes sjBannerMyTurn {
  0%   { transform: translateY(-110%) scaleX(0.94); opacity: 0; }
  55%  { transform: translateY(2px) scaleX(1.005); opacity: 1; }
  100% { transform: translateY(0) scaleX(1); opacity: 1; }
}
@keyframes sjBannerTheirTurn {
  0%   { transform: translateY(-80%) scaleX(0.96); opacity: 0; }
  60%  { transform: translateY(1px) scaleX(1); opacity: 1; }
  100% { transform: translateY(0) scaleX(1); opacity: 1; }
}
#skyjoTurnBanner.sj-banner-enter {
  animation: sjBannerMyTurn 0.32s cubic-bezier(.17,.89,.32,1.18) forwards;
}
#skyjoTurnBanner.sj-banner-enter-opp {
  animation: sjBannerTheirTurn 0.28s cubic-bezier(.4,0,.2,1) forwards;
}

/* ── Particules colonne complète ── */
.sj-particle {
  position: fixed;
  pointer-events: none;
  font-size: 16px;
  z-index: 9998;
  animation: sjParticleFly 1s ease-out forwards;
  will-change: transform, opacity;
}
@keyframes sjParticleFly {
  0%   { transform: translate(0,0) scale(1.2) rotateZ(0deg); opacity: 1; }
  100% { transform: translate(var(--px), var(--py)) scale(0.2) rotateZ(var(--pr)); opacity: 0; }
}

/* ── Pile pioche : profondeur 3D ── */
#skyjoDeckCard {
  position: relative;
  transition: transform 0.2s cubic-bezier(.17,.89,.32,1.28), box-shadow 0.2s;
}
#skyjoDeckCard::before,
#skyjoDeckCard::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: var(--sj-radius);
  pointer-events: none;
}
#skyjoDeckCard::before {
  background: #163d28;
  transform: translate(-2.5px, 3.5px);
  z-index: -1;
  opacity: 0.75;
}
#skyjoDeckCard::after {
  background: #0f2e1e;
  transform: translate(-5px, 7px);
  z-index: -2;
  opacity: 0.45;
}
#skyjoDeckCard:hover {
  transform: translateY(-4px) scale(1.05);
  box-shadow: 0 12px 28px rgba(0,0,0,0.55), 0 0 0 2px rgba(0,229,189,0.25);
}
#skyjoDeckCard:active {
  transform: translateY(-1px) scale(0.97);
  box-shadow: var(--sj-shadow);
}

/* ── Défausse : hover ── */
#skyjoDiscardCard {
  transition: transform 0.2s cubic-bezier(.17,.89,.32,1.28), box-shadow 0.2s;
}
#skyjoDiscardCard:hover {
  transform: translateY(-4px) scale(1.05);
  box-shadow: 0 12px 28px rgba(0,0,0,0.5), 0 0 0 2px rgba(255,255,255,0.12);
}
#skyjoDiscardCard:active {
  transform: translateY(-1px) scale(0.97);
}

/* ── Pulse pioche/défausse : indique que c'est sélectionnable ── */
@keyframes sjSelectPulseDeck {
  0%,100% {
    transform: translateY(0) scale(1);
    box-shadow: var(--sj-shadow), 0 0 0 0 rgba(0,229,189,0.7);
  }
  50% {
    transform: translateY(-3px) scale(1.045);
    box-shadow: var(--sj-shadow-hover), 0 0 0 7px rgba(0,229,189,0);
  }
}
@keyframes sjSelectPulseDiscard {
  0%,100% {
    transform: translateY(0) scale(1);
    box-shadow: var(--sj-shadow), 0 0 0 0 rgba(255,200,80,0.7);
  }
  50% {
    transform: translateY(-3px) scale(1.045);
    box-shadow: var(--sj-shadow-hover), 0 0 0 7px rgba(255,200,80,0);
  }
}
#skyjoDeckCard.sj-selectable {
  animation: sjSelectPulseDeck 1.4s ease-in-out infinite;
  outline: 2px solid rgba(0,229,189,0.55);
  outline-offset: 3px;
}
#skyjoDiscardCard.sj-selectable {
  animation: sjSelectPulseDiscard 1.4s ease-in-out infinite 0.2s;
  outline: 2px solid rgba(255,200,80,0.55);
  outline-offset: 3px;
}
/* Stoppe le pulse si page cachée */
body.skyjo-bg-paused #skyjoDeckCard.sj-selectable,
body.skyjo-bg-paused #skyjoDiscardCard.sj-selectable {
  animation-play-state: paused !important;
}

/* ── HeldCardWrap transition ── */
#skyjoHeldCardWrap {
  transition: opacity 0.24s cubic-bezier(.4,0,.2,1), transform 0.24s cubic-bezier(.4,0,.2,1);
}

/* ── Round end : pop-in cinématique ── */
@keyframes sjRoundEndPop {
  0%   { transform: scale(0.45) rotateZ(-10deg) translateY(20px); opacity: 0; }
  60%  { transform: scale(1.15) rotateZ(2deg) translateY(-3px); opacity: 1; }
  80%  { transform: scale(0.97) rotateZ(-1deg); }
  100% { transform: scale(1) rotateZ(0deg) translateY(0); opacity: 1; }
}
#skyjoRoundEnd #skyjoRoundEndEmoji {
  display: block;
  animation: sjRoundEndPop 0.52s cubic-bezier(.17,.89,.32,1.28) both;
  animation-delay: 0.08s;
}
#skyjoRoundEnd #skyjoRoundEndTitle {
  animation: sjRoundEndPop 0.52s cubic-bezier(.17,.89,.32,1.28) both;
  animation-delay: 0.2s;
  opacity: 0;
}

/* ── Spinner RPC (discret, coin bas-droite) ── */
@keyframes sjRpcSpinner {
  to { transform: rotate(360deg); }
}
#sjLoadingOverlay {
  display: none; position: absolute; inset: 0; z-index: 800;
  background: transparent; pointer-events: none;
}
#sjLoadingOverlay.visible {
  display: block; pointer-events: all;
}
#sjLoadingDot {
  position: absolute; bottom: 14px; right: 14px;
  width: 20px; height: 20px;
  border: 2.5px solid rgba(255,255,255,0.08);
  border-top-color: var(--green);
  border-radius: 50%;
  animation: sjRpcSpinner 0.65s linear infinite;
  box-shadow: 0 0 10px rgba(0,201,167,0.3);
}

.pendu-svg{display:block;margin:0 auto 8px;}
.pendu-word{display:flex;gap:7px;justify-content:center;flex-wrap:wrap;margin:14px 0;}
.pendu-letter{width:26px;height:34px;border-bottom:2px solid var(--text);display:flex;align-items:flex-end;justify-content:center;font-size:17px;font-weight:700;color:var(--text);text-transform:uppercase;}
.pendu-keyboard{display:flex;flex-wrap:wrap;gap:5px;justify-content:center;margin:12px 0;}
.pendu-key{width:30px;height:34px;border-radius:6px;border:1px solid var(--border);background:var(--s2);color:var(--text);font-size:12px;font-weight:600;font-family:'DM Sans',sans-serif;cursor:pointer;transition:background 0.1s;display:flex;align-items:center;justify-content:center;text-transform:uppercase;}
.pendu-key:hover:not(.used){background:var(--s3);}
.pendu-key.correct{background:rgba(0,201,167,0.2);border-color:var(--green);color:var(--green);}
.pendu-key.wrong{background:rgba(220,50,50,0.15);border-color:#e05555;color:#e05555;}
.pendu-key.used{opacity:0.35;cursor:default;}
.pendu-hint{font-size:12px;color:var(--muted);text-align:center;font-style:italic;margin:4px 0 8px;}
.pendu-errors{font-size:12px;color:#e05555;text-align:center;font-weight:600;margin-bottom:6px;}
.pendu-result{text-align:center;padding:16px 0;}
.pendu-result-emoji{font-size:44px;display:block;margin-bottom:8px;}
.pendu-word-reveal{font-size:18px;font-weight:700;color:var(--green);text-transform:uppercase;letter-spacing:3px;margin:8px 0;}

/* ════ PUZZLE ════ */
.puzzle-grid{display:grid;gap:2px;margin:12px auto;background:var(--border);border-radius:8px;overflow:hidden;border:1px solid var(--border);}
.puzzle-piece{background-size:cover;cursor:pointer;transition:box-shadow 0.1s;position:relative;}
.puzzle-piece.selected{box-shadow:0 0 0 3px #3d9bd4 inset;z-index:3;}
.puzzle-piece.correct-pos{box-shadow:0 0 0 2px var(--green) inset;}
.puzzle-moves{font-size:12px;color:var(--sub);text-align:center;margin-bottom:6px;}
.puzzle-size-btns{display:flex;gap:8px;justify-content:center;margin:10px 0;}
.puzzle-size-btn{padding:7px 16px;border-radius:20px;border:1px solid var(--border);background:var(--s2);color:var(--sub);font-size:12px;font-weight:600;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all 0.15s;}
.puzzle-size-btn.active{background:rgba(61,155,212,0.15);color:#3d9bd4;border-color:rgba(61,155,212,0.40);}

/* ════ SNAKE ════ */
#snakeCanvas{display:block;margin:10px auto;border-radius:10px;border:1px solid var(--border);touch-action:none;}
.snake-score-bar{display:flex;justify-content:space-around;align-items:center;padding:0 4px;margin-bottom:6px;}
.snake-stat{text-align:center;}
.snake-stat-num{font-size:20px;font-weight:700;color:#3d9bd4;display:block;}
.snake-stat-lbl{font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;}
.snake-dpad{display:flex;flex-direction:column;align-items:center;gap:5px;margin:14px auto 0;width:fit-content;}
.snake-dpad-row{display:flex;gap:5px;justify-content:center;}
.snake-btn{width:60px;height:60px;border-radius:12px;background:var(--s2);border:1px solid var(--border);color:var(--text);font-size:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;user-select:none;-webkit-tap-highlight-color:transparent;touch-action:manipulation;transition:background 0.1s,transform 0.08s;}
.snake-btn:active{background:var(--s3);transform:scale(0.92);}
.snake-btn-center{background:transparent;border-color:transparent;pointer-events:none;}
.snake-wrap{position:relative;width:fit-content;margin:0 auto;}
.snake-overlay{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;background:rgba(0,0,0,0.72);border-radius:10px;}
.snake-overlay-title{font-family:'Playfair Display',serif;font-size:20px;font-weight:700;color:#fff;}
.snake-overlay-sub{font-size:12px;color:rgba(255,255,255,0.6);text-align:center;}
.snake-overlay-btn{padding:11px 28px;background:#3d9bd4;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:700;font-family:'DM Sans',sans-serif;cursor:pointer;}
.game-start-btn{padding:7px 16px;background:rgba(61,155,212,0.20);color:#3d9bd4;border:1.5px solid rgba(61,155,212,0.45);border-radius:50px;font-size:11px;font-weight:700;font-family:'DM Sans',sans-serif;cursor:pointer;transition:background 0.15s,transform 0.12s;}
.game-start-btn:hover{background:rgba(61,155,212,0.32);transform:scale(1.05);}

/* ════ MINI PLAYER ════ */
#miniPlayer {
  position: fixed;
  bottom: var(--nav-height); /* au-dessus de la bottom-nav, inclut déjà safe-area */
  left: 0; width: 100%;
  z-index: 999;
  transform: translateY(100%);
  transition: transform 0.35s cubic-bezier(.4,0,.2,1), opacity 0.35s;
  opacity: 0;
  pointer-events: none;
}
#miniPlayer.visible {
  transform: translateY(0);
  opacity: 1;
  pointer-events: all;
}
#miniPlayer.game-hidden {
  transform: translateY(100%);
  opacity: 0;
  pointer-events: none;
}
#miniPlayer.tab-hidden {
  transform: translateY(100%);
  opacity: 0;
  pointer-events: none;
}

/* ── Notif message fixe — visible tous onglets ── */
@keyframes msgPillIn {
  0%   { opacity: 0; transform: translateX(-50%) translateY(-20px) scale(0.92); }
  65%  { opacity: 1; transform: translateX(-50%) translateY(4px) scale(1.03); }
  100% { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
}
@keyframes msgPillOut {
  0%   { opacity: 1; transform: translateX(-50%) translateY(0) scale(1); }
  100% { opacity: 0; transform: translateX(-50%) translateY(-16px) scale(0.93); }
}
@keyframes msgPillPulse {
  0%,100% { box-shadow: 0 4px 20px rgba(0,0,0,0.4), 0 0 0 0 rgba(0,201,167,0.35); }
  50%     { box-shadow: 0 4px 24px rgba(0,0,0,0.5), 0 0 0 6px rgba(0,201,167,0); }
}
#msgHeaderPill {
  display: none;
  position: fixed;
  top: calc(var(--safe-top) + 110px);
  left: 50%;
  transform: translateX(-50%);
  z-index: 5501;
  align-items: center;
  gap: 9px;
  padding: 9px 16px 9px 10px;
  background: var(--s1);
  border: 1px solid rgba(0,201,167,0.35);
  border-radius: 50px;
  cursor: pointer;
  max-width: min(300px, calc(100vw - 32px));
  min-width: 200px;
  animation: msgPillIn 0.42s cubic-bezier(.34,1.56,.64,1) forwards,
             msgPillPulse 1.8s ease-in-out 0.45s infinite;
  -webkit-tap-highlight-color: transparent;
  pointer-events: all;
}
#msgHeaderPill.hiding {
  animation: msgPillOut 0.28s ease-in forwards !important;
}
#msgHeaderPill:active { filter: brightness(1.1); }
/* Opacification plein écran pendant la notif */
#msgPillOverlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0);
  z-index: 5500;
  pointer-events: none;
  transition: background 0.35s ease;
}
#msgPillOverlay.active {
  display: block;
  background: rgba(0,0,0,0.55);
}
body.msg-pill-active header {
  transition: opacity 0.4s ease;
}
header + div {
  transition: opacity 0.4s ease;
}
.mhp-avatar {
  font-size: 18px;
  width: 32px; height: 32px;
  background: var(--s2);
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  border: 1.5px solid rgba(0,201,167,0.3);
}
.mhp-content {
  flex: 1; min-width: 0;
}
.mhp-name {
  font-size: 10px;
  font-weight: 700;
  color: var(--green);
  letter-spacing: 0.5px;
  text-transform: uppercase;
  margin-bottom: 2px;
}
.mhp-text {
  font-size: 12px;
  font-weight: 500;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.mhp-arrow {
  font-size: 16px;
  color: var(--green);
  flex-shrink: 0;
  font-weight: 700;
}
body.light #msgHeaderPill {
  border-color: rgba(200,24,94,0.35);
  animation: msgPillIn 0.42s cubic-bezier(.34,1.56,.64,1) forwards,
             msgPillPulseLight 1.8s ease-in-out 0.45s infinite;
}
@keyframes msgPillPulseLight {
  0%,100% { box-shadow: 0 4px 20px rgba(180,20,80,0.15), 0 0 0 0 rgba(200,24,94,0.3); }
  50%     { box-shadow: 0 4px 24px rgba(180,20,80,0.22), 0 0 0 6px rgba(200,24,94,0); }
}
@keyframes navMusicBounce {
  0%   { transform: translateY(0) rotate(0deg) scale(1); }
  20%  { transform: translateY(-3px) rotate(-8deg) scale(1.12); }
  40%  { transform: translateY(1px) rotate(6deg) scale(1.06); }
  60%  { transform: translateY(-2px) rotate(-5deg) scale(1.1); }
  80%  { transform: translateY(1px) rotate(4deg) scale(1.05); }
  100% { transform: translateY(0) rotate(0deg) scale(1); }
}
#navMusique.music-playing .nav-music-solo {
  animation: navMusicBounce 0.85s ease-in-out infinite;
  color: #f5c518;
  filter: drop-shadow(0 0 4px #f5c518);
}
#navMusique.music-playing {
  color: #f5c518;
}

/* ── Icone sync masquée par defaut ── */
#navMusique .nav-music-sync-icon { display: none; }
#navMusique .nav-music-solo      { display: block; }

/* ══════════════════════════════════════════
   MODE SYNC — les deux ecoutent de la musique
   .music-sync remplace .music-playing visuellement
══════════════════════════════════════════ */
#navMusique.music-sync .nav-music-solo      { display: none !important; animation: none !important; }
#navMusique.music-sync .nav-music-sync-icon { display: flex; align-items: flex-end; gap: 2px; height: 20px; }
#navMusique.music-sync                      { color: var(--muted); }
#navMusique.music-sync .nav-music-label     {
  background: linear-gradient(90deg, #e879a0, #5b9cf6);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-weight: 700;
}

/* Note rose (girl) — bounce phase 0 */
@keyframes navNoteBounceGirl {
  0%   { transform: translateY(0px)   rotate(-6deg)  scale(1);    }
  18%  { transform: translateY(-5px)  rotate(-12deg) scale(1.18); }
  36%  { transform: translateY(1px)   rotate(-3deg)  scale(1.06); }
  54%  { transform: translateY(-3px)  rotate(-9deg)  scale(1.13); }
  72%  { transform: translateY(0px)   rotate(-5deg)  scale(1.05); }
  100% { transform: translateY(0px)   rotate(-6deg)  scale(1);    }
}
/* Note bleue (boy) — bounce dephasage 0.25s → dansent en alternance */
@keyframes navNoteBounceboy {
  0%   { transform: translateY(0px)   rotate(6deg)   scale(1);    }
  18%  { transform: translateY(1px)   rotate(3deg)   scale(1.05); }
  36%  { transform: translateY(-5px)  rotate(12deg)  scale(1.18); }
  54%  { transform: translateY(0px)   rotate(5deg)   scale(1.06); }
  72%  { transform: translateY(-3px)  rotate(9deg)   scale(1.13); }
  100% { transform: translateY(0px)   rotate(6deg)   scale(1);    }
}
#navMusique.music-sync .nav-note-girl {
  color: #e879a0;
  filter: drop-shadow(0 0 5px rgba(232,121,160,0.8)) drop-shadow(0 0 10px rgba(232,121,160,0.4));
  animation: navNoteBounceGirl 0.9s ease-in-out infinite;
  transform-origin: bottom center;
}
#navMusique.music-sync .nav-note-boy {
  color: #5b9cf6;
  filter: drop-shadow(0 0 5px rgba(91,156,246,0.8)) drop-shadow(0 0 10px rgba(91,156,246,0.4));
  animation: navNoteBounceboy 0.9s ease-in-out infinite;
  transform-origin: bottom center;
  animation-delay: 0.25s;
}
body.light #navMusique.music-sync .nav-note-girl { filter: drop-shadow(0 0 4px rgba(200,50,120,0.7)); }
body.light #navMusique.music-sync .nav-note-boy  { filter: drop-shadow(0 0 4px rgba(37,99,235,0.7)); }

/* ── Cœur doré pulsant sur navNous pendant l'événement temporaire ── */
@keyframes navNousPulse {
  0%   { transform: scale(1);    filter: drop-shadow(0 0 2px #f5c518); }
  30%  { transform: scale(1.28); filter: drop-shadow(0 0 7px #f5c518) drop-shadow(0 0 14px rgba(245,197,24,0.5)); }
  50%  { transform: scale(1.10); filter: drop-shadow(0 0 4px #f5c518); }
  70%  { transform: scale(1.22); filter: drop-shadow(0 0 6px #f5c518) drop-shadow(0 0 10px rgba(245,197,24,0.4)); }
  100% { transform: scale(1);    filter: drop-shadow(0 0 2px #f5c518); }
}
#navNous.event-active svg {
  animation: navNousPulse 1.2s ease-in-out infinite;
  color: #f5c518;
}
#navNous.event-active {
  color: #f5c518;
}

/* ── Badge non-lus sur l'icône Messages ── */
@keyframes navMsgDotPulse {
  0%,100% { transform: scale(1);    box-shadow: 0 0 0 0 rgba(255,68,68,0.5); }
  50%     { transform: scale(1.15); box-shadow: 0 0 0 4px rgba(255,68,68,0); }
}
#navMessages {
  position: relative;
}
#navMsgBadge {
  display: none;
  position: absolute;
  top: -1px; right: 2px;
  min-width: 16px; height: 16px;
  background: #ff4444;
  color: #fff;
  font-size: 9px; font-weight: 800;
  border-radius: 8px;
  align-items: center; justify-content: center;
  padding: 0 4px;
  border: 1.5px solid var(--bg);
  line-height: 1;
  animation: navMsgDotPulse 1.4s ease-in-out infinite;
  pointer-events: none;
}
#navMsgBadge.visible {
  display: flex;
}
#navMessages.has-unread svg {
  color: #ff6b6b;
  filter: drop-shadow(0 0 3px rgba(255,68,68,0.5));
}
.mp-inner {
  margin: 0 8px;
  background: rgba(18,18,18,0.98);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 14px;
  padding: 8px 10px;
  display: flex;
  align-items: center;
  gap: 9px;
  box-shadow: 0 -4px 24px rgba(0,0,0,0.5);
}
body.light .mp-inner {
  background: rgba(255,245,250,0.94);
  border-color: rgba(200,24,94,0.22);
  box-shadow: 0 -4px 24px rgba(180,20,80,0.14), 0 -1px 8px rgba(200,24,94,0.08);
}
.mp-info {
  flex: 1;
  min-width: 0;
}
.mp-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.mp-artist {
  font-size: 10px;
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin-top: 1px;
}
.mp-controls {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
}
.mp-btn {
  height: 30px;
  padding: 0 10px;
  border-radius: 20px;
  border: none;
  background: transparent;
  color: var(--text);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background 0.15s, transform 0.12s;
  flex-shrink: 0;
}
.mp-btn:hover { background: rgba(255,255,255,0.1); transform: scale(1.08); }
body.light .mp-btn:hover { background: rgba(200,24,94,0.09); }
.mp-btn-play {
  width: 38px; height: 38px;
  background: var(--green);
  color: #000;
  border-radius: 50%;
}
.mp-btn-play:hover { background: var(--green2); }
.mp-btn-mode.active { color: var(--green); }
.mp-btn-stop { color: var(--muted); }
.mp-btn-stop:hover { color: #e05555 !important; background: rgba(220,50,50,0.1) !important; }
/* SVG icons inside mp buttons */
.mp-btn svg { width: 16px; height: 16px; }
.mp-btn-play svg { width: 18px; height: 18px; }

/* Progress bar mini player */
.mp-progress-wrap {
  display: flex; align-items: center; gap: 7px; margin-top: 5px;
}
.mp-seek {
  flex: 1; height: 3px; background: rgba(255,255,255,0.15);
  border-radius: 3px; position: relative; cursor: pointer;
  touch-action: none;
}
body.light .mp-seek { background: rgba(0,0,0,0.12); }
.mp-seek-fill {
  height: 100%; border-radius: 3px;
  background: var(--green); width: 0%;
  pointer-events: none; transition: none;
  will-change: width;
}
.mp-seek-thumb {
  position: absolute; top: 50%; right: -5px;
  transform: translateY(-50%) scale(0);
  width: 10px; height: 10px; border-radius: 50%;
  background: var(--green);
  transition: transform 0.15s;
  pointer-events: none;
}
.mp-seek:hover .mp-seek-thumb,
.mp-seek.dragging .mp-seek-thumb { transform: translateY(-50%) scale(1); }
.mp-seek.dragging .mp-seek-fill { transition: none; }
.mp-time {
  font-size: 9px; color: var(--muted); flex-shrink: 0;
  font-variant-numeric: tabular-nums; letter-spacing: 0.3px;
}

/* Pendu theme label */
.pendu-theme {
  font-size: 11px;
  font-weight: 700;
  color: var(--green);
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  margin-bottom: 4px;
  padding: 4px 10px;
  background: rgba(0,201,167,0.08);
  border: 1px solid rgba(0,201,167,0.18);
  border-radius: 20px;
  display: inline-block;
}
body.light .pendu-theme {
  color: var(--green);
  background: rgba(200,24,94,0.07);
  border-color: rgba(200,24,94,0.2);
}
.pendu-theme-wrap {
  text-align: center;
  margin: 8px 0 4px;
}

/* ════════════════════════════════════════════
   INSTALOVE — Messagerie privée
════════════════════════════════════════════ */

#hiddenPage {
  display: none; position: fixed;
  top: 0; left: 0; right: 0;
  bottom: var(--nav-height);
  z-index: 1100;
  overflow: hidden; background: var(--bg);
  flex-direction: column; transition: background 0.3s;
  overscroll-behavior-x: none; touch-action: pan-y;
}
#hiddenPage.active { display: flex; animation: slideUp 0.3s ease; }

/* Fond opaque sous hiddenPage pour couvrir la nav quand le clavier est ouvert */
#dmKeyboardBg {
  display: none; position: fixed;
  left: 0; right: 0; bottom: 0;
  height: var(--nav-height);
  background: var(--bg); z-index: 1099;
  pointer-events: none;
}
#dmKeyboardBg.on { display: block; }

/* Topbar */
.dm-topbar {
  width: 100%;
  /* La hauteur s'adapte à la safe-area-inset-top (Dynamic Island) */
  height: calc(56px + var(--safe-top));
  min-height: calc(56px + var(--safe-top));
  flex-shrink: 0;
  display: flex; align-items: flex-end; gap: 6px;
  padding: 0 10px;
  padding-top: var(--safe-top);
  padding-bottom: 8px;
  background: var(--bg); border-bottom: 1px solid var(--border);
  z-index: 10; transition: background 0.3s, border-color 0.3s;
}
.dm-topbar-back {
  /* remplacé par .gv-back — conservé pour compatibilité */
  display: none;
}
/* Adapter gv-back dans la topbar InstaLove */
#dmTopbar .gv-back {
  flex-shrink: 0;
  margin-right: 4px;
}
.dm-topbar-center { flex: 1; display: flex; align-items: center; gap: 8px; min-width: 0; overflow: hidden; }
.dm-topbar-right { display: flex; align-items: center; gap: 6px; flex-shrink: 0; }
.dm-topbar-logo-txt {
  font-family: 'Playfair Display', serif; font-size: 18px; font-weight: 700;
  background: linear-gradient(90deg, #f9ce34, #ee2a7b 50%, #405de6);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.dm-topbar-title { font-size: 14px; font-weight: 700; color: var(--text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.dm-topbar-sub { font-size: 10px; color: var(--muted); }
.dm-topbar-avatars { display: flex; }
.dm-topbar-avatars .dm-avatar { width: 28px; height: 28px; font-size: 10px; border: 2px solid var(--bg); }
.dm-topbar-avatars .dm-avatar:last-child { margin-left: -8px; }
.dm-topbar-names { display: flex; flex-direction: column; gap: 1px; }

/* Profile pill */
.dm-topbar-profile {
  display: flex; align-items: center; gap: 6px;
  padding: 6px 13px 6px 7px; border-radius: 22px;
  border: 1.5px solid var(--border); background: var(--s1);
  cursor: pointer; transition: background 0.15s, border-color 0.15s, box-shadow 0.15s;
  box-shadow: 0 2px 10px rgba(0,0,0,0.18);
}
.dm-topbar-profile:hover { background: var(--s2); box-shadow: 0 4px 16px rgba(0,0,0,0.25); }
.dm-tp-avatar {
  width: 26px; height: 26px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 9px; font-weight: 800; color: #fff; flex-shrink: 0;
}
.dm-tp-avatar.girl { background: linear-gradient(135deg, #f472b6, #c8185e); }
.dm-tp-avatar.boy  { background: linear-gradient(135deg, #60a5fa, #3b82f6); }
.dm-tp-name { font-size: 14px; font-weight: 700; color: var(--text); letter-spacing: 0.2px; }
.dm-tp-chevron { color: var(--muted); }
.dm-topbar-theme {
  width: 36px; height: 36px; border-radius: 50%; border: none;
  background: transparent; color: var(--muted); cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.15s, color 0.15s;
}
.dm-topbar-theme:hover { background: var(--s2); color: var(--text); }

/* Avatars */
.dm-avatar {
  width: 36px; height: 36px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; font-weight: 800; flex-shrink: 0; border: 2px solid var(--bg);
}
.dm-avatar-girl { background: linear-gradient(135deg, #f472b6, #c8185e); color: #fff; box-shadow: 0 2px 8px rgba(200,24,94,0.3); }
.dm-avatar-boy  { background: linear-gradient(135deg, #60a5fa, #3b82f6); color: #fff; box-shadow: 0 2px 8px rgba(59,130,246,0.3); }

/* Screens */
.dm-screen {
  position: absolute; inset: 0;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  overflow: hidden; width: 100%; background: var(--bg);
}
.dm-chat-screen { justify-content: flex-start; overflow: hidden; align-items: stretch; }

/* Home */
.dm-home-inner {
  width: 100%; max-width: 360px;
  display: flex; flex-direction: column; align-items: center;
  padding: 12px 24px 48px;
  animation: dmUp 0.4s cubic-bezier(.4,0,.2,1);
}
@keyframes dmUp { from { opacity:0; transform:translateY(24px); } to { opacity:1; transform:none; } }
.dm-home-logo-wrap {
  position: relative; width: 110px; height: 110px;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; margin-bottom: 16px; transition: transform 0.2s;
}
.dm-home-logo-wrap:hover { transform: scale(1.05); }
.dm-home-logo-bg {
  position: absolute; inset: 0; border-radius: 28px;
  background: linear-gradient(135deg, #f9ce34, #ee2a7b 40%, #9b59b6 75%, #405de6);
  box-shadow: 0 8px 32px rgba(238,42,123,0.4), 0 2px 8px rgba(64,93,230,0.25);
  animation: dmLogoPulse 3s ease-in-out infinite;
}
@keyframes dmLogoPulse {
  0%,100% { opacity: 0.88; }
  50%     { opacity: 1; }
}
.dm-home-logo-icon { position: relative; z-index: 1; width: 54px; height: 54px; }
.dm-home-appname {
  font-family: 'Playfair Display', serif; font-size: 30px; font-weight: 700;
  background: linear-gradient(90deg, #f9ce34, #ee2a7b 50%, #405de6);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  margin-bottom: 4px;
}
.dm-home-tagline { font-size: 13px; color: var(--muted); margin-bottom: 28px; }
.dm-home-conv {
  width: 100%; background: var(--s1); border: 1px solid var(--border);
  border-radius: 18px; padding: 14px 16px;
  display: flex; align-items: center; gap: 12px;
  cursor: pointer; margin-bottom: 16px;
  transition: background 0.15s, transform 0.18s, border-color 0.15s;
}
.dm-home-conv:hover, .dm-home-conv:active { background: var(--s2); border-color: rgba(238,42,123,0.35); transform: scale(1.015); }
.dm-home-conv-avatars { display: flex; flex-shrink: 0; }
.dm-home-conv-avatars .dm-avatar { width: 44px; height: 44px; font-size: 16px; border: 2.5px solid var(--s1); }
.dm-home-conv-avatars .dm-avatar:last-child { margin-left: -12px; }
.dm-home-conv-info { flex: 1; min-width: 0; }
.dm-home-conv-name { font-size: 15px; font-weight: 700; color: var(--text); margin-bottom: 2px; }
.dm-home-conv-preview { font-size: 12px; color: var(--muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.dm-home-conv-meta { display: flex; flex-direction: column; align-items: flex-end; gap: 4px; flex-shrink: 0; }
.dm-home-conv-time { font-size: 10px; color: var(--muted); }
.dm-home-conv-badge {
  min-width: 18px; height: 18px; border-radius: 9px; padding: 0 5px;
  background: linear-gradient(135deg, #ee2a7b, #9b59b6);
  color: #fff; font-size: 10px; font-weight: 700;
  display: flex; align-items: center; justify-content: center;
}
.dm-home-footer { font-size: 11px; color: var(--muted); opacity: 0.55; }

/* Identity overlay (bottom sheet) */
.dm-id-overlay {
  position: absolute; inset: 56px 0 0 0; z-index: 20;
  background: transparent;
  display: flex; align-items: flex-start; justify-content: flex-end;
  padding-top: 8px; padding-right: 14px;
  animation: dmFadeIn 0.2s ease;
}
body.light .dm-id-overlay { background: transparent; }
.dm-id-modal {
  width: 200px;
  background: var(--s1); border: 1px solid var(--border); border-radius: 14px;
  padding: 12px 12px 10px;
  display: flex; flex-direction: column; align-items: center; gap: 8px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.35);
  animation: dmSlideUp 0.22s cubic-bezier(.4,0,.2,1);
}
@keyframes dmSlideUp { from { transform:translateY(40px); opacity:0; } to { transform:none; opacity:1; } }
.dm-id-title { font-family:'Playfair Display',serif; font-size:15px; font-weight:700; color:var(--text); }
.dm-id-sub { font-size:11px; color:var(--muted); text-align:center; }
.dm-id-btns { display:flex; gap:8px; width:100%; margin-top:2px; }
.dm-id-btn {
  flex:1; padding:10px 8px 8px; border-radius:12px;
  border:1.5px solid var(--border); background:var(--bg); cursor:pointer;
  display:flex; flex-direction:column; align-items:center; gap:5px;
  font-family:'DM Sans',sans-serif;
  transition:transform 0.18s cubic-bezier(.4,2,.55,.9), border-color 0.15s, background 0.15s;
}
.dm-id-btn:hover { transform:translateY(-3px); }
.dm-id-av { width:34px; height:34px; font-size:13px; border:none !important; }
.dm-id-name { font-size:12px; font-weight:700; color:var(--text); }
.dm-id-sub2 { font-size:10px; color:var(--muted); margin-top:-3px; }
.dm-id-girl:hover { border-color:#e879a0; background:rgba(232,121,160,0.08); }
.dm-id-boy:hover  { border-color:#60a5fa; background:rgba(96,165,250,0.08); }
.dm-id-btn.selected { border-width:2px; }
.dm-id-girl.selected { border-color:#c8185e; background:rgba(200,24,94,0.07); }
.dm-id-boy.selected  { border-color:#3b82f6; background:rgba(59,130,246,0.07); }

/* Chat */
.dm-messages {
  flex:1; overflow-y:auto; width:100%;
  /* padding-top = hauteur topbar (calc 56px + safe-top) + marge confort */
  padding: calc(var(--safe-top) + 56px + 12px) 12px 6px;
  display:flex; flex-direction:column;
  overscroll-behavior:contain;
}
.dm-messages::-webkit-scrollbar { width:3px; }
.dm-messages::-webkit-scrollbar-thumb { background:var(--s3); border-radius:3px; }
.dm-loading-msgs { display:flex; align-items:center; justify-content:center; flex:1; opacity:0.4; }
.dm-empty { flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px; padding:40px 20px; text-align:center; }
.dm-empty-icon { font-size:44px; opacity:0.35; }
.dm-empty-text { font-size:13px; color:var(--muted); line-height:1.5; }
.dm-day-label {
  text-align:center; font-size:10px; font-weight:600; color:var(--muted);
  text-transform:uppercase; letter-spacing:1.5px; padding:10px 0 14px;
}
.dm-spacer { height:8px; flex-shrink:0; }
.dm-msg-wrap {
  display:flex; align-items:flex-end; gap:6px; margin-bottom:2px;
  animation:dmMsgIn 0.22s cubic-bezier(.4,0,.2,1);
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}
.dm-msg-wrap.has-reaction { margin-bottom: 18px; }
@keyframes dmMsgIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:none; } }
.dm-msg-wrap.mine { flex-direction:row-reverse; }
.dm-msg-avatar { width:26px; height:26px; font-size:10px; flex-shrink:0; }
.dm-bubble {
  max-width:75%; padding:9px 13px; border-radius:20px;
  font-size:14px; line-height:1.5; word-break:break-word; position:relative;
}
.dm-msg-wrap:not(.mine) .dm-bubble { background:var(--s2); color:var(--text); border-radius:20px 20px 20px 4px; }
.dm-msg-wrap:not(.mine).first-in-group .dm-bubble { border-radius:4px 20px 20px 20px; }
.dm-msg-wrap.mine .dm-bubble {
  background:linear-gradient(145deg,#c8185e 0%,#e8507a 100%);
  color:#fff; border-radius:20px 20px 4px 20px;
  box-shadow:0 2px 12px rgba(200,24,94,0.3);
  text-shadow:0 1px 2px rgba(0,0,0,0.15);
}
body.light .dm-msg-wrap.mine .dm-bubble {
  background:linear-gradient(145deg,#b01050,#e8507a);
  box-shadow:0 2px 12px rgba(200,24,94,0.25);
}
.dm-msg-wrap.mine.first-in-group .dm-bubble { border-radius:20px 4px 20px 20px; }
.dm-bubble-text { display:block; letter-spacing:0.01em; }
.dm-bubble-meta { font-size:9px; margin-top:4px; text-align:right; opacity:0.7; display:none; }
.dm-msg-wrap.last-in-group .dm-bubble-meta { display:block; }
.dm-msg-wrap.mine .dm-bubble-meta { color:rgba(255,255,255,0.8); }
.dm-msg-wrap:not(.mine) .dm-bubble-meta { color:var(--muted); }
/* "Vu" Instagram-style */
.dm-seen-label {
  font-size: 10px; color: var(--muted);
  text-align: right; padding: 0 4px 4px;
  display: flex; align-items: center; justify-content: flex-end; gap: 4px;
  animation: dmMsgIn 0.2s ease;
}
.dm-seen-label .dm-seen-avatar {
  width: 14px; height: 14px; border-radius: 50%;
  font-size: 10px; display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}
body.light .dm-seen-label { color: var(--muted); }
.dm-react {
  position:absolute; bottom:-10px; font-size:13px;
  background:var(--s1); border:1px solid var(--border); border-radius:10px;
  padding:1px 4px; cursor:pointer; user-select:none; transition:transform 0.15s;
}
.dm-msg-wrap:not(.mine) .dm-react { right:-6px; }
.dm-msg-wrap.mine .dm-react { left:-6px; }
.dm-react:hover { transform:scale(1.25); }

/* ── Menu contextuel messages ── */
.dm-ctx-menu {
  position: fixed; z-index: 9999;
  background: var(--s1); border: 1px solid var(--border);
  border-radius: 16px; padding: 6px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.4);
  display: flex; flex-direction: column; gap: 2px;
  min-width: 160px;
  animation: dmSlideUp 0.18s cubic-bezier(.4,0,.2,1);
}
.dm-ctx-reactions {
  display: flex; gap: 4px; padding: 6px 8px 4px;
  border-bottom: 1px solid var(--border); margin-bottom: 2px;
  justify-content: space-around;
}
.dm-ctx-react-btn {
  font-size: 20px; cursor: pointer; padding: 4px;
  border-radius: 8px; transition: transform 0.15s, background 0.15s;
  user-select: none;
}
.dm-ctx-react-btn:hover { transform: scale(1.3); background: var(--s2); }
.dm-ctx-react-btn.active { transform: scale(1.15); background: var(--s2); }
.dm-ctx-item {
  display: flex; align-items: center; gap: 10px;
  padding: 9px 12px; border-radius: 10px;
  font-size: 13px; font-weight: 500; color: var(--text);
  cursor: pointer; transition: background 0.12s;
  user-select: none;
}
.dm-ctx-item:hover { background: var(--s2); }
.dm-ctx-item.danger { color: #ff4444; }
.dm-ctx-item.danger:hover { background: rgba(255,68,68,0.1); }
.dm-ctx-overlay {
  position: fixed; inset: 0; z-index: 9998;
}
/* Réaction affichée sur la bulle */
.dm-react {
  position: absolute; bottom: -12px;
  background: var(--s1); border: 1px solid var(--border);
  border-radius: 12px; padding: 2px 6px;
  font-size: 14px; cursor: pointer; user-select: none;
  transition: transform 0.15s; box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}
.dm-msg-wrap:not(.mine) .dm-react { right: -6px; }
.dm-msg-wrap.mine .dm-react { left: -6px; }
.dm-react:hover { transform: scale(1.25); }
/* Message supprimé */
.dm-bubble.deleted .dm-bubble-text {
  opacity: 0.4; font-style: italic;
}
.dm-input-bar {
  width:100%; flex-shrink:0;
  padding:10px 12px 10px;
  background:var(--bg); border-top:1px solid var(--border);
  position:relative; transition:background 0.3s;
}
.dm-input-wrap {
  display:flex; align-items:center; gap:8px;
  background:var(--s1); border:1.5px solid var(--border);
  border-radius:26px; padding:6px 6px 6px 10px;
  transition:border-color 0.2s,box-shadow 0.2s; position:relative;
}
.dm-input-wrap:focus-within { border-color:#833ab4; box-shadow:0 0 0 3px rgba(131,58,180,0.1); }
body.light .dm-input-wrap:focus-within { border-color:#c8185e; box-shadow:0 0 0 3px rgba(200,24,94,0.08); }
.dm-emoji-btn {
  width:32px; height:32px; border:none; background:transparent; color:var(--muted);
  cursor:pointer; border-radius:50%; flex-shrink:0;
  display:flex; align-items:center; justify-content:center; transition:color 0.15s,background 0.15s;
}
.dm-emoji-btn:hover,.dm-emoji-btn.open { color:var(--text); }
.dm-input {
  flex:1; border:none; background:transparent;
  font-family:'DM Sans',sans-serif; font-size:16px !important;
  color:var(--text); outline:none; caret-color:#ee2a7b; padding:2px 0;
}
.dm-input::placeholder { color:var(--muted); }
.dm-send-btn {
  width:36px; height:36px; border-radius:50%; border:none;
  background:linear-gradient(135deg,#833ab4,#fd1d1d,#fcb045);
  color:#fff; cursor:pointer; flex-shrink:0;
  display:flex; align-items:center; justify-content:center;
  opacity:0.35; transition:opacity 0.15s,transform 0.15s;
}
body.light .dm-send-btn { background:linear-gradient(135deg,#c8185e,#e879a0); }
.dm-send-btn.ready { opacity:1; }
.dm-send-btn.ready:hover { transform:scale(1.1); }
.dm-send-btn:active { transform:scale(0.92); }
/* ══ VOCAUX INSTALOVE ══ */
.dm-mic-btn {
  width:36px; height:36px; border-radius:50%; border:none;
  background:var(--s3); color:var(--muted);
  cursor:pointer; flex-shrink:0;
  display:flex; align-items:center; justify-content:center;
  transition:background 0.15s, color 0.15s, transform 0.15s;
  touch-action:none; user-select:none;
}
.dm-mic-btn:hover { background:var(--s2); color:var(--text); }
.dm-mic-btn.recording {
  background:linear-gradient(135deg,#e05555,#ff8c00);
  color:#fff; animation:micPulse 0.7s ease-in-out infinite;
}
@keyframes micPulse {
  0%,100% { transform:scale(1); box-shadow:0 0 0 0 rgba(224,85,85,0.4); }
  50%      { transform:scale(1.08); box-shadow:0 0 0 6px rgba(224,85,85,0); }
}
.dm-rec-indicator {
  display:none; align-items:center; gap:6px;
  font-size:11px; color:#e05555; font-weight:600;
  padding:0 8px;
}
.dm-rec-indicator.active { display:flex; }
.dm-rec-dot {
  width:7px; height:7px; border-radius:50%; background:#e05555;
  animation:recBlink 1s ease-in-out infinite;
}
@keyframes recBlink { 0%,100%{opacity:1} 50%{opacity:0.2} }

/* Bulle vocale */
.dm-audio-bubble {
  display:flex; align-items:center; gap:10px;
  padding:10px 14px; min-width:180px;
}
/* Bouton play — mes messages */
.dm-audio-play {
  width:34px; height:34px; border-radius:50%; border:none;
  background:rgba(255,255,255,0.2); color:#fff;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; flex-shrink:0; transition:transform 0.15s, background 0.15s;
}
.dm-audio-play:hover { background:rgba(255,255,255,0.32); transform:scale(1.08); }
/* Bouton play — messages reçus */
.dm-msg-wrap:not(.mine) .dm-audio-play {
  background:var(--s3); color:var(--text);
}
.dm-msg-wrap:not(.mine) .dm-audio-play:hover { background:var(--border); }
/* Barre de progression */
.dm-audio-bar {
  flex:1; height:4px; border-radius:4px;
  background:rgba(0,0,0,0.2); position:relative; cursor:pointer;
}
.dm-msg-wrap:not(.mine) .dm-audio-bar { background:rgba(131,58,180,0.25); }
.dm-audio-progress {
  height:100%; border-radius:4px; background:rgba(255,255,255,0.9);
  width:0%; transition:width 0.1s linear; pointer-events:none;
}
.dm-msg-wrap:not(.mine) .dm-audio-progress { background:#833ab4; }
/* Durée */
.dm-audio-dur {
  font-size:11px; font-weight:700; flex-shrink:0; min-width:30px;
  color:rgba(255,255,255,0.95);
}
.dm-msg-wrap:not(.mine) .dm-audio-dur { color:var(--text); }

.dm-emoji-picker {
  position:absolute; bottom:calc(100% + 10px); left:0; right:0;
  background:var(--s1); border:1px solid var(--border); border-radius:16px;
  padding:12px; display:none; flex-wrap:wrap; gap:6px; justify-content:center;
  box-shadow:0 8px 32px rgba(0,0,0,0.3); z-index:10;
}
.dm-emoji-picker.open { display:flex; }
.dm-emoji-picker span {
  font-size:22px; cursor:pointer; padding:4px; border-radius:8px;
  transition:transform 0.12s,background 0.1s; user-select:none;
}
.dm-emoji-picker span:hover { transform:scale(1.35); background:var(--s2); }

/* ══ NOUVELLES FEATURES INSTALOVE ══ */

/* Flash nouveau message */
@keyframes dmFlash {
  0%   { background: rgba(238,42,123,0.12); }
  100% { background: transparent; }
}
.dm-flash { animation: dmFlash 0.6s ease-out; }

/* Indicateur typing */
.dm-typing-wrap {
  display: flex; align-items: center; gap: 6px;
  padding: 8px 12px 4px; animation: dmMsgIn 0.2s ease;
}
.dm-typing-avatar { width: 26px; height: 26px; font-size: 14px; flex-shrink: 0; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
.dm-typing-bubble {
  background: var(--s2); border-radius: 20px 20px 20px 4px;
  padding: 10px 14px; display: flex; align-items: center; gap: 4px;
}
.dm-typing-dot {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--muted); opacity: 0.6;
  animation: dmTypingDot 1.2s ease-in-out infinite;
}
.dm-typing-dot:nth-child(2) { animation-delay: 0.2s; }
.dm-typing-dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes dmTypingDot {
  0%,60%,100% { transform: translateY(0); opacity: 0.4; }
  30%         { transform: translateY(-5px); opacity: 1; }
}

/* Reply preview dans la bulle */
.dm-reply-preview {
  border-left: 3px solid rgba(255,255,255,0.5);
  padding: 4px 8px; margin-bottom: 5px;
  border-radius: 4px; background: rgba(0,0,0,0.15);
  font-size: 11px; opacity: 0.85; line-height: 1.3;
  max-width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.dm-msg-wrap:not(.mine) .dm-reply-preview {
  border-left-color: rgba(131,58,180,0.7);
  background: rgba(131,58,180,0.08);
}

/* Bandeau reply en cours de saisie */
#dmReplyBar {
  display: none; align-items: center; gap: 8px;
  padding: 7px 14px; background: var(--s2);
  border-top: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
  font-size: 12px; color: var(--sub);
}
#dmReplyBar.show { display: flex; }
#dmReplyBar .reply-bar-text { flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
#dmReplyBar .reply-bar-icon { font-size: 14px; opacity: 0.6; flex-shrink: 0; }
#dmReplyBar .reply-bar-close {
  width: 22px; height: 22px; border-radius: 50%; border: none;
  background: var(--s3); color: var(--muted);
  cursor: pointer; display: flex; align-items: center; justify-content: center;
  font-size: 12px; flex-shrink: 0; transition: background 0.15s;
}
#dmReplyBar .reply-bar-close:hover { background: var(--border); color: var(--text); }

/* Message édité */
.dm-edited-label {
  font-size: 9px; opacity: 0.55; font-style: italic;
  display: inline-block; margin-left: 4px;
}

/* Inline edit input */
.dm-edit-input {
  background: rgba(255,255,255,0.15); border: 1.5px solid rgba(255,255,255,0.4);
  border-radius: 12px; padding: 6px 10px; font-size: 14px; color: #fff;
  font-family: 'DM Sans', sans-serif; outline: none; width: 100%;
  transition: border-color 0.2s;
}
.dm-msg-wrap:not(.mine) .dm-edit-input {
  background: var(--s3); border-color: rgba(131,58,180,0.5); color: var(--text);
}
.dm-edit-input:focus { border-color: rgba(255,255,255,0.8); }
.dm-edit-actions { display: flex; gap: 6px; margin-top: 5px; justify-content: flex-end; }
.dm-edit-btn {
  font-size: 11px; font-weight: 700; padding: 5px 10px; border-radius: 8px;
  border: none; cursor: pointer; font-family: 'DM Sans', sans-serif;
  transition: opacity 0.15s, transform 0.1s;
}
.dm-edit-btn:active { transform: scale(0.95); }
.dm-edit-confirm { background: var(--green); color: #000; }
.dm-edit-cancel-btn { background: var(--s3); color: var(--sub); }


/* Loading dots */
.dm-loading-dots { display:flex; gap:5px; align-items:center; }
.dm-loading-dots span {
  width:7px; height:7px; border-radius:50%;
  background:var(--muted); opacity:0.4;
  animation:dmDot 1.2s ease-in-out infinite;
}
.dm-loading-dots span:nth-child(2) { animation-delay:.2s; }
.dm-loading-dots span:nth-child(3) { animation-delay:.4s; }
@keyframes dmDot { 0%,80%,100%{transform:scale(.8);opacity:.4} 40%{transform:scale(1.1);opacity:.9} }

/* ════════════════════════════════════════════
   MODE ANNIVERSAIRE MENSUEL
════════════════════════════════════════════ */
#annivBanner {
  display: none;
  margin: 0 16px 0;
  padding: 12px 16px;
  border-radius: 12px;
  background: linear-gradient(135deg, rgba(255,180,0,0.13), rgba(255,100,150,0.13));
  border: 1px solid rgba(255,180,0,0.35);
  text-align: center;
  position: relative;
  overflow: hidden;
}
#annivBanner::before {
  content: '';
  position: absolute; inset: 0;
  background: linear-gradient(105deg, transparent 30%, rgba(255,255,255,0.08) 50%, transparent 70%);
  animation: annivShimmer 3.5s ease-in-out infinite;
  pointer-events: none;
  will-change: transform;
  transform: translateX(-100%);
}
@keyframes annivShimmer {
  0%,35%  { transform: translateX(-100%); opacity: 0; }
  50%     { opacity: 1; }
  65%,100% { transform: translateX(200%); opacity: 0; }
}
#annivBanner.visible { display: block; }
.anniv-emoji { font-size: 22px; display: block; margin-bottom: 4px; animation: annivBounce 2s ease-in-out infinite; will-change: transform; }
@keyframes annivBounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-4px)} }
.anniv-title {
  font-family: 'Playfair Display', serif;
  font-size: clamp(14px, 4vw, 18px);
  font-weight: 700;
  background: linear-gradient(90deg, #f5c518, #ff6eb0, #f5c518);
  background-size: 200% auto;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: annivGold 3s linear infinite;
}
@keyframes annivGold { 0%{background-position:0%} 100%{background-position:200%} }
.anniv-sub { font-size: 11px; color: var(--muted); margin-top: 4px; }

/* Header en mode anniv */
body.anniv-mode .hdr-name {
  background: linear-gradient(90deg, #f5c518, #ff6eb0, #a78bfa, #f5c518);
  background-size: 300% auto;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: annivGold 4s linear infinite;
}
body.anniv-mode header::before {
  background: radial-gradient(circle, rgba(245,197,24,0.15) 0%, transparent 70%);
}
body.light.anniv-mode .hdr-name {
  background: linear-gradient(90deg, #c8185e, #f5c518, #c8185e);
  background-size: 300% auto;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: annivGold 4s linear infinite;
}

/* Compteur spécial anniv */
body.anniv-mode #counterBlock {
  border-color: rgba(245,197,24,0.4);
  box-shadow: 0 0 0 1px rgba(245,197,24,0.15), 0 8px 32px rgba(0,0,0,0.45);
}
body.anniv-mode .counter-block-top {
  background: linear-gradient(90deg, #f5c518, #ff6eb0, transparent);
  opacity: 0.8;
}

/* Confettis canvas */
#annivCanvas {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  z-index: 8999;
  display: none;
}
#annivCanvas.visible { display: block; }

</style>


/* ─── Styles additionnels ─── */

/* ── Coup de cœur ── */
.btn-heart {
  background: transparent; border: none; cursor: pointer;
  font-size: 14px; padding: 0 2px; line-height: 1;
  opacity: 0; transition: opacity 0.2s, transform 0.15s;
  flex-shrink: 0; color: var(--sub);
}
.btn-heart:hover { opacity: 0.8; transform: scale(1.2); }
.song.playing .btn-heart { opacity: 0.45; }
.song.playing .btn-heart:hover { opacity: 0.9; }
.btn-heart.heart-girl { opacity: 1 !important; color: #e879a0; }
.btn-heart.heart-boy  { opacity: 1 !important; color: #5b9cf6; }
.sp-heart {
  background: transparent; border: none; cursor: pointer;
  font-size: 12px; padding: 0; line-height: 1;
  opacity: 0; transition: opacity 0.2s, transform 0.15s;
  flex-shrink: 0; margin-right: 2px; color: var(--sub);
}
.sp-heart:hover { opacity: 0.8; transform: scale(1.2); }
.sp-song.playing .sp-heart { opacity: 0.45; }
.sp-song.playing .sp-heart:hover { opacity: 0.9; }
.sp-heart.heart-girl { opacity: 1 !important; color: #e879a0; }
.sp-heart.heart-boy  { opacity: 1 !important; color: #5b9cf6; }

/* ── Avatar Profil ── */
/* ── Double avatar profil ── */
#profileAvatarWrap {
  position: absolute;
  /* Aligner avec le bas du header, en tenant compte de la safe-area */
  top: calc(var(--safe-top) + 50px); right: 16px;
  transform: translateY(0);
  width: 64px; height: 64px;
  z-index: 10;
  overflow: visible;
}

/* Avatar principal — sélectionné */
#profileAvatar {
  position: absolute;
  top: 0; right: 0;
  width: 42px; height: 42px;
  border-radius: 50%;
  background: #1a2a4a;
  border: 2px solid rgba(91,156,246,0.4);
  display: flex; align-items: center; justify-content: center;
  font-size: 20px; cursor: pointer;
  transition: box-shadow 0.3s, border-color 0.3s, background 0.3s, opacity 0.3s;
  user-select: none;
  z-index: 2;
}
#profileAvatar.neutral { animation: avatarPulse 3s ease-in-out infinite; }
@keyframes avatarPulse {
  0%,100% { border-color: rgba(91,156,246,0.3); }
  50%     { border-color: rgba(91,156,246,0.9); }
}
body.light #profileAvatar.neutral { background: rgba(200,24,94,0.10); border-color: rgba(200,24,94,0.35); animation: avatarPulseLight 3s ease-in-out infinite; }
@keyframes avatarPulseLight {
  0%,100% { border-color: rgba(200,24,94,0.2); }
  50%     { border-color: rgba(200,24,94,0.8); }
}
#profileAvatar.girl { border-color: #e879a0; animation: none; }
#profileAvatar.boy  { border-color: #5b9cf6; animation: none; }
body.light #profileAvatar.girl { background: rgba(232,121,160,0.12); border-color: #c8185e; }
body.light #profileAvatar.boy  { background: rgba(59,125,216,0.10);  border-color: #3b7dd8; }

/* Avatar secondaire — l'autre, discret en bas-gauche */
#profileAvatarOther {
  position: absolute;
  bottom: -4px; left: -10px;
  width: 34px; height: 34px;
  border-radius: 50%;
  background: var(--s2);
  border: 1.5px solid var(--border);
  display: none;
  align-items: center; justify-content: center;
  font-size: 17px;
  opacity: 0.55;
  z-index: 2;
  transition: opacity 0.3s;
  user-select: none;
  cursor: pointer;
  pointer-events: all;
  overflow: visible;
}
#profileAvatarOther.visible { display: flex; }

/* ── Indicateur présence ── */
#presenceDot {
  display: none;
  position: absolute;
  bottom: -3px; right: -3px;
  width: 10px; height: 10px;
  border-radius: 50%;
  background: #22c55e;
  border: 2px solid var(--bg);
  z-index: 5;
  animation: presencePulse 2s ease-in-out infinite;
}
#presenceDot.visible { display: block; }
@keyframes presencePulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(34,197,94,0.5); }
  50%     { box-shadow: 0 0 0 4px rgba(34,197,94,0); }
}
body.light #presenceDot { border-color: var(--bg); }
@keyframes otherAvatarPing {
  0%,100% { box-shadow: 0 0 0px rgba(232,121,160,0); border-color: var(--border); }
  50%     { box-shadow: 0 0 10px rgba(232,121,160,0.8), 0 0 20px rgba(232,121,160,0.3); border-color: #e879a0; }
}
@keyframes otherAvatarPingBoy {
  0%,100% { box-shadow: 0 0 0px rgba(91,156,246,0); border-color: var(--border); }
  50%     { box-shadow: 0 0 10px rgba(91,156,246,0.8), 0 0 20px rgba(91,156,246,0.3); border-color: #5b9cf6; }
}

/* Bulle emoji humeur — haut-gauche de l'avatar secondaire
   avatar: bottom:-4px, left:-10px, size:34px
   Bulle: 20px, on la place à top-left de cet avatar */
#profileMoodOther {
  position: absolute;
  bottom: 22px;   /* -4 + 34 - 10 = haut de l'avatar - demi bulle */
  left: -22px;    /* -10 - 12 : légèrement à gauche */
  width: 20px; height: 20px;
  border-radius: 50%;
  background: var(--bg);
  border: 1.5px solid var(--border);
  display: none;
  align-items: center; justify-content: center;
  font-size: 12px;
  z-index: 4;
  pointer-events: none;
  opacity: 0.55;
  transition: border-color 0.2s, box-shadow 0.2s, opacity 0.2s;
}
#profileMoodOther.visible { display: flex; }
#profileMoodOther.mood-highlight-girl,
#profileMoodOther.mood-highlight-boy { opacity: 1; }

/* ── Clignotement doux + effet lumière en veille ── */
#profileMoodOther.idle-glow {
  animation: moodIdleGlow 4s ease-in-out infinite;
}
@keyframes moodIdleGlow {
  0%,100% { opacity: 0.55; border-color: var(--border); }
  50%     { opacity: 0.9;  border-color: rgba(255,255,255,0.28); }
}
body.light #profileMoodOther.idle-glow {
  animation: moodIdleGlowLight 4s ease-in-out infinite;
}
@keyframes moodIdleGlowLight {
  0%,100% { opacity: 0.55; border-color: var(--border); }
  50%     { opacity: 0.9;  border-color: rgba(200,24,94,0.4); }
}

/* Capsule texte — s'étire vers la gauche, son bord droit touche la bulle */
/* bulle: left:-22px, width:20px → bord droit bulle = -22+20 = -2px
   On place la capsule à right = 100% - (-2px) de son parent, mais plus simple :
   on ancre à right depuis le wrap, en sachant que le wrap fait 64px
   et que le bord droit de la bulle est à left=-2px dans le wrap = 64-2=62px depuis la droite */
/* La pillule remplace la bulle emoji : même ancrage (bottom:22px, right:66px)
   Elle grossit depuis la taille de la bulle vers la gauche */
#moodBandeau {
  position: absolute;
  bottom: 22px;
  right: 66px;
  height: 20px;
  background: var(--s2);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  display: none;
  align-items: center;
  gap: 5px;
  padding: 0 7px;
  white-space: nowrap;
  font-size: 10px;
  font-weight: 600;
  color: var(--sub);
  font-family: 'DM Sans', sans-serif;
  letter-spacing: 0.3px;
  cursor: pointer;
  z-index: 5;
  overflow: hidden;
  max-width: 20px;
  opacity: 0;
  transition: max-width 0.35s cubic-bezier(.4,0,.2,1),
              opacity 0.2s ease,
              border-color 0.2s ease,
              background 0.2s ease;
}
#moodBandeau.visible { display: flex; }
#moodBandeau.open { max-width: 200px; opacity: 1; }
body.light #moodBandeau { border-color: rgba(200,24,94,0.18); }
body.light #moodBandeau.open { color: var(--sub); }
#moodBandeauEmoji { opacity: 0; transition: opacity 0.12s ease 0.1s; flex-shrink: 0; font-size: 12px; line-height: 1; }
#moodBandeauText  { opacity: 0; transition: opacity 0.15s ease 0.25s; white-space: nowrap; }
#moodBandeau.open #moodBandeauEmoji { opacity: 1; }
#moodBandeau.open #moodBandeauText  { opacity: 1; }

/* Clignotement synchronisé — capsule + bulle, même animation */
#moodBandeau.mood-highlight-girl,
#profileMoodOther.mood-highlight-girl {
  animation: bandeauPingGirl 0.7s ease-in-out 5;
  border-color: rgba(232,121,160,0.8);
}
#moodBandeau.mood-highlight-girl { color: #e879a0; background: rgba(232,121,160,0.10); }
#moodBandeau.mood-highlight-boy,
#profileMoodOther.mood-highlight-boy {
  animation: bandeauPingBoy 0.7s ease-in-out 5;
  border-color: rgba(91,156,246,0.8);
}
#moodBandeau.mood-highlight-boy { color: #5b9cf6; background: rgba(91,156,246,0.10); }

/* Light — highlight girl : rose plus soutenu */
body.light #moodBandeau.mood-highlight-girl { color: #c8185e; background: rgba(200,24,94,0.10); border-color: rgba(200,24,94,0.75); }
body.light #profileMoodOther.mood-highlight-girl { border-color: rgba(200,24,94,0.75); }
/* Light — highlight boy : bleu légèrement assombri pour contraster sur fond rose */
body.light #moodBandeau.mood-highlight-boy { color: #3b7dd8; background: rgba(59,125,216,0.10); border-color: rgba(59,125,216,0.75); }
body.light #profileMoodOther.mood-highlight-boy { border-color: rgba(59,125,216,0.75); }

@keyframes bandeauPingGirl {
  0%,100% { box-shadow: none; }
  50%     { box-shadow: 0 0 10px rgba(232,121,160,0.6), 0 0 18px rgba(232,121,160,0.2); }
}
@keyframes bandeauPingBoy {
  0%,100% { box-shadow: none; }
  50%     { box-shadow: 0 0 10px rgba(91,156,246,0.6), 0 0 18px rgba(91,156,246,0.2); }
}
body.light #moodBandeau.mood-highlight-girl,
body.light #profileMoodOther.mood-highlight-girl {
  animation: bandeauPingGirlLight 0.7s ease-in-out 5;
}
body.light #moodBandeau.mood-highlight-boy,
body.light #profileMoodOther.mood-highlight-boy {
  animation: bandeauPingBoyLight 0.7s ease-in-out 5;
}
@keyframes bandeauPingGirlLight {
  0%,100% { box-shadow: none; }
  50%     { box-shadow: 0 0 10px rgba(200,24,94,0.45), 0 0 18px rgba(200,24,94,0.18); }
}
@keyframes bandeauPingBoyLight {
  0%,100% { box-shadow: none; }
  50%     { box-shadow: 0 0 10px rgba(59,125,216,0.40), 0 0 18px rgba(59,125,216,0.15); }
}

/* Badge humeur soi-même */
#profileMoodSelf {
  position: absolute;
  top: -4px; right: -4px;
  width: 18px; height: 18px;
  border-radius: 50%;
  background: var(--bg);
  border: 1.5px solid var(--border);
  display: none;
  align-items: center; justify-content: center;
  font-size: 11px;
  z-index: 3;
  pointer-events: none;
}
#profileMoodSelf.visible { display: flex; }

.profile-popup-sep {
  height: 1px;
  background: var(--border);
  margin: 2px 0;
}

#profilePopup {
  position: fixed;
  top: calc(var(--safe-top) + 14px); right: 64px;
  background: var(--s1);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 8px;
  z-index: 1100;
  display: none;
  flex-direction: column;
  gap: 5px;
  min-width: 130px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  animation: profilePopIn 0.15s ease;
}
body.light #profilePopup { box-shadow: 0 4px 16px rgba(180,20,80,0.12); }
#profilePopup.open { display: flex; }
@keyframes profilePopIn {
  from { opacity:0; transform:translateX(6px) scale(0.97); }
  to   { opacity:1; transform:translateX(0) scale(1); }
}
.profile-popup-label { font-size: 8px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 2px; padding-bottom: 5px; border-bottom: 1px solid var(--border); }
.profile-popup-btn { display: flex; align-items: center; gap: 7px; padding: 6px 9px; border-radius: 8px; border: 1.5px solid var(--border); background: var(--s2); color: var(--sub); font-size: 11px; font-weight: 600; font-family: 'DM Sans', sans-serif; cursor: pointer; transition: background 0.15s, border-color 0.15s, color 0.15s; }
.profile-popup-btn:hover { background: var(--s3); color: var(--text); }
body.light .profile-popup-btn:hover { background: var(--s3); color: var(--green); border-color: rgba(200,24,94,0.3); }
.profile-popup-btn.sel-girl { border-color:#e879a0; background:rgba(232,121,160,0.12); color:#e879a0; }
.profile-popup-btn.sel-boy  { border-color:#5b9cf6; background:rgba(91,156,246,0.12);  color:#5b9cf6; }
body.light .profile-popup-btn.sel-girl { border-color:#c8185e; background:rgba(200,24,94,0.10); color:#c8185e; }
body.light .profile-popup-btn.sel-boy  { border-color:#3b7dd8; background:rgba(59,125,216,0.10); color:#3b7dd8; }
.profile-popup-dot { width:8px; height:8px; border-radius:50%; flex-shrink:0; }
.profile-popup-dot.girl { background:#e879a0; box-shadow:0 0 5px rgba(232,121,160,0.7); }
.profile-popup-dot.boy  { background:#5b9cf6; box-shadow:0 0 5px rgba(91,156,246,0.7); }
body.light .profile-popup-dot.girl { background:#c8185e; box-shadow:0 0 5px rgba(200,24,94,0.5); }
body.light .profile-popup-dot.boy  { background:#3b7dd8; box-shadow:0 0 5px rgba(59,125,216,0.4); }

/* ── Picker humeur ── */
#moodPicker {
  position: fixed;
  top: calc(var(--safe-top) + 14px); right: 64px;
  background: var(--s1);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 12px;
  z-index: 2100;
  display: none;
  flex-direction: column;
  gap: 10px;
  min-width: 200px;
  box-shadow: 0 4px 24px rgba(0,0,0,0.35);
  animation: profilePopIn 0.15s ease;
}
body.light #moodPicker { box-shadow: 0 4px 24px rgba(180,20,80,0.14); }
#moodPicker.open { display: flex; }
.mood-picker-label { font-size: 9px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 2px; }
.mood-picker-grid { display: flex; flex-wrap: wrap; gap: 6px; justify-content: center; }
.mood-emoji-btn {
  width: 36px; height: 36px;
  border-radius: 50%;
  background: var(--s2);
  border: 1.5px solid transparent;
  display: flex; align-items: center; justify-content: center;
  font-size: 20px; cursor: pointer;
  transition: transform 0.15s, background 0.15s, border-color 0.15s;
  user-select: none;
}
.mood-emoji-btn:hover { transform: scale(1.2); background: var(--s3); }
.mood-emoji-btn.selected { border-color: var(--green); background: rgba(0,201,167,0.12); transform: scale(1.15); }
body.light .mood-emoji-btn.selected { border-color: var(--green); background: rgba(200,24,94,0.10); }
body.light .mood-emoji-btn:hover { background: var(--s3); border-color: rgba(200,24,94,0.18); }
.mood-picker-cancel { font-size: 11px; color: var(--muted); text-align: center; cursor: pointer; padding: 4px 0; transition: color 0.15s; }
.mood-picker-close {
  width: 22px; height: 22px;
  display: flex; align-items: center; justify-content: center;
  border-radius: 6px;
  background: var(--s3);
  color: var(--text);
  font-size: 11px;
  font-weight: 700;
  cursor: pointer;
  flex-shrink: 0;
  border: 1px solid var(--border);
  transition: background 0.15s, color 0.15s;
}
.mood-picker-close:hover { background: rgba(239,83,80,0.2); color: #ef5350; border-color: rgba(239,83,80,0.4); }
#moodPickerDesc {
  font-size: 10px;
  color: var(--sub);
  text-align: center;
  min-height: 14px;
  transition: color 0.15s, opacity 0.15s;
  font-weight: 600;
  letter-spacing: 0.3px;
  line-height: 1.4;
  padding: 0 4px;
}
.mood-picker-cancel:hover { color: var(--text); }
body.light .mood-picker-cancel:hover { color: var(--green); }
.mood-clear-btn {
  font-size: 10px; font-weight: 600; color: #ef5350;
  display: flex; align-items: center; justify-content: center; gap: 5px;
  cursor: pointer; padding: 5px 10px; border-radius: 8px;
  border: 1px solid rgba(239,83,80,0.25); background: rgba(239,83,80,0.07);
  transition: background 0.15s, border-color 0.15s;
}
.mood-clear-btn:hover { background: rgba(239,83,80,0.15); border-color: rgba(239,83,80,0.5); }

#storyVideoWrap { transition: opacity 0.8s ease; }
#tlContent      { transition: opacity 0.8s ease; }

/* ── Bloc compteur unifié illuminé pendant la fenêtre vidéo ── */
@keyframes counterGlow {
  0%,100% { border-color: rgba(0,229,189,0.4); }
  50%     { border-color: rgba(0,229,189,0.9); }
}
@keyframes counterGlowLight {
  0%,100% { border-color: rgba(224,40,110,0.4); }
  50%     { border-color: rgba(224,40,110,0.9); }
}
@keyframes counterTopBar {
  0%,100% { opacity: 0.5; }
  50%     { opacity: 1; }
}
@keyframes counterTopBarLight {
  0%,100% { opacity: 0.5; }
  50%     { opacity: 1; }
}
/* Ciblage du bloc unique */
#counterBlock.glowing .counter-block-top {
  background: linear-gradient(90deg, #50ff78, #a0ffb8 50%, transparent);
}
body.light #counterBlock.glowing .counter-block-top {
  background: linear-gradient(90deg, #e0286e, #ffadd0 50%, transparent);
}
/* Ciblage du bloc unique */
#counterBlock.glowing {
  animation: counterGlow 1.8s ease-in-out infinite;
  transition: none;
}
#counterBlock.glowing .counter-block-top {
  animation: counterTopBar 1.8s ease-in-out infinite;
  opacity: 1;
}
#counterBlock.glowing .c-num-big {
}
body.light #counterBlock.glowing {
  animation: counterGlowLight 1.8s ease-in-out infinite;
}
body.light #counterBlock.glowing .counter-block-top {
  animation: counterTopBarLight 1.8s ease-in-out infinite;
  opacity: 1;
}
body.light #counterBlock.glowing .c-num-big {
}

/* ══════════════════════════════════════════════════════
   MÉMO COUPLE — Duo cards (note + todo côte à côte)
   ══════════════════════════════════════════════════════ */
.memo-duo-wrap {
  display: flex;
  gap: 10px;
  padding: 0 16px 16px;
  cursor: pointer;
}
.memo-duo-card {
  flex: 1;
  background: var(--s2);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 12px 13px;
  min-width: 0;
  transition: border-color 0.2s;
}
.memo-duo-card:hover { border-color: rgba(232,121,160,0.35); }
.memo-duo-title {
  font-size: 10px;
  font-weight: 700;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 1.2px;
  margin-bottom: 8px;
}
.memo-duo-content {
  font-size: 12px;
  color: var(--sub);
  line-height: 1.45;
  display: -webkit-box;
  -webkit-line-clamp: 4;
  -webkit-box-orient: vertical;
  overflow: hidden;
  min-height: 48px;
}
.memo-duo-date {
  font-size: 10px;
  color: var(--muted);
  margin-top: 8px;
}
.memo-todo-preview-row {
  display: flex;
  align-items: center;
  gap: 7px;
  padding: 2px 0;
}
.memo-todo-preview-check {
  width: 12px;
  height: 12px;
  border-radius: 3px;
  border: 1.5px solid var(--border);
  flex-shrink: 0;
}
.memo-todo-preview-check.done {
  background: var(--green);
  border-color: var(--green);
}
.memo-todo-preview-text {
  font-size: 12px;
  color: var(--sub);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.memo-todo-preview-text.done {
  text-decoration: line-through;
  color: var(--muted);
}

/* ══════════════════════════════════════════════════════
   PETITS MOTS — Gestion et éditeur
   ══════════════════════════════════════════════════════ */
.petits-mots-gestion-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 0;
  border-bottom: 1px solid var(--border);
}
.petits-mots-gestion-row:last-child { border-bottom: none; }
.petits-mots-gestion-icon {
  width: 36px;
  height: 36px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  flex-shrink: 0;
}
.petits-mots-gestion-info { flex: 1; min-width: 0; }
.petits-mots-gestion-title {
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.petits-mots-gestion-prev {
  font-size: 11px;
  color: var(--muted);
  margin-top: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.petits-mots-edit-btn, .petits-mots-del-btn {
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px;
  color: var(--muted);
  border-radius: 8px;
  display: flex;
  align-items: center;
  transition: color 0.15s, background 0.15s;
  flex-shrink: 0;
}
.petits-mots-edit-btn:hover { color: var(--text); background: var(--s2); }
.petits-mots-del-btn:hover { color: #e05555; background: rgba(224,85,85,0.08); }
.petits-mots-add-btn {
  width: 100%;
  margin-top: 12px;
  padding: 12px;
  background: transparent;
  border: 1.5px dashed var(--border);
  border-radius: 10px;
  color: var(--muted);
  font-size: 14px;
  font-family: 'DM Sans', sans-serif;
  cursor: pointer;
  transition: border-color 0.2s, color 0.2s;
}
.petits-mots-add-btn:hover { border-color: rgba(232,121,160,0.5); color: var(--text); }
.pm-color-btn {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  border: 2px solid transparent;
  cursor: pointer;
  transition: transform 0.15s, border-color 0.15s;
  flex-shrink: 0;
}
.pm-color-btn.active { border-color: #fff; transform: scale(1.18); }
.postit-empty {
  text-align: center;
  color: var(--muted);
  font-size: 13px;
  padding: 32px 16px;
  font-style: italic;
}

/* ── Coeur battant dans l'overlay vidéo ── */
@keyframes heartbeat {
  0%,100% { transform: translateY(-50%) scale(1);   opacity: 0.85; }
  14%     { transform: translateY(-50%) scale(1.22); opacity: 1; }
  28%     { transform: translateY(-50%) scale(1);   opacity: 0.85; }
  42%     { transform: translateY(-50%) scale(1.15); opacity: 1; }
  70%     { transform: translateY(-50%) scale(1);   opacity: 0.85; }
}
#storyHeart {
  position: absolute;
  right: 12%; top: 50%;
  transform: translateY(-50%) scale(1);
  font-size: 52px;
  pointer-events: none;
  z-index: 3;
  animation: heartbeat 1.4s ease-in-out infinite;
  display: none;
  will-change: transform, opacity;
}
</style>
